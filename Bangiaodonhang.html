function doGet() {
  return HtmlService.createHtmlOutputFromFile('Index')
    .setTitle('Dữ liệu kiểm kho')
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL)
    .addMetaTag('viewport', 'width=device-width, initial-scale=1');
}

function getSheetData() {
  // ... (giữ nguyên phần code hiện tại của bạn)
  
  // Thêm header để cho phép CORS
  const output = ContentService.createTextOutput(JSON.stringify(result));
  output.setMimeType(ContentService.MimeType.JSON);
  output.setHeaders({
    'Access-Control-Allow-Origin': '*',
    'Access-Control-Allow-Methods': 'GET'
  });
  
  return output;
}

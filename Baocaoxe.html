<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Biên bản ghi chỉ số công tơ mét</title>
<style>
    body {
        font-family: Arial, sans-serif;
    }
    .table-container {
        margin: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        font-size: 14px;
    }
    th, td {
        border: 1px solid #000;
        padding: 8px;
        text-align: center;
    }
    th {
        background-color: #f2f2f2;
    }
    .title {
        text-align: center;
        font-weight: bold;
        font-size: 18px;
        margin-bottom: 10px;
    }
    .signature-section {
        margin-top: 40px;
        display: flex;
        justify-content: space-between;
    }
    .signature {
        text-align: center;
        width: 200px;
    }
    .signature .position {
        font-weight: bold;
    }
    .signature .signature-space {
        height: 60px;
    }
</style>
</head>
<body>

<div class="table-container">
    <div class="title" id="report-title">BIÊN BẢN GHI CHỈ SỐ CÔNG TƠ MÉT THÁNG 10 NĂM 2025</div>
    
    <table id="data-table">
        <thead>
            <tr>
                <th rowspan="2">TT</th>
                <th rowspan="2">Biển KS</th>
                <th rowspan="2">Họ tên lái xe</th>
                <th colspan="2">Chỉ số công tơ mét</th>
                <th rowspan="2">Tổng số (km)</th>
                <th rowspan="2">Tổng số giờ cẩu</th>
                <th rowspan="2">Ghi chú</th>
            </tr>
            <tr>
                <th>tháng trước</th>
                <th>tháng này</th>
            </tr>
        </thead>
        <tbody>
            <!-- Dữ liệu sẽ được chèn vào đây bằng JavaScript -->
        </tbody>
    </table>

    <div class="signature-section">
        <div class="signature">
            <div class="position">VĂN PHÒNG CÔNG TY</div>
            <div class="signature-space"></div>
        </div>
        <div class="signature">
            <div class="position">TỔ XE</div>
            <div class="signature-space"></div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        // --- PHẦN 1: LẤY DỮ LIỆU TỪ URL ---
        const urlParams = new URLSearchParams(window.location.search);
        
        // Lấy tháng và năm để cập nhật tiêu đề
        const thang = urlParams.get('thang') || '10';
        const nam = urlParams.get('nam') || '2025';
        document.getElementById('report-title').textContent = `BIÊN BẢN GHI CHỈ SỐ CÔNG TƠ MÉT THÁNG ${thang} NĂM ${nam}`;

        // Lấy dữ liệu cho bảng từ tham số 'table'
        const tableParam = urlParams.get('table');

        // Dữ liệu mặc định nếu không có tham số 'table' trên URL (để demo)
        // LƯU Ý: Đã loại bỏ cột STT (số thứ tự) khỏi dữ liệu này
        const defaultTableData = "38A - 131.47_a_Trần Thanh Hà_a_661177_a_667147_a__a__a__b_" +
                                 "38A - 066.72_a_Nguyễn Ngọc Thắng_a_234553_a_239373_a__a__a_M_b_" +
                                 "38A - 131.40_a_Trần Văn Liêu_a_506216_a_508270_a__a__a_Giao_b_";
        
        // Ưu tiên sử dụng dữ liệu từ URL. Nếu không có, dùng dữ liệu mặc định.
        const tableData = tableParam || defaultTableData;


        // --- PHẦN 2: TẠO BẢNG TỪ DỮ LIỆU ---
        const tableBody = document.getElementById('data-table').getElementsByTagName('tbody')[0];
        const rows = tableData.split('_b_');

        rows.forEach((rowData, index) => {
            if (rowData) { // Bỏ qua các hàng trống
                const newRow = tableBody.insertRow();
                
                // 1. TẠO Ô STT TỰ ĐỘNG
                const sttCell = newRow.insertCell();
                sttCell.textContent = index + 1; // Index bắt đầu từ 0 nên cần +1

                // 2. TẠO CÁC Ô CÒN LẠI TỪ DỮ LIỆU
                const cells = rowData.split('_a_');
                cells.forEach(cellData => {
                    const newCell = newRow.insertCell();
                    newCell.textContent = cellData;
                });
            }
        });
    });
</script>

</body>
</html>

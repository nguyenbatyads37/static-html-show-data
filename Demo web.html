<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Assistants | Học Viện AI DHM</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Base styles */
        :root {
            --primary: #3f51b5;
            --primary-light: #6573c3;
            --primary-dark: #2c387e;
            --secondary: #4caf50;
            --secondary-light: #80e27e;
            --secondary-dark: #087f23;
            --text-light: #ffffff;
            --text-dark: #212121;
            --text-gray: #757575;
            --bg-dark: #121212;
            --bg-card: #1e1e1e;
            --bg-light: #2d2d2d;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
            --radius: 8px;
            --transition: all 0.3s ease;
            
            /* Thêm các biến CSS thiếu */
            --primary-color: #6e48aa;
            --secondary-color: #9d50bb;
            --success-color: #4cc9f0;
            --light-color: #ffffff;
            --dark-color: #121212;
            --border-radius: 8px;
            --sidebar-width: 240px;
        }

        /* App container */
        .app-container {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text-light);
            background-color: var(--bg-dark);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark-color), #16213e);
            color: var(--light-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }
        
        .ai-particles {
            position: fixed;
            width: 100%;
            height: 100%;
            z-index: 0;
            overflow: hidden;
        }
        
        .ai-particle {
            position: absolute;
            background: rgba(113, 76, 170, 0.3);
            border-radius: 50%;
            filter: blur(1px);
            animation: float 15s infinite linear;
        }
        
        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
            }
        }

        /* Layout Components */
        .container {
            display: flex;
            position: relative;
            z-index: 1;
        }
        
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(15px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 100;
            transition: transform 0.3s ease;
            overflow-y: auto;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 30px;
        }
        
        .logo {
            width: 50px;
            height: 50px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .logo i {
            font-size: 24px;
            color: white;
        }
        
        .site-title {
            color: white;
            font-size: 18px;
            font-weight: 600;
            background: linear-gradient(to right, #fff, var(--success-color));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 30px 0 30px 30px; /* Giảm padding bên phải */
            position: relative;
            min-height: 100vh;
        }

        /* Navigation - Updated styles for left menu */
        .nav-title {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, 0.5);
            margin: 15px 0 10px;
        }
        
        .nav-links {
            list-style: none;
            margin-bottom: 20px;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            text-decoration: none;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .nav-link i {
            width: 24px;
            margin-right: 10px;
            font-size: 18px;
        }
        
        .nav-link.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 10px rgba(110, 72, 170, 0.3);
            border: none;
        }
        
        /* Sửa CSS cho submenu để luôn hiển thị */
        .nav-link .toggle-icon {
            display: none; /* Ẩn nút mũi tên vì không cần thiết nữa */
        }
        
        .submenu {
            list-style: none;
            margin: 0 0 10px 15px;
            max-height: 1000px; /* Giá trị đủ lớn để luôn hiển thị */
            overflow: visible;
        }
        
        .submenu-item {
            margin-bottom: 5px;
        }
        
        .submenu-link {
            display: flex;
            align-items: center;
            padding: 8px 15px;
            border-radius: var(--border-radius);
            text-decoration: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .submenu-link:hover, .submenu-link.active {
            background: rgba(255, 255, 255, 0.07);
            color: white;
        }
        
        .submenu-link.active {
            border-left: 3px solid var(--primary-color);
        }
        
        .submenu-link i {
            font-size: 14px;
            margin-right: 10px;
            opacity: 0.7;
        }

        /* Header and horizontal category menu - New styles */
        .top-category-nav {
            display: flex;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
        }
        
        .top-category-item {
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            white-space: nowrap;
            border-radius: 4px;
        }
        
        .top-category-item:hover {
            color: white;
            background-color: rgba(111, 66, 193, 0.1);
        }
        
        .top-category-item.active {
            color: white;
            font-weight: 600;
            background: linear-gradient(135deg, #6f42c1, #007bff);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .top-category-item.active:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 3px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }
        
        /* Header and Search */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 600;
            color: white;
        }
        
        .search-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 100%;
            max-width: 500px;
        }
        
        .search-box {
            position: relative;
            width: 300px;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 20px 12px 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            border-color: var(--success-color);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255, 255, 255, 0.7);
        }
        
        .format-search {
            position: relative;
        }
        
        .format-search .search-input {
            padding-right: 160px;
            background: rgba(110, 72, 170, 0.1);
            border: 1px solid rgba(157, 80, 187, 0.3);
        }
        
        .format-search .search-input:focus {
            border-color: var(--primary-color);
            background: rgba(110, 72, 170, 0.15);
            box-shadow: 0 0 5px rgba(110, 72, 170, 0.2);
        }
        
        .format-example-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: rgba(255, 255, 255, 0.7);
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .format-example-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        /* Category Navigation */
        .category-nav {
            display: flex;
            overflow-x: auto;
            margin-bottom: 30px;
            padding-bottom: 5px;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) transparent;
        }
        
        .category-nav::-webkit-scrollbar {
            height: 5px;
        }
        
        .category-nav::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 10px;
        }
        
        .category-item {
            white-space: nowrap;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            margin-right: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .category-item:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .category-item.active {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            box-shadow: 0 4px 10px rgba(110, 72, 170, 0.3);
            border: 1px solid transparent;
        }
        
        /* Cards Container - Chỉnh sửa để làm nhỏ gọn hơn và đẩy xuống dưới */
        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); /* Giảm kích thước tối thiểu của mỗi cột */
            gap: 15px; /* Giảm khoảng cách giữa các card */
            position: relative;
            margin-bottom: 20px; /* Giảm margin dưới */
            margin-top: 60px; /* Tăng margin trên để đẩy xuống dưới */
            transition: opacity 0.3s ease;
            max-width: 90%; /* Giới hạn chiều rộng tối đa */
            margin-left: auto;
            margin-right: auto;
        }
        
        /* AI Assistant Card - Làm nhỏ gọn hơn */
        .assistant-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
            height: 100%;
            max-height: 320px; /* Giới hạn chiều cao tối đa */
        }
        
        .assistant-card:hover {
            transform: translateY(-3px); /* Giảm hiệu ứng hover */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* Giảm đổ bóng */
            border-color: rgba(255, 255, 255, 0.2);
        }
        
        .card-header {
            position: relative;
            height: 120px; /* Chiều cao của hình ảnh */
            overflow: hidden;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            background-color: rgba(255, 255, 255, 0.08); /* Màu nền khi không có ảnh */
        }
        
        .card-body {
            padding: 12px; /* Giảm padding */
            flex: 1;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
        }
        
        .assistant-name {
            font-size: 14px; /* Giảm kích thước font */
            font-weight: 600;
            margin-bottom: 6px;
            color: white;
        }
        
        .assistant-category {
            font-size: 10px; /* Giảm kích thước font */
            text-transform: uppercase;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            display: inline-block;
            padding: 3px 8px; /* Giảm padding */
            border-radius: 20px;
            margin-bottom: 8px;
        }
        
        .assistant-desc {
            font-size: 12px; /* Giảm kích thước font */
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
            margin-bottom: 10px;
            flex-grow: 1;
            display: -webkit-box;
            -webkit-line-clamp: 3; /* Giới hạn số dòng hiển thị */
            line-clamp: 3; /* Standard property for compatibility */
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .rating {
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        .star {
            color: #ffc107;
            font-size: 10px; /* Giảm kích thước icon sao */
        }
        
        .rating-value {
            font-size: 12px; /* Giảm kích thước font */
            font-weight: 600;
        }
        
        .assistant-btn {
            padding: 6px 12px; /* Giảm padding */
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 20px;
            color: white;
            font-size: 12px; /* Giảm kích thước font */
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .assistant-btn.purchased-btn {
            background: linear-gradient(45deg, #4cc9f0, #2196f3) !important;
            cursor: default !important;
            opacity: 0.9;
            pointer-events: none;
        }
        
        .assistant-btn.purchased-btn:hover {
            background: linear-gradient(45deg, #4cc9f0, #2196f3) !important;
            transform: none !important;
            box-shadow: none !important;
        }
        
        .assistant-btn:before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: all 0.3s ease;
            z-index: -1;
        }
        
        .assistant-btn:not(.purchased-btn):hover:before {
            transform: translateX(0);
        }
        
        .assistant-btn:not(.purchased-btn):hover {
            box-shadow: 0 4px 15px rgba(110, 72, 170, 0.4);
            transform: translateY(-2px);
        }
        
        .assistant-url-link-card {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: var(--primary-dark);
            border-radius: 50%;
            margin-left: 10px;
            color: var(--text-light);
            text-decoration: none;
            transition: var(--transition);
        }
        
        .assistant-url-link-card:hover {
            background-color: var(--primary);
            transform: scale(1.1);
        }
        
        .assistant-btn i {
            font-size: 15px;
        }
        
        .chat-icon-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            margin-right: 8px;
        }
        
        /* Mobile Responsive - Điều chỉnh các breakpoints */
        @media (max-width: 992px) {
            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .cards-container {
                grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
                gap: 10px;
            }
            
            .assistant-card {
                max-height: 300px;
            }
            
            .card-header {
                height: 100px;
            }
            
            .card-body {
                padding: 8px;
            }
            
            .assistant-name {
                font-size: 12px;
            }
        }
        
        /* Toggle Menu Button */
        .menu-toggle {
            display: none;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            align-items: center;
            justify-content: center;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 101;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .menu-toggle i {
            color: white;
            font-size: 18px;
        }

        /* Gradient text and effects */
        .gradient-text {
            background: linear-gradient(to right, #fff, var(--success-color));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Scan Line Effect */
        .scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(to right, 
                transparent, 
                rgba(71, 118, 230, 0.6), 
                transparent);
            animation: scan 3.5s linear infinite;
            z-index: 20;
        }
        
        @keyframes scan {
            0% {
                top: 0;
            }
            100% {
                top: 100%;
            }
        }

        /* User Profile Section */
        .user-profile {
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            margin-top: auto;
            display: flex;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .user-avatar i {
            color: white;
            font-size: 18px;
        }
        
        .user-info {
            flex: 1;
        }
        
        .user-name {
            font-size: 14px;
            font-weight: 600;
            color: white;
        }
        
        .user-email {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
        }
        
        .logout-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: rgba(255, 255, 255, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        /* Chat Modal */
        .chat-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .chat-modal.active {
            opacity: 1;
            visibility: visible;
        }
        
        .chat-container {
            width: 90%;
            max-width: 800px;
            height: 80vh;
            background: rgba(26, 26, 46, 0.95);
            border-radius: var(--border-radius);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            transform: translateY(20px);
            transition: all 0.3s ease;
        }
        
        .chat-modal.active .chat-container {
            transform: translateY(0);
        }
        
        .chat-header {
            padding: 15px 20px;
            background: rgba(110, 72, 170, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .chat-assistant-info {
            display: flex;
            align-items: center;
        }
        
        .chat-assistant-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 15px;
            border: 2px solid var(--primary-color);
        }
        
        .chat-assistant-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .chat-assistant-details h3 {
            font-size: 16px;
            margin-bottom: 2px;
            color: white;
        }
        
        .chat-assistant-details p {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            display: flex;
            align-items: center;
        }
        
        .chat-assistant-details p i {
            color: #4cc9f0;
            margin-right: 5px;
            font-size: 10px;
        }
        
        .chat-close {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .chat-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .chat-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) rgba(0, 0, 0, 0.1);
        }
        
        .chat-body::-webkit-scrollbar {
            width: 5px;
        }
        
        .chat-body::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 10px;
        }
        
        .chat-message {
            margin-bottom: 20px;
            max-width: 80%;
        }
        
        .user-message {
            margin-left: auto;
            text-align: right;
        }
        
        .assistant-message {
            margin-right: auto;
        }
        
        .message-bubble {
            padding: 12px 16px;
            border-radius: 18px;
            display: inline-block;
            position: relative;
        }
        
        .user-message .message-bubble {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-top-right-radius: 4px;
        }
        
        .assistant-message .message-bubble {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-top-left-radius: 4px;
        }
        
        .message-time {
            font-size: 10px;
            color: rgba(255, 255, 255, 0.5);
            margin-top: 5px;
        }
        
        .chat-footer {
            padding: 15px 20px;
            background: rgba(26, 26, 46, 0.8);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .chat-input-form {
            display: flex;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 30px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .chat-input:focus {
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .chat-send-btn {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .chat-send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(110, 72, 170, 0.4);
        }

        /* Title styles for section headings */
        .slide-title {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 20px;
            margin-top: 40px;
            color: var(--light-color);
            background: linear-gradient(to right, #fff, var(--success-color));
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            display: inline-block;
        }
        
        .slide-title:after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 50px;
            height: 3px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }

        /* Highlight */
        .highlight {
            background-color: rgba(76, 201, 240, 0.3);
            padding: 2px 0;
            border-radius: 3px;
        }

        /* Format Search Container and Buttons - removed */
        .sidebar .search-container {
            margin: 15px 0;
            max-width: 100%;
        }
        
        .sidebar .search-box {
            width: 100%;
        }
        
        .sidebar .search-input {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            width: 100%;
            padding: 10px 15px 10px 35px;
            font-size: 13px;
        }
        
        .sidebar .search-icon {
            left: 12px;
            font-size: 14px;
        }

        /* Purchased Assistants Styles */
        .purchased-assistants-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .purchased-assistant-item {
            background: rgba(255, 255, 255, 0.08);
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .assistant-item-header {
            background: rgba(110, 72, 170, 0.2);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .assistant-item-header h4 {
            font-size: 18px;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .assistant-item-header h4 i {
            color: #4cc9f0;
        }
        
        .assistant-code {
            font-family: monospace;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .assistant-tag {
            display: inline-block;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .assistant-item-body {
            padding: 15px;
        }
        
        .assistant-features {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 15px;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            line-clamp: 4;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .assistant-features i {
            color: #4cc9f0;
            margin-right: 5px;
        }
        
        .assistant-command-examples {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 10px 15px;
        }
        
        .command-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .command-example {
            margin-bottom: 5px;
        }
        
        .command-example code {
            font-family: monospace;
            background: rgba(110, 72, 170, 0.3);
            padding: 5px 10px;
            border-radius: 4px;
            display: block;
            white-space: nowrap;
            overflow-x: auto;
            color: #4cc9f0;
        }
        
        /* Form Styles */
        .partner-form, .contact-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
        }
        
        .form-group input, .form-group select, .form-group textarea {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .form-group input[type="file"] {
            padding: 10px;
        }
        
        .file-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .file-item {
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .file-item img, .file-item video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .file-remove {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 10px;
            color: white;
        }
        
        .submit-btn {
            padding: 12px 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 72, 170, 0.3);
        }

        .site-footer {
            background: rgba(26, 26, 46, 0.95);
            padding: 60px 0 30px;
            margin-top: 60px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            z-index: 2;
        }
        
        .footer-container {
            display: flex;
            flex-wrap: wrap;
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 30px;
        }
        
        .footer-section {
            flex: 1;
            min-width: 300px;
        }
        
        .footer-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: white;
            position: relative;
            padding-bottom: 12px;
        }
        
        .footer-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 40px;
            height: 3px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border-radius: 3px;
        }
        
        .footer-desc {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.7;
            margin-bottom: 20px;
        }
        
        .package-example {
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .package-example h4 {
            font-size: 16px;
            color: white;
            margin-bottom: 15px;
        }
        
        .package-features {
            list-style: none;
            margin-bottom: 20px;
        }
        
        .package-features li {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
        }
        
        .package-features li i {
            color: var(--success-color);
            margin-right: 10px;
            margin-top: 3px;
        }
        
        .contact-info {
            margin-bottom: 25px;
        }
        
        .contact-info p {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .contact-info i {
            color: var(--success-color);
            width: 20px;
            text-align: center;
        }
        
        .partnership-options {
            list-style: none;
            margin-bottom: 25px;
        }
        
        .partnership-options li {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin-bottom: 12px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .partnership-options li i {
            color: var(--success-color);
            margin-top: 3px;
        }
        
        .footer-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }
        
        .footer-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(110, 72, 170, 0.4);
        }
        
        .footer-bottom {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.5);
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .footer-container {
                flex-direction: column;
                gap: 30px;
            }
        }

        /* Thêm CSS cho typing indicator */
        .typing-indicator .message-bubble {
            padding: 12px 16px;
            min-width: 60px;
        }

        .typing-indicator .dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.7);
            margin: 0 2px;
            animation: typing 1.5s infinite ease-in-out;
        }

        .typing-indicator .dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-indicator .dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator .dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.6;
            }
            30% {
                transform: translateY(-5px);
                opacity: 1;
            }
        }

        .chat-message.error .message-bubble {
            background-color: rgba(255, 100, 100, 0.2);
            border: 1px solid rgba(255, 100, 100, 0.3);
            color: #ffcccc;
        }

        /* API settings link in footer */
        .api-settings {
            display: inline-block;
            margin-left: 15px;
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            cursor: pointer;
            text-decoration: underline;
            transition: color 0.3s ease;
        }

        .api-settings:hover {
            color: rgba(255, 255, 255, 0.8);
        }
        
        /* Styles for purchased and not purchased assistants */
        .assistant-card.not-purchased {
            position: relative;
            border: 1px solid rgba(255, 100, 100, 0.3);
        }
        
        .assistant-card.not-purchased::before {
            content: "Chưa mua";
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 100, 100, 0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 5;
        }
        
        .assistant-btn.purchase-btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .assistant-btn.purchase-btn:hover {
            background: linear-gradient(45deg, #c0392b, #e74c3c);
        }
        
        .assistant-card.purchased {
            position: relative;
            border: 1px solid rgba(76, 201, 240, 0.3);
        }
        
        .assistant-status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 5;
            font-weight: bold;
            color: white;
        }
        
        .badge-purchased {
            background: rgba(76, 201, 240, 0.8);
        }
        
        .badge-not-purchased {
            background: rgba(255, 100, 100, 0.8);
        }

        .purchased-assistant-link {
            display: flex !important;
            align-items: center;
            padding: 8px 10px !important;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .purchased-assistant-link:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .purchased-assistant-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }

        .purchased-assistant-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .purchased-assistant-link span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 14px;
        }

        .empty-purchased-message {
            padding: 10px;
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
            font-size: 13px;
        }

        .empty-purchased-message i {
            margin-right: 5px;
            color: rgba(255, 255, 255, 0.3);
        }

        /* Modal danh sách trợ lý đã mua */
        .purchased-assistants-modal .modal-content {
            max-width: 800px;
            max-height: 90vh;
            width: 90%;
        }

        .purchased-assistants-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .purchased-assistant-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: var(--border-radius);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .purchased-assistant-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.12);
        }

        .purchased-assistant-card .assistant-image {
            width: 100%;
            height: 150px;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .purchased-assistant-card .assistant-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .purchased-assistant-card .assistant-info {
            flex: 1;
        }

        .purchased-assistant-card h4 {
            margin: 0 0 5px 0;
            color: #fff;
            font-size: 18px;
        }

        .purchased-assistant-card .assistant-code {
            color: rgba(255, 255, 255, 0.6);
            font-family: monospace;
            font-size: 12px;
            margin: 0 0 10px 0;
        }

        .purchased-assistant-card .assistant-desc {
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            margin: 0 0 15px 0;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .start-chat-btn {
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 6px;
            color: white;
            padding: 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: auto;
        }

        .start-chat-btn i {
            margin-right: 8px;
        }

        .start-chat-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(110, 72, 170, 0.4);
        }

        .empty-purchased-modal {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px 20px;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            display: none;
        }

        .empty-purchased-modal i {
            font-size: 40px;
            margin-bottom: 15px;
            color: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .purchased-assistants-grid {
                grid-template-columns: 1fr;
            }
        }

        .purchased-assistant-link {
            display: flex !important;
            align-items: center;
            padding: 8px 10px !important;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .purchased-assistant-link:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .purchased-assistant-link-wrapper {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding-right: 5px;
        }
        
        .assistant-url-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(76, 201, 240, 0.2);
            color: rgba(255, 255, 255, 0.8);
            font-size: 12px;
            transition: all 0.3s ease;
        }
        
        .assistant-url-link:hover {
            background: rgba(76, 201, 240, 0.5);
            color: #fff;
            transform: translateY(-2px);
        }
        
        .assistant-name-text {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 14px;
            max-width: calc(100% - 30px);
        }

        .purchased-assistant-avatar {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex-shrink: 0;
        }

        .purchased-assistant-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .assistant-url {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 14px;
            border-left: 3px solid rgba(76, 201, 240, 0.7);
        }
        
        .assistant-url-btn {
            color: rgba(76, 201, 240, 0.9);
            text-decoration: none;
            word-break: break-all;
            display: block;
            margin-top: 5px;
            transition: all 0.3s ease;
        }
        
        .assistant-url-btn:hover {
            color: rgba(76, 201, 240, 1);
            text-decoration: underline;
        }
        
        .assistant-url-btn i {
            margin-left: 5px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .purchased-assistants-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Hover effects */
        .user-auth-container .login-btn:hover {
            transform: translateY(-2px);
            background: #333 !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
        }
        
        .user-auth-container #logoutBtn:hover {
            transform: translateY(-1px) !important;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2) !important;
            background: #333 !important;
        }
        
        /* User auth container styles */
        .user-auth-container {
            position: absolute !important;
            /* Xóa thuộc tính top và right để nó có thể được đặt vào vị trí trong header */
            z-index: 9999 !important;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1)) !important;
            transform: none !important;
            transition: none !important;
            will-change: auto !important;
            pointer-events: auto !important;
            display: block !important;
            margin: 0 !important;
            padding: 0 !important;
            width: auto !important;
            height: auto !important;
            max-height: none !important;
            overflow: visible !important;
            clear: none !important;
            float: none !important;
            -webkit-transform: none !important;
            -moz-transform: none !important;
            -ms-transform: none !important;
            -o-transform: none !important;
        }
        
        /* Logout button styles */
        #logoutBtn {
            width: auto !important;
            font-size: 10px !important;
            padding: 3px 6px !important;
            border-radius: 4px !important;
            float: right !important;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
            background: #000 !important;
            border: none !important;
            color: white !important;
        }
        
        #logoutBtn i {
            font-size: 9px !important;
            margin-right: 3px !important;
        }
        
        #userInfoContainer {
            padding: 8px !important;
            width: 150px !important;
            border-radius: 8px !important;
            background: rgba(0, 0, 0, 0.8) !important;
            border: 1px solid rgba(255, 255, 255, 0.1) !important;
            transform: none !important;
            transition: none !important;
            will-change: auto !important;
            position: relative !important;
        }
        
        #loggedInUserEmail {
            font-size: 11px !important;
            white-space: nowrap !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            max-width: 90px !important;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .user-auth-container {
                top: 8px !important;
                right: 8px !important;
            }
            
            #userInfoContainer {
                width: 130px !important;
                padding: 6px !important;
            }
            
            #logoutBtn {
                padding: 2px 5px !important;
                font-size: 9px !important;
            }
            
            #logoutBtn i {
                font-size: 8px !important;
                margin-right: 2px !important;
            }
            
            #loggedInUserEmail {
                font-size: 10px !important;
                max-width: 70px !important;
            }
        }
        
        @media (max-width: 480px) {
            .user-auth-container .login-btn {
                padding: 3px 8px !important;
                font-size: 11px !important;
            }
            
            #userInfoContainer {
                padding: 5px !important;
                width: 110px !important;
            }
            
            #loggedInUserEmail {
                font-size: 9px !important;
                max-width: 60px !important;
            }
            
            #logoutBtn {
                font-size: 8px !important;
                padding: 2px 4px !important;
            }
            
            #logoutBtn i {
                font-size: 7px !important;
                margin-right: 2px !important;
            }
        }

        /* Thêm CSS cho video container */
        .video-showcase {
            width: 90%; /* Giảm từ 100% xuống 90% */
            max-width: 1200px; /* Thêm giới hạn max-width */
            margin: 15px 0 25px 20px; /* Thêm margin-left để có khoảng cách với bên trái */
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--border-radius);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .video-content {
            flex: 1;
            min-width: 60%; /* Giảm chiều rộng tối thiểu xuống 60% */
            max-width: 800px; /* Thêm max-width cho video */
        }

        /* Cải thiện thiết kế cho banner bên cạnh video */
        .video-banner {
            width: 280px; /* Tăng kích thước banner */
            background: rgba(76, 201, 240, 0.1); /* Màu nền đẹp hơn */
            border-radius: var(--border-radius);
            border: 1px solid rgba(76, 201, 240, 0.3); /* Viền đẹp hơn */
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15); /* Thêm đổ bóng */
            align-self: flex-start; /* Đặt banner ngang hàng với đầu video */
        }

        .video-banner:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            border-color: rgba(76, 201, 240, 0.5);
        }

        .video-banner img {
            width: 100%;
            height: 160px; /* Chiều cao cố định cho ảnh */
            object-fit: cover;
            border-top-left-radius: var(--border-radius);
            border-top-right-radius: var(--border-radius);
            transition: transform 0.5s ease;
        }

        .video-banner:hover img {
            transform: scale(1.05);
        }

        .video-banner-content {
            padding: 18px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .video-banner-title {
            font-size: 18px; /* Tăng kích thước font */
            font-weight: 700;
            margin-bottom: 10px;
            color: white;
            background: linear-gradient(to right, #ffffff, #4cc9f0);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .video-banner-desc {
            font-size: 14px; /* Tăng kích thước font */
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            line-height: 1.5;
            flex-grow: 1;
        }

        .video-banner-btn {
            display: inline-block;
            padding: 10px 20px; /* Tăng padding */
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 25px; /* Bo tròn hơn */
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .video-banner-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 1200px) {
            .video-content {
                min-width: 55%;
            }
            
            .video-showcase {
                width: 95%;
                margin-left: 15px; /* Giảm margin bên trái */
            }
            
            .video-banner {
                width: 250px; /* Giảm kích thước banner trên màn hình vừa */
            }
        }

        @media (max-width: 768px) {
            .video-showcase {
                flex-direction: column;
                margin: 15px auto; /* Đưa về căn giữa trên mobile */
                width: 90%; /* Giảm width xuống 90% */
            }
            
            .video-banner {
                width: 100%;
            }
            
            .video-content {
                max-width: 100%; /* Full width trên mobile */
            }
        }

        /* Thêm lại CSS cho video-title, video-description và video-container */
        .video-title {
            font-size: 16px; /* Giảm từ 18px xuống 16px */
            font-weight: 600;
            margin-bottom: 8px; /* Giảm từ 10px xuống 8px */
            color: white;
            position: relative;
            padding-bottom: 5px;
        }

        .video-description {
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 10px; /* Giảm từ 15px xuống 10px */
            font-size: 12px; /* Giảm từ 13px xuống 12px */
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2; /* Giới hạn chỉ hiển thị 2 dòng */
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-container {
            position: relative;
            width: 100%;
            padding-bottom: 42%; /* Điều chỉnh tỷ lệ cao/rộng xuống một chút */
            height: 0;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.3);
            border-radius: var(--border-radius);
        }

        .video-admin-controls {
            margin-top: 10px; /* Giảm từ 15px xuống 10px */
            padding: 10px; /* Giảm từ 15px xuống 10px */
            background: rgba(0, 0, 0, 0.2);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255, 255, 255, 0.05);
            display: none;
        }

        .video-admin-controls textarea {
            height: 60px; /* Giảm từ 80px xuống 60px */
            margin-bottom: 8px; /* Giảm từ 10px xuống 8px */
        }

        .video-container iframe,
        .video-container video,
        .video-container object,
        .video-container embed {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: var(--border-radius);
        }

        .video-admin-controls textarea {
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: white;
            font-size: 12px;
            height: 60px;
            resize: vertical;
            font-family: monospace;
            margin-bottom: 8px;
        }

        .video-admin-controls button {
            padding: 6px 12px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            border: none;
            border-radius: 4px;
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .video-admin-controls button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Thêm hiệu ứng ripple nhẹ cho video */
        .video-container:after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(110, 72, 170, 0.15), rgba(76, 201, 240, 0.08));
            pointer-events: none;
        }

        /* Thêm CSS cho các nút liên hệ cố định bên phải */
        .fixed-contact-buttons {
            position: fixed;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .contact-button {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .contact-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .phone-button {
            background-color: #00c853;
        }
        
        .email-button {
            background-color: #ff6d00;
        }
        
        .zalo-button {
            background-color: #00c853;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }
        
        .messenger-button {
            background-color: #0084ff;
        }
        
        /* Thêm media query để điều chỉnh kích thước nút trên mobile */
        @media (max-width: 768px) {
            .fixed-contact-buttons {
                right: 10px;
            }
            
            .contact-button {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }
        }

        /* Thêm CSS cho card-bg để hiển thị hình ảnh trên thẻ card */
        .card-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: transform 0.3s ease;
        }

        .assistant-card:hover .card-bg {
            transform: scale(1.1);
        }

        /* Thêm fallback cho trường hợp ảnh không tải được */
        .card-bg-fallback {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(110, 72, 170, 0.2);
            color: white;
            font-size: 30px;
        }

        /* Thêm hiệu ứng tối khi hover */
        .card-header:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.4));
            z-index: 1;
            transition: opacity 0.3s ease;
        }

        .assistant-card:hover .card-header:before {
            opacity: 0.7;
        }

        /* Thêm CSS cho badge trạng thái */
        .assistant-status-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 5;
            font-weight: bold;
            color: white;
        }

        .badge-purchased {
            background: rgba(76, 201, 240, 0.8);
        }

        .badge-not-purchased {
            background: rgba(255, 100, 100, 0.8);
        }

        .assistant-card.purchased {
            border: 1px solid rgba(76, 201, 240, 0.3);
        }

        .assistant-card.not-purchased {
            border: 1px solid rgba(255, 100, 100, 0.3);
        }
    </style>
</head>
<body>
    <div class="ai-particles" id="aiParticles"></div>
     
    <!-- Thêm các nút liên hệ cố định bên phải -->
    <div class="fixed-contact-buttons">
        <a href="tel:+84987654321" class="contact-button phone-button">
            <i class="fas fa-phone"></i>
        </a>
        <a href="mailto:support@hocvienaidhm.vn" class="contact-button email-button">
            <i class="fas fa-envelope"></i>
        </a>
        <a href="https://zalo.me/your-zalo-id" class="contact-button zalo-button">
            Zalo
        </a>
        <a href="https://m.me/your-messenger-id" class="contact-button messenger-button">
            <i class="fab fa-facebook-messenger"></i>
        </a>
    </div>
    
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="scan-line"></div>
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-robot"></i>
                </div>
                <h1 class="site-title">TRỢ LÝ AI DHM</h1>
            </div>
            
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" class="search-input" placeholder="Tìm kiếm theo tên hoặc danh mục..." id="searchInput">
                </div>
            </div>
            
           <p class="nav-title">Trợ Lý AI</p>
            <ul class="nav-links">
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="writing">
                        <i class="fas fa-pen"></i> Viết lách
                    </a>
                    <ul class="submenu" id="writing-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="programming">
                        <i class="fas fa-code"></i> Lập trình
                    </a>
                    <ul class="submenu" id="programming-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="education">
                        <i class="fas fa-graduation-cap"></i> Giáo dục
                    </a>
                    <ul class="submenu" id="education-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="business">
                        <i class="fas fa-briefcase"></i> Kinh doanh
                    </a>
                    <ul class="submenu" id="business-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="design">
                        <i class="fas fa-paint-brush"></i> Thiết kế
                    </a>
                    <ul class="submenu" id="design-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="health">
                        <i class="fas fa-heartbeat"></i> Sức khỏe
                    </a>
                    <ul class="submenu" id="health-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
                <li>
                    <a href="javascript:void(0)" class="nav-link expandable" data-category="lifestyle">
                        <i class="fas fa-coffee"></i> Phong cách sống
                    </a>
                    <ul class="submenu" id="lifestyle-submenu">
                        <!-- Trợ lý con sẽ được thêm tự động từ JavaScript -->
                    </ul>
                </li>
            </ul>
            
            <p class="nav-title">Tài khoản</p>
            <ul class="nav-links">
                <li><a href="javascript:void(0)" id="myAssistantsBtn" class="nav-link"><i class="fas fa-crown"></i> Trợ lý của tôi</a></li>
                <li><a href="javascript:void(0)" id="becomePartnerBtn" class="nav-link"><i class="fas fa-handshake"></i> Đăng ký CTV/Đại lý</a></li>
                <li><a href="javascript:void(0)" id="contactBtn" class="nav-link"><i class="fas fa-headset"></i> Liên hệ hỗ trợ</a></li>
            </ul>
        </aside>
        
        <!-- Mobile Menu Toggle -->
        <div class="menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
        </div>
        
        <!-- Main Content -->
        <main class="main-content">
            <div class="header">
                <h1 class="page-title gradient-text"></h1>
            </div>
            
            <!-- Thêm danh mục ngang ở trên đầu -->
            <div class="top-category-nav">
                <div class="top-category-item active" data-category="all">Tất cả</div>
                <div class="top-category-item" data-category="programming">Lập trình</div>
                <div class="top-category-item" data-category="writing">Viết lách</div>
                <div class="top-category-item" data-category="education">Giáo dục</div>
                <div class="top-category-item" data-category="business">Kinh doanh</div>
                <div class="top-category-item" data-category="design">Thiết kế</div>
                <div class="top-category-item" data-category="health">Sức khỏe</div>
                <div class="top-category-item" data-category="lifestyle">Phong cách sống</div>
                <div class="top-category-item" data-category="virtual">Hướng dẫn sử dụng </div>
            </div>
            
            <!-- Chỉnh sửa khung phát video và thêm banner -->
            <div class="video-showcase" id="videoShowcase">
                <div class="video-content">
                    <h3 class="video-title">Giới Thiệu Trợ Lý AI</h3>
                    <p class="video-description">Xem video hướng dẫn cách sử dụng các trợ lý AI của chúng tôi để tối ưu hóa công việc và nâng cao hiệu suất:</p>
                    
                    <div class="video-container" id="videoContainer">
                        <!-- Quản trị viên có thể nhúng video ở đây -->
                        <iframe id="videoFrame" src="https://www.youtube.com/embed/nE5h_oD4Ga8?autoplay=1&mute=1&list=TLGGQCxfGQYmWwcyNTA0MjAyNQ" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                    
                    <!-- Phần điều khiển cho quản trị viên - mặc định ẩn -->
                    <div class="video-admin-controls" id="videoAdminControls">
                        <p style="margin-bottom: 10px; color: rgba(255, 255, 255, 0.8);">Dán mã nhúng video HTML:</p>
                        <textarea id="videoEmbedCode" placeholder="Dán mã nhúng video HTML ở đây..."></textarea>
                        <button id="updateVideoBtn">Cập nhật video</button>
                    </div>
                </div>
                
                <!-- Banner bên phải (Cập nhật nội dung) -->
                <div class="video-banner">
                    <img src="https://file.edubit.vn/storage/a9f77445cac80713ec1fef12b6958bf3d6647c6d/500300.png" alt="GV HỒ ĐỨC DŨNG">
                    <div class="video-banner-content">
                        <h4 class="video-banner-title">Khóa Học AI Pro</h4>
                        <p class="video-banner-desc">Trở thành chuyên gia AI trong 30 ngày với khóa học chuyên sâu từ các giảng viên hàng đầu. Bao gồm 20+ giờ video và 10+ dự án thực tế.</p>
                        <a href="#" class="video-banner-btn">Đăng ký ngay</a>
                    </div>
                </div>
            </div>
            
            <!-- Thêm container cho danh sách trợ lý AI chính -->
            <div id="cardsContainer" class="cards-container">
                <!-- Cards will be inserted here via JavaScript -->
            </div>
        </main>
    </div>
    
    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                <p class="footer-desc">Khách hàng sẽ được phân quyền sử dụng trợ lý AI theo gói dịch vụ đã mua.</p>
                <div class="package-example">
                    <h4>Ví dụ: Gói 10 Trợ lý AI Premium</h4>
                    <ul class="package-features">
                        <li><i class="fas fa-check-circle"></i> 10 trợ lý AI được lựa chọn từ danh sách</li>
                        <li><i class="fas fa-check-circle"></i> Mỗi trợ lý kèm theo các tính năng riêng biệt</li>
                        <li><i class="fas fa-check-circle"></i> Hướng dẫn câu lệnh sử dụng chi tiết</li>
                        <li><i class="fas fa-check-circle"></i> Hỗ trợ kỹ thuật 24/7</li>
                    </ul>
                </div>
                <button class="footer-btn" id="packageInfoBtn">Xem chi tiết gói dịch vụ</button>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-title">Liên hệ hỗ trợ</h3>
                <div class="contact-info">
                    <p><i class="fas fa-map-marker-alt"></i> Địa chỉ: 123 Đường AI, Quận Machine Learning, TP. Deep Learning</p>
                    <p><i class="fas fa-phone"></i> Hotline: <strong>1900 8088</strong> (8:00 - 22:00)</p>
                    <p><i class="fas fa-envelope"></i> Email: support@hocvienaidhm.vn</p>
                </div>
                <p class="footer-desc">Gửi yêu cầu hỗ trợ với đính kèm ảnh/video để được giải quyết nhanh chóng:</p>
                <button class="footer-btn" id="supportRequestBtn">Gửi yêu cầu hỗ trợ</button>
            </div>
            
            <div class="footer-section">
                <h3 class="footer-title">Đăng ký hợp tác</h3>
                <p class="footer-desc">Trở thành CTV/Đại lý hoặc đăng ký dùng thử dịch vụ với Học Viện AI DHM:</p>
                <ul class="partnership-options">
                    <li><i class="fas fa-handshake"></i> Đăng ký CTV: Nhận hoa hồng 20-30% từ mỗi giao dịch thành công</li>
                    <li><i class="fas fa-store"></i> Đăng ký Đại lý: Nhận ưu đãi lên đến 40% và hỗ trợ marketing</li>
                    <li><i class="fas fa-clipboard-check"></i> Dùng thử dịch vụ: Trải nghiệm 3 trợ lý AI trong 7 ngày</li>
                </ul>
                <button class="footer-btn" id="partnerRegisterBtn">Đăng ký ngay</button>
            </div>
        </div>
        <div class="footer-bottom">
            <p>
                &copy; 2023 Học Viện AI DHM. Tất cả các quyền được bảo lưu.
            </p>
        </div>
    </footer>
    
    <!-- My Assistants Modal -->
    <div class="chat-modal" id="myAssistantsModal">
        <div class="chat-container" style="height: 90vh; width: 95%; max-width: 1000px;">
            <div class="chat-header">
                <div class="chat-assistant-info">
                    <div class="chat-assistant-avatar">
                        <i class="fas fa-crown" style="color: #ffc107; font-size: 20px;"></i>
                    </div>
                    <div class="chat-assistant-details">
                        <h3>Trợ lý của tôi</h3>
                        <p><i class="fas fa-circle"></i> Các trợ lý AI bạn đã mua</p>
                    </div>
                </div>
                <button class="chat-close" id="myAssistantsCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
                    <div class="purchased-assistants-list">
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 01. WriterGPT - <span class="assistant-code">TLAI-VIET01</span></h4>
                                <span class="assistant-tag">Viết lách</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Tạo nội dung sáng tạo cho blog, bài viết<br>
                                    <i class="fas fa-check"></i> Sửa lỗi ngữ pháp và cải thiện văn phong<br>
                                    <i class="fas fa-check"></i> Viết tiêu đề và mô tả hấp dẫn
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/writergpt viết bài blog về [chủ đề] dài 500 từ</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/writergpt chỉnh sửa văn bản: [dán văn bản cần chỉnh sửa]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 02. CodeMaster AI - <span class="assistant-code">TLAI-LTRINH01</span></h4>
                                <span class="assistant-tag">Lập trình</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Tìm kiếm lỗi và đề xuất sửa lỗi trong code<br>
                                    <i class="fas fa-check"></i> Tối ưu mã nguồn và cải thiện hiệu suất<br>
                                    <i class="fas fa-check"></i> Tạo code mẫu cho nhiều ngôn ngữ lập trình
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/codemaster tìm lỗi: [dán code cần kiểm tra]</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/codemaster tạo mẫu: [mô tả chức năng] bằng [ngôn ngữ]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 03. EduTeach - <span class="assistant-code">TLAI-GDUC01</span></h4>
                                <span class="assistant-tag">Giáo dục</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Giải thích khái niệm phức tạp một cách đơn giản<br>
                                    <i class="fas fa-check"></i> Giải đáp thắc mắc về nhiều môn học<br>
                                    <i class="fas fa-check"></i> Tạo bài tập và đề thi ôn luyện
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/eduteach giải thích: [khái niệm cần giải thích]</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/eduteach tạo bài tập: [môn học] về [chủ đề]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Thêm 7 trợ lý khác có cấu trúc tương tự -->
                        <!-- Để đơn giản, tôi sẽ thêm 3 trợ lý nữa làm ví dụ -->
                        
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 04. BusinessGPT - <span class="assistant-code">TLAI-KDOANH01</span></h4>
                                <span class="assistant-tag">Kinh doanh</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Phân tích thị trường và đối thủ cạnh tranh<br>
                                    <i class="fas fa-check"></i> Lập kế hoạch kinh doanh chi tiết<br>
                                    <i class="fas fa-check"></i> Đề xuất chiến lược marketing
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/business phân tích thị trường: [ngành hàng]</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/business lập kế hoạch kinh doanh: [mô tả sản phẩm/dịch vụ]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 05. DesignAI - <span class="assistant-code">TLAI-THIETKE01</span></h4>
                                <span class="assistant-tag">Thiết kế</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Tư vấn thiết kế giao diện người dùng<br>
                                    <i class="fas fa-check"></i> Gợi ý phối màu và bố cục<br>
                                    <i class="fas fa-check"></i> Tạo mô tả để dùng với công cụ AI tạo hình ảnh
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/designai gợi ý bố cục: [loại trang web/ứng dụng]</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/designai tạo prompt: [mô tả hình ảnh cần tạo]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="purchased-assistant-item">
                            <div class="assistant-item-header">
                                <h4><i class="fas fa-robot"></i> 06. HealthCoach - <span class="assistant-code">TLAI-SKHOE01</span></h4>
                                <span class="assistant-tag">Sức khỏe</span>
                            </div>
                            <div class="assistant-item-body">
                                <p class="assistant-features">
                                    <i class="fas fa-check"></i> Tư vấn dinh dưỡng và chế độ ăn uống<br>
                                    <i class="fas fa-check"></i> Gợi ý bài tập phù hợp với mục tiêu<br>
                                    <i class="fas fa-check"></i> Theo dõi tiến trình và đưa ra lời khuyên
                                </p>
                                <div class="assistant-command-examples">
                                    <p class="command-label">Câu lệnh mẫu:</p>
                                    <div class="command-example">
                                        <code>/healthcoach tạo thực đơn: [mục tiêu] cho [số ngày] ngày</code>
                                    </div>
                                    <div class="command-example">
                                        <code>/healthcoach gợi ý bài tập: [mục tiêu] tại [địa điểm]</code>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Partner Registration Modal -->
    <div class="chat-modal" id="partnerModal">
        <div class="chat-container" style="height: auto; max-height: 90vh; width: 95%; max-width: 800px;">
            <div class="chat-header">
                <div class="chat-assistant-info">
                    <div class="chat-assistant-avatar">
                        <i class="fas fa-handshake" style="color: #4cc9f0; font-size: 20px;"></i>
                    </div>
                    <div class="chat-assistant-details">
                        <h3>Đăng ký CTV/Đại lý</h3>
                        <p><i class="fas fa-circle"></i> Hợp tác cùng phát triển</p>
                    </div>
                </div>
                <button class="chat-close" id="partnerCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-body" style="padding: 30px;">
                <h3 class="slide-title" style="margin-top: 0;">Đăng ký hợp tác</h3>
                <p style="margin-bottom: 20px; color: rgba(255,255,255,0.8);">
                    Hãy điền thông tin dưới đây để đăng ký làm Cộng tác viên/Đại lý hoặc yêu cầu dùng thử dịch vụ. 
                    Chúng tôi sẽ liên hệ với bạn trong vòng 24 giờ.
                </p>
                
                <form id="partnerForm" class="partner-form">
                    <div class="form-group">
                        <label for="fullName">Họ và tên *</label>
                        <input type="text" id="fullName" name="fullName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Email *</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">Số điện thoại *</label>
                        <input type="tel" id="phone" name="phone" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="address">Địa chỉ</label>
                        <input type="text" id="address" name="address">
                    </div>
                    
                    <div class="form-group">
                        <label for="registrationType">Bạn muốn đăng ký? *</label>
                        <select id="registrationType" name="registrationType" required>
                            <option value="">-- Chọn --</option>
                            <option value="ctv">Cộng tác viên</option>
                            <option value="agency">Đại lý</option>
                            <option value="trial">Dùng thử dịch vụ</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="message">Thông tin thêm</label>
                        <textarea id="message" name="message" rows="4" placeholder="Mô tả thêm về nhu cầu của bạn..."></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn">Gửi đăng ký</button>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Contact Support Modal -->
    <div class="chat-modal" id="contactModal">
        <div class="chat-container" style="height: auto; max-height: 90vh; width: 95%; max-width: 800px;">
            <div class="chat-header">
                <div class="chat-assistant-info">
                    <div class="chat-assistant-avatar">
                        <i class="fas fa-headset" style="color: #6e48aa; font-size: 20px;"></i>
                    </div>
                    <div class="chat-assistant-details">
                        <h3>Liên hệ hỗ trợ</h3>
                        <p><i class="fas fa-circle"></i> Hotline: 1900 1234</p>
                    </div>
                </div>
                <button class="chat-close" id="contactCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-body" style="padding: 30px;">
                <h3 class="slide-title" style="margin-top: 0;">Gửi yêu cầu hỗ trợ</h3>
                <p style="margin-bottom: 20px; color: rgba(255,255,255,0.8);">
                    Vui lòng điền thông tin dưới đây để gửi yêu cầu hỗ trợ. Bạn có thể đính kèm ảnh/video để mô tả chi tiết vấn đề.
                </p>
                
                <form id="contactForm" class="contact-form">
                    <div class="form-group">
                        <label for="contactName">Họ và tên *</label>
                        <input type="text" id="contactName" name="contactName" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="contactEmail">Email *</label>
                        <input type="email" id="contactEmail" name="contactEmail" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="contactPhone">Số điện thoại</label>
                        <input type="tel" id="contactPhone" name="contactPhone">
                    </div>
                    
                    <div class="form-group">
                        <label for="subject">Tiêu đề *</label>
                        <input type="text" id="subject" name="subject" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="contactMessage">Nội dung *</label>
                        <textarea id="contactMessage" name="contactMessage" rows="4" required placeholder="Mô tả chi tiết vấn đề bạn đang gặp phải..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="attachments">Đính kèm ảnh/video</label>
                        <input type="file" id="attachments" name="attachments" multiple accept="image/*,video/*">
                        <div class="file-preview" id="filePreview"></div>
                    </div>
                    
                    <button type="submit" class="submit-btn">Gửi yêu cầu</button>
                </form>
            </div>
        </div>
    </div>
    

    <!-- Kết nối với Google Sheets Proxy và Auth Service -->
    <script src="google-sheets-proxy.js?v=1.1"></script>
    <script src="auth-service.js"></script>
    
    <!-- Login Modal -->
    <div class="chat-modal" id="loginModal">
        <div class="chat-container" style="height: auto; max-height: 90vh; width: 95%; max-width: 500px;">
            <div class="chat-header">
                <div class="chat-assistant-info">
                    <div class="chat-assistant-avatar">
                        <i class="fas fa-user-lock" style="color: #4cc9f0; font-size: 20px;"></i>
                    </div>
                    <div class="chat-assistant-details">
                        <h3>Đăng nhập</h3>
                        <p><i class="fas fa-circle"></i> Truy cập trợ lý AI</p>
                    </div>
                </div>
                <button class="chat-close" id="loginCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-body" style="padding: 30px;">
                <h3 class="slide-title" style="margin-top: 0;">Xác thực tài khoản</h3>
                <p style="margin-bottom: 20px; color: rgba(255,255,255,0.8);">
                    Vui lòng đăng nhập bằng email đã đăng ký để sử dụng các trợ lý AI.
                </p>
                
                <form id="loginForm" class="contact-form">
                    <div class="form-group">
                        <label for="userEmail">Email *</label>
                        <input type="email" id="userEmail" name="userEmail" required placeholder="Nhập email đã đăng ký">
                    </div>
                    
                    <div id="loginMessage" style="color: #ff6b6b; margin: 10px 0; display: none;"></div>
                    
                    <button type="submit" class="submit-btn">
                        <i class="fas fa-sign-in-alt"></i> Đăng nhập
                    </button>
                </form>
            </div>
        </div>
    </div>
    
<!-- Container cho cả nút đăng nhập và thông tin người dùng -->
<div class="user-auth-container" style="position: absolute !important; top: 20px !important; right: 20px !important; z-index: 9999 !important; transform: none !important; transition: none !important; will-change: auto !important; pointer-events: auto !important;">
    <!-- Nút đăng nhập - hiển thị khi chưa đăng nhập -->
    <div id="loginContainer" style="display: block;">
        <a href="javascript:void(0)" id="topLoginBtn" style="display: inline-block; padding: 8px 15px; background: #000000; color: white; text-decoration: none; border-radius: 4px; font-size: 14px; border: 1px solid #333333; transition: all 0.2s ease;">
            <i class="fas fa-sign-in-alt" style="margin-right: 6px;"></i> Đăng nhập
        </a>
    </div>
    
    <!-- Thông tin người dùng - hiển thị khi đã đăng nhập -->
    <div id="userInfoContainer" style="display: none; background: #000000; border: 1px solid #333333; padding: 12px; border-radius: 4px; width: 220px; box-shadow: 0 2px 10px rgba(0,0,0,0.3);">
        <div style="display: flex; align-items: center; margin-bottom: 10px;">
            <div style="width: 36px; height: 36px; border-radius: 50%; background: #222222; display: flex; align-items: center; justify-content: center; margin-right: 10px;">
                <i class="fas fa-user" style="color: white;"></i>
            </div>
            <div>
                <div id="loggedInUserEmail" style="color: white; font-size: 14px; font-weight: bold; margin-bottom: 3px;">email@example.com</div>
            </div>
        </div>
        <button id="logoutBtn" style="width: 100%; padding: 8px; background: #000000; color: white; border: 1px solid #333333; border-radius: 4px; cursor: pointer; transition: all 0.2s ease; text-align: center; font-size: 14px;">
            <i class="fas fa-sign-out-alt" style="margin-right: 6px;"></i> Đăng xuất
        </button>
    </div>
</div>
    <!-- Thêm modal thông báo khi người dùng chưa mua trợ lý AI -->
    <div class="chat-modal" id="notPurchasedModal">
        <div class="chat-container" style="height: auto; max-width: 500px; width: 95%;">
            <div class="chat-header" style="background: linear-gradient(45deg, #ff6b6b, #ff8080);">
                <div class="chat-assistant-info">
                    <div class="chat-assistant-avatar">
                        <i class="fas fa-lock" style="color: white; font-size: 20px;"></i>
                    </div>
                    <div class="chat-assistant-details">
                        <h3 id="notPurchasedAssistantName">Trợ lý AI chưa mua</h3>
                        <p><i class="fas fa-circle"></i> Yêu cầu kích hoạt</p>
                    </div>
                </div>
                <button class="chat-close" id="notPurchasedCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="chat-body" style="padding: 30px; text-align: center;">
                <div style="margin-bottom: 20px;">
                    <div style="width: 100px; height: 100px; margin: 0 auto 20px; background: rgba(255, 107, 107, 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-shopping-cart" style="font-size: 40px; color: #ff6b6b;"></i>
                    </div>
                    <h3 style="margin-bottom: 15px; color: white;">Nội dung đã khóa</h3>
                    <p style="color: rgba(255, 255, 255, 0.8); margin-bottom: 20px; line-height: 1.6;">
                        Bạn chưa mua trợ lý AI này. Vui lòng mua để sử dụng và khám phá tất cả tính năng độc đáo.
                    </p>
                </div>
                
                <div style="display: flex; justify-content: center; gap: 15px;">
                    <button id="cancelPurchaseBtn" class="submit-btn" style="background: rgba(255, 255, 255, 0.2); flex: 1; max-width: 150px;">
                        <i class="fas fa-times"></i> Đóng
                    </button>
                    <button id="confirmPurchaseBtn" class="submit-btn" style="background: linear-gradient(45deg, #6e48aa, #9d50bb); flex: 1; max-width: 150px;">
                        <i class="fas fa-shopping-cart"></i> Mua ngay
                    </button>
                </div>
                
                <div style="margin-top: 20px; font-size: 13px; color: rgba(255, 255, 255, 0.6);">
                    <p>Sau khi mua, bạn sẽ có quyền truy cập vĩnh viễn vào trợ lý này</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variable to store assistants data
        let assistants = [];
        
        // Khai báo biến tìm kiếm
        let currentSearchTerm = '';
             
        // Khởi tạo danh sách trợ lý AI ngay lập tức
        // Đây là dữ liệu mẫu, trong thực tế có thể được tải từ API
        const initAssistants = [
        {
            id: 1,
            number: "01",
            code: "TLAI-VIET01",
            name: "WriterGPT",
            category: "writing",
            description: "Trợ lý viết bài chuyên nghiệp với khả năng tạo nội dung sáng tạo, sửa lỗi ngữ pháp và cải thiện văn phong.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1455390582262-044cdead277a?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 2,
            number: "02",
            code: "TLAI-LTRINH01",
            name: "CodeMaster AI",
            category: "programming",
            description: "Hỗ trợ lập trình viên tìm kiếm lỗi, tối ưu mã nguồn và tạo code mẫu cho nhiều ngôn ngữ khác nhau.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 3,
            number: "03",
            code: "TLAI-GDUC01",
            name: "EduTeach",
            category: "education",
            description: "Trợ giảng AI giúp học sinh hiểu bài, giải đáp thắc mắc và cung cấp tài liệu học tập phù hợp.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 4,
            number: "04",
            code: "TLAI-KDOANH01",
            name: "BusinessGPT",
            category: "business",
            description: "Tư vấn chiến lược kinh doanh, phân tích thị trường và đề xuất giải pháp tối ưu cho doanh nghiệp.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 5,
            number: "05",
            code: "TLAI-THIETKE01",
            name: "DesignAI",
            category: "design",
            description: "Công cụ thiết kế thông minh giúp tạo giao diện, hình ảnh và đồ họa chuyên nghiệp.",
            rating: 4.5,
            image: "https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 6,
            number: "06",
            code: "TLAI-SKHOE01",
            name: "HealthCoach",
            category: "health",
            description: "Trợ lý sức khỏe cá nhân, đưa ra lời khuyên về dinh dưỡng, tập luyện và theo dõi tiến trình.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 7,
            number: "07",
            code: "TLAI-PCACH01",
            name: "LifestyleGuru",
            category: "lifestyle",
            description: "Tư vấn phong cách sống, sắp xếp thời gian và cân bằng cuộc sống cá nhân và công việc.",
            rating: 4.4,
            image: "https://images.unsplash.com/photo-1531234799389-dcb7651eb0a2?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 8,
            number: "08",
            code: "TLAI-VIET02",
            name: "ContentMaster",
            category: "writing",
            description: "Trợ lý tạo content cho mạng xã hội, blog và website với khả năng tối ưu SEO.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1499750310107-5fef28a66643?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 9,
            number: "09",
            code: "TLAI-LTRINH02",
            name: "WebDev Assistant",
            category: "programming",
            description: "Chuyên gia phát triển web, giúp tạo website, tối ưu hiệu suất và responsive design.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1522542550221-31fd19575a2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 10,
            number: "10",
            code: "TLAI-GDUC02",
            name: "LanguageTutor",
            category: "education",
            description: "Gia sư ngôn ngữ AI, dạy nhiều ngôn ngữ khác nhau với phương pháp cá nhân hóa.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 11,
            number: "11",
            code: "TLAI-KDOANH02",
            name: "MarketingPro",
            category: "business",
            description: "Chuyên gia marketing AI, phân tích chiến dịch và đề xuất chiến lược tiếp thị hiệu quả.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 12,
            number: "12",
            code: "TLAI-KDOANH03",
            name: "FinanceWiz",
            category: "business",
            description: "Trợ lý tài chính cá nhân, giúp quản lý ngân sách, đầu tư và lập kế hoạch tài chính.",
            rating: 4.5,
            image: "https://images.unsplash.com/photo-1579621970588-a35d0e7ab9b6?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 13,
            number: "13",
            code: "TLAI-KTOAN01",
            name: "AI.KẾ TOÁN",
            category: "business",
            description: "Trợ lý kế toán AI, hỗ trợ quản lý sổ sách, báo cáo tài chính và tư vấn thuế.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 14,
            number: "14",
            code: "TLAI-VIET03",
            name: "BlogBuddy",
            category: "writing",
            description: "Trợ lý chuyên viết blog, tạo nội dung hấp dẫn và thu hút người đọc với phong cách riêng biệt.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 15,
            number: "15",
            code: "TLAI-VIET04",
            name: "ScriptMaster",
            category: "writing",
            description: "Trợ lý viết kịch bản, biên tập lời thoại và cấu trúc câu chuyện cho phim, video và podcasts.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1485846234645-a62644f84728?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 16,
            number: "16",
            code: "TLAI-LTRINH03",
            name: "MobileDevGenius",
            category: "programming",
            description: "Chuyên gia phát triển ứng dụng di động, hỗ trợ lập trình iOS, Android và cross-platform.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1581291518633-83b4ebd1d83e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 17,
            number: "17",
            code: "TLAI-LTRINH04",
            name: "DataScientistAI",
            category: "programming",
            description: "Trợ lý khoa học dữ liệu, giúp phân tích, trực quan hóa dữ liệu và xây dựng mô hình ML/AI.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 18,
            number: "18",
            code: "TLAI-GDUC03",
            name: "MathGenius",
            category: "education",
            description: "Trợ lý dạy toán, giải thích các khái niệm phức tạp và hướng dẫn giải bài tập từ cơ bản đến nâng cao.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 19,
            number: "19",
            code: "TLAI-GDUC04",
            name: "HistoryExplorer",
            category: "education",
            description: "Trợ lý chuyên về lịch sử, kể chuyện hấp dẫn về các sự kiện lịch sử và nhân vật nổi tiếng.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1461360228754-6e81c478b882?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 20,
            number: "20",
            code: "TLAI-KDOANH04",
            name: "StartupMentor",
            category: "business",
            description: "Cố vấn khởi nghiệp, giúp xây dựng kế hoạch kinh doanh, tìm kiếm nhà đầu tư và phát triển sản phẩm.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1450101499163-c8848c66ca85?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 21,
            number: "21",
            code: "TLAI-THIETKE02",
            name: "UXMaster",
            category: "design",
            description: "Chuyên gia trải nghiệm người dùng, tư vấn về thiết kế UX/UI và cải thiện tính khả dụng của sản phẩm.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1507238691740-187a5b1d37b8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 22,
            number: "22",
            code: "TLAI-THIETKE03",
            name: "LogoCreator",
            category: "design",
            description: "Trợ lý thiết kế logo chuyên nghiệp, giúp xây dựng nhận diện thương hiệu ấn tượng và độc đáo.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1497015289639-54688650d173?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 23,
            number: "23",
            code: "TLAI-THIETKE04",
            name: "MotionGraphics",
            category: "design",
            description: "Chuyên gia đồ họa chuyển động, tư vấn tạo hiệu ứng video, animation và trình bày trực quan.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1558655146-9f40138edfeb?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 24,
            number: "24",
            code: "TLAI-SKHOE02",
            name: "NutritionExpert",
            category: "health",
            description: "Chuyên gia dinh dưỡng, tư vấn chế độ ăn uống lành mạnh, kế hoạch bữa ăn và thực đơn cân bằng.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1505576399279-565b52d4ac71?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 25,
            number: "25",
            code: "TLAI-SKHOE03",
            name: "FitnessTrainer",
            category: "health",
            description: "Huấn luyện viên thể hình ảo, thiết kế lịch tập luyện cá nhân hóa và theo dõi kết quả tập luyện.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 26,
            number: "26",
            code: "TLAI-SKHOE04",
            name: "MindfulnessGuide",
            category: "health",
            description: "Hướng dẫn thiền và thực hành chánh niệm, giúp giảm stress và cải thiện sức khỏe tinh thần.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1506126613408-eca07ce68773?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 27,
            number: "27",
            code: "TLAI-PCACH02",
            name: "TravelAdvisor",
            category: "lifestyle",
            description: "Cố vấn du lịch thông minh, gợi ý địa điểm, lập kế hoạch chuyến đi và chia sẻ bí quyết du lịch.",
            rating: 4.8,
            image: "https://images.unsplash.com/photo-1503220317375-aaad61436b1b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 28,
            number: "28",
            code: "TLAI-PCACH03",
            name: "HomeDecorator",
            category: "lifestyle",
            description: "Trợ lý trang trí nội thất, tư vấn phong cách trang trí, phối màu và lựa chọn nội thất phù hợp.",
            rating: 4.6,
            image: "https://images.unsplash.com/photo-1585412727339-54e4bae3bbf9?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 29,
            number: "29",
            code: "TLAI-PCACH04",
            name: "PersonalStylist",
            category: "lifestyle",
            description: "Stylist cá nhân, tư vấn phong cách thời trang, phối đồ và mua sắm thông minh theo từng dịp.",
            rating: 4.7,
            image: "https://images.unsplash.com/photo-1483985988355-763728e1935b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        },
        {
            id: 30,
            number: "30",
            code: "TLAI-LTRINH05",
            name: "AIEthicsAdvisor",
            category: "programming",
            description: "Cố vấn đạo đức AI, giúp phát triển các hệ thống AI có trách nhiệm, công bằng và minh bạch.",
            rating: 4.9,
            image: "https://images.unsplash.com/photo-1620712943543-bcc4688e7485?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
        }
    ];
        
        // Gán danh sách trợ lý ban đầu
        assistants = initAssistants;
        window.assistants = initAssistants;
        
        // Search functionality
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM đã được tải xong, khởi tạo ứng dụng...');
            console.log('Danh sách trợ lý:', assistants.length, 'trợ lý');
            
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    currentSearchTerm = searchInput.value.toLowerCase();
                    updateAssistantStatus();
                });
            }
            
            // Tạo và thêm trợ lý con vào submenu đã có sẵn
            function createAssistantSubmenus() {
                // Nhóm trợ lý theo danh mục
                const categories = {};
                window.assistants.forEach(assistant => {
                    if (!categories[assistant.category]) {
                        categories[assistant.category] = [];
                    }
                    categories[assistant.category].push(assistant);
                });
                
                // Tìm container của submenu cho từng danh mục
                Object.keys(categories).forEach(category => {
                    const submenuContainer = document.getElementById(`${category}-submenu`);
                    if (submenuContainer) {
                        submenuContainer.innerHTML = ''; // Xóa nội dung cũ
                        
                        // Thêm các trợ lý vào submenu
                        categories[category].forEach(assistant => {
                            const linkItem = document.createElement('a');
                            linkItem.href = '#';
                            linkItem.className = 'submenu-link';
                            linkItem.dataset.assistantId = assistant.id; // Thêm ID trợ lý vào data attribute
                            linkItem.innerHTML = `<i class="fas fa-angle-right"></i> ${assistant.name}`;
                            
                            submenuContainer.appendChild(linkItem);
                        });
                    }
                });
            }
            
            // Cập nhật cũng cho menu ngang trên đầu để khớp với danh mục mới
            const topCategoryItems = document.querySelectorAll('.top-category-item');
            topCategoryItems.forEach(item => {
                item.addEventListener('click', () => {
                    topCategoryItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Lấy text của danh mục được chọn
                    const categoryText = item.textContent.trim();
                    
                    // Kiểm tra nếu là "Tất cả" thì hiển thị tất cả trợ lý
                    if (categoryText === "Tất cả") {
                        createAssistantCards(assistants);
                        return;
                    }
                    
                    // Lọc trợ lý theo danh mục tương ứng
                    // Dùng map để chuyển đổi tên tiếng Việt sang tiếng Anh
                    const categoryMap = {
                        'Viết lách': 'writing',
                        'Lập trình': 'programming', 
                        'Giáo dục': 'education',
                        'Kinh doanh': 'business',
                        'Thiết kế': 'design',
                        'Sức khỏe': 'health',
                        'Phong cách sống': 'lifestyle'
                    };
                    
                    const categoryKey = categoryMap[categoryText];
                    if (categoryKey) {
                        const filteredAssistants = assistants.filter(a => a.category === categoryKey);
                        createAssistantCards(filteredAssistants);
                    }
                });
            });
            
            // Gọi hàm tạo submenu khi trang đã tải xong và danh sách trợ lý đã có sẵn
            if (window.assistants && window.assistants.length > 0) {
                assistants = window.assistants;
                createAssistantSubmenus();
            } else {
                // Nếu danh sách trợ lý chưa có sẵn, đợi đến khi nó được gán
                const assistantsInterval = setInterval(() => {
                    if (window.assistants && window.assistants.length > 0) {
                        assistants = window.assistants;
                        createAssistantSubmenus();
                        clearInterval(assistantsInterval);
                    }
                }, 100);
            }
        });
        
        // Function to check if user can access an assistant
        function canAccessAssistant(assistantId) {
            // Đảm bảo assistantId là kiểu số
            const id = parseInt(assistantId, 10);
            if (isNaN(id)) return false;
            
            // Nếu AuthService có sẵn và có hàm canAccessAssistant, sử dụng nó
            if (typeof AuthService !== 'undefined' && typeof AuthService.canAccessAssistant === 'function') {
                return AuthService.canAccessAssistant(id);
            }
            
            // Kiểm tra xem purchasedAssistants có tồn tại trong AuthService
            if (typeof AuthService !== 'undefined' && typeof AuthService.getPurchasedAssistants === 'function') {
                const purchasedAssistants = AuthService.getPurchasedAssistants();
                return Array.isArray(purchasedAssistants) && purchasedAssistants.includes(id);
            }
            
            // Mô phỏng kiểm tra quyền truy cập nếu AuthService không khả dụng
            // Giả vờ như trợ lý có ID lẻ đã được mua
            return id % 2 === 1;
        }
        
        // Helper function to get category name in Vietnamese
        function getCategoryName(category) {
            const categoryNames = {
                'writing': 'Viết lách',
                'programming': 'Lập trình',
                'education': 'Giáo dục',
                'business': 'Kinh doanh',
                'design': 'Thiết kế',
                'health': 'Sức khỏe',
                'lifestyle': 'Phong cách sống'
            };
            
            return categoryNames[category] || category;
        }
        
        // Wait for the page to load
        document.addEventListener('DOMContentLoaded', async function() {
            // Mobile menu toggle
            const menuToggle = document.getElementById('menuToggle');
            const sidebar = document.querySelector('.sidebar');
            
            if (menuToggle) {
                menuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                });
            }
            
            // Create AI particles effect
            const particlesContainer = document.getElementById('aiParticles');
            const particleCount = 15;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('ai-particle');
                
                const size = Math.random() * 20 + 5;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.bottom = `-${size}px`;
                
                const duration = Math.random() * 20 + 10;
                particle.style.animationDuration = `${duration}s`;
                particle.style.animationDelay = `${Math.random() * 10}s`;
                
                particlesContainer.appendChild(particle);
            }
            
            // Khai báo danh sách trợ lý AI (được gán vào biến toàn cục để sử dụng ở nhiều nơi)
            window.assistants = [
                {
                    id: 1,
                    number: "01",
                    code: "TLAI-VIET01",
                    name: "WriterGPT",
                    category: "writing",
                    description: "Trợ lý viết bài chuyên nghiệp với khả năng tạo nội dung sáng tạo, sửa lỗi ngữ pháp và cải thiện văn phong.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1455390582262-044cdead277a?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 2,
                    number: "02",
                    code: "TLAI-LTRINH01",
                    name: "CodeMaster AI",
                    category: "programming",
                    description: "Hỗ trợ lập trình viên tìm kiếm lỗi, tối ưu mã nguồn và tạo code mẫu cho nhiều ngôn ngữ khác nhau.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1555066931-4365d14bab8c?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 3,
                    number: "03",
                    code: "TLAI-GDUC01",
                    name: "EduTeach",
                    category: "education",
                    description: "Trợ giảng AI giúp học sinh hiểu bài, giải đáp thắc mắc và cung cấp tài liệu học tập phù hợp.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1427504494785-3a9ca7044f45?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 4,
                    number: "04",
                    code: "TLAI-KDOANH01",
                    name: "BusinessGPT",
                    category: "business",
                    description: "Tư vấn chiến lược kinh doanh, phân tích thị trường và đề xuất giải pháp tối ưu cho doanh nghiệp.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 5,
                    number: "05",
                    code: "TLAI-THIETKE01",
                    name: "DesignAI",
                    category: "design",
                    description: "Công cụ thiết kế thông minh giúp tạo giao diện, hình ảnh và đồ họa chuyên nghiệp.",
                    rating: 4.5,
                    image: "https://images.unsplash.com/photo-1561070791-2526d30994b5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 6,
                    number: "06",
                    code: "TLAI-SKHOE01",
                    name: "HealthCoach",
                    category: "health",
                    description: "Trợ lý sức khỏe cá nhân, đưa ra lời khuyên về dinh dưỡng, tập luyện và theo dõi tiến trình.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 7,
                    number: "07",
                    code: "TLAI-PCACH01",
                    name: "LifestyleGuru",
                    category: "lifestyle",
                    description: "Tư vấn phong cách sống, sắp xếp thời gian và cân bằng cuộc sống cá nhân và công việc.",
                    rating: 4.4,
                    image: "https://images.unsplash.com/photo-1531234799389-dcb7651eb0a2?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 8,
                    number: "08",
                    code: "TLAI-VIET02",
                    name: "ContentMaster",
                    category: "writing",
                    description: "Trợ lý tạo content cho mạng xã hội, blog và website với khả năng tối ưu SEO.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1499750310107-5fef28a66643?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 9,
                    number: "09",
                    code: "TLAI-LTRINH02",
                    name: "WebDev Assistant",
                    category: "programming",
                    description: "Chuyên gia phát triển web, giúp tạo website, tối ưu hiệu suất và responsive design.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1522542550221-31fd19575a2d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 10,
                    number: "10",
                    code: "TLAI-GDUC02",
                    name: "LanguageTutor",
                    category: "education",
                    description: "Gia sư ngôn ngữ AI, dạy nhiều ngôn ngữ khác nhau với phương pháp cá nhân hóa.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1546410531-bb4caa6b424d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 11,
                    number: "11",
                    code: "TLAI-KDOANH02",
                    name: "MarketingPro",
                    category: "business",
                    description: "Chuyên gia marketing AI, phân tích chiến dịch và đề xuất chiến lược tiếp thị hiệu quả.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1542744173-8e7e53415bb0?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 12,
                    number: "12",
                    code: "TLAI-KDOANH03",
                    name: "FinanceWiz",
                    category: "business",
                    description: "Trợ lý tài chính cá nhân, giúp quản lý ngân sách, đầu tư và lập kế hoạch tài chính.",
                    rating: 4.5,
                    image: "https://images.unsplash.com/photo-1579621970588-a35d0e7ab9b6?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 13,
                    number: "13",
                    code: "TLAI-KTOAN01",
                    name: "AI.KẾ TOÁN",
                    category: "business",
                    description: "Trợ lý kế toán AI, hỗ trợ quản lý sổ sách, báo cáo tài chính và tư vấn thuế.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 14,
                    number: "14",
                    code: "TLAI-VIET03",
                    name: "BlogBuddy",
                    category: "writing",
                    description: "Trợ lý chuyên viết blog, tạo nội dung hấp dẫn và thu hút người đọc với phong cách riêng biệt.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 15,
                    number: "15",
                    code: "TLAI-VIET04",
                    name: "ScriptMaster",
                    category: "writing",
                    description: "Trợ lý viết kịch bản, biên tập lời thoại và cấu trúc câu chuyện cho phim, video và podcasts.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1485846234645-a62644f84728?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 16,
                    number: "16",
                    code: "TLAI-LTRINH03",
                    name: "MobileDevGenius",
                    category: "programming",
                    description: "Chuyên gia phát triển ứng dụng di động, hỗ trợ lập trình iOS, Android và cross-platform.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1581291518633-83b4ebd1d83e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 17,
                    number: "17",
                    code: "TLAI-LTRINH04",
                    name: "DataScientistAI",
                    category: "programming",
                    description: "Trợ lý khoa học dữ liệu, giúp phân tích, trực quan hóa dữ liệu và xây dựng mô hình ML/AI.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1551288049-bebda4e38f71?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 18,
                    number: "18",
                    code: "TLAI-GDUC03",
                    name: "MathGenius",
                    category: "education",
                    description: "Trợ lý dạy toán, giải thích các khái niệm phức tạp và hướng dẫn giải bài tập từ cơ bản đến nâng cao.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 19,
                    number: "19",
                    code: "TLAI-GDUC04",
                    name: "HistoryExplorer",
                    category: "education",
                    description: "Trợ lý chuyên về lịch sử, kể chuyện hấp dẫn về các sự kiện lịch sử và nhân vật nổi tiếng.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1461360228754-6e81c478b882?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 20,
                    number: "20",
                    code: "TLAI-KDOANH04",
                    name: "StartupMentor",
                    category: "business",
                    description: "Cố vấn khởi nghiệp, giúp xây dựng kế hoạch kinh doanh, tìm kiếm nhà đầu tư và phát triển sản phẩm.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1450101499163-c8848c66ca85?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 21,
                    number: "21",
                    code: "TLAI-THIETKE02",
                    name: "UXMaster",
                    category: "design",
                    description: "Chuyên gia trải nghiệm người dùng, tư vấn về thiết kế UX/UI và cải thiện tính khả dụng của sản phẩm.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1507238691740-187a5b1d37b8?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 22,
                    number: "22",
                    code: "TLAI-THIETKE03",
                    name: "LogoCreator",
                    category: "design",
                    description: "Trợ lý thiết kế logo chuyên nghiệp, giúp xây dựng nhận diện thương hiệu ấn tượng và độc đáo.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1497015289639-54688650d173?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 23,
                    number: "23",
                    code: "TLAI-THIETKE04",
                    name: "MotionGraphics",
                    category: "design",
                    description: "Chuyên gia đồ họa chuyển động, tư vấn tạo hiệu ứng video, animation và trình bày trực quan.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1558655146-9f40138edfeb?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 24,
                    number: "24",
                    code: "TLAI-SKHOE02",
                    name: "NutritionExpert",
                    category: "health",
                    description: "Chuyên gia dinh dưỡng, tư vấn chế độ ăn uống lành mạnh, kế hoạch bữa ăn và thực đơn cân bằng.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1505576399279-565b52d4ac71?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 25,
                    number: "25",
                    code: "TLAI-SKHOE03",
                    name: "FitnessTrainer",
                    category: "health",
                    description: "Huấn luyện viên thể hình ảo, thiết kế lịch tập luyện cá nhân hóa và theo dõi kết quả tập luyện.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 26,
                    number: "26",
                    code: "TLAI-SKHOE04",
                    name: "MindfulnessGuide",
                    category: "health",
                    description: "Hướng dẫn thiền và thực hành chánh niệm, giúp giảm stress và cải thiện sức khỏe tinh thần.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1506126613408-eca07ce68773?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 27,
                    number: "27",
                    code: "TLAI-PCACH02",
                    name: "TravelAdvisor",
                    category: "lifestyle",
                    description: "Cố vấn du lịch thông minh, gợi ý địa điểm, lập kế hoạch chuyến đi và chia sẻ bí quyết du lịch.",
                    rating: 4.8,
                    image: "https://images.unsplash.com/photo-1503220317375-aaad61436b1b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 28,
                    number: "28",
                    code: "TLAI-PCACH03",
                    name: "HomeDecorator",
                    category: "lifestyle",
                    description: "Trợ lý trang trí nội thất, tư vấn phong cách trang trí, phối màu và lựa chọn nội thất phù hợp.",
                    rating: 4.6,
                    image: "https://images.unsplash.com/photo-1585412727339-54e4bae3bbf9?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 29,
                    number: "29",
                    code: "TLAI-PCACH04",
                    name: "PersonalStylist",
                    category: "lifestyle",
                    description: "Stylist cá nhân, tư vấn phong cách thời trang, phối đồ và mua sắm thông minh theo từng dịp.",
                    rating: 4.7,
                    image: "https://images.unsplash.com/photo-1483985988355-763728e1935b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                },
                {
                    id: 30,
                    number: "30",
                    code: "TLAI-LTRINH05",
                    name: "AIEthicsAdvisor",
                    category: "programming",
                    description: "Cố vấn đạo đức AI, giúp phát triển các hệ thống AI có trách nhiệm, công bằng và minh bạch.",
                    rating: 4.9,
                    image: "https://images.unsplash.com/photo-1620712943543-bcc4688e7485?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80"
                }
            ];
            
            // Thêm biến local để sử dụng trong file này
            const assistants = window.assistants;
            
            // Function to create assistant cards
            function createAssistantCards(assistantList) {
                console.log('createAssistantCards được gọi với', assistantList.length, 'trợ lý');
                
                // Kiểm tra tham số đầu vào
                if (!assistantList || !Array.isArray(assistantList)) {
                    console.error('createAssistantCards: assistantList không hợp lệ!', assistantList);
                    return;
                }
                
                const cardsContainer = document.getElementById('cardsContainer');
                if (!cardsContainer) {
                    console.error('Cards container not found! Creating a new one...');
                    // Create a cards container if it doesn't exist
                    const mainContent = document.querySelector('.main-content');
                    if (mainContent) {
                        const newCardsContainer = document.createElement('div');
                        newCardsContainer.id = 'cardsContainer';
                        newCardsContainer.className = 'cards-container';
                        mainContent.appendChild(newCardsContainer);
                        console.log('Created new cards container');
                    } else {
                        console.error('Main content element not found!');
                        return;
                    }
                }
                
                // Lấy container sau khi đã tạo (nếu cần)
                const container = document.getElementById('cardsContainer');
                if (!container) {
                    console.error('Container vẫn không tìm thấy sau khi tạo!');
                    return;
                }
                
                // Xóa nội dung hiện tại của container
                container.innerHTML = '';
                console.log('Đã xóa nội dung container hiện tại');
                
                if (assistantList.length === 0) {
                    console.log('Không có trợ lý nào để hiển thị');
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'empty-message';
                    emptyMessage.textContent = 'Không tìm thấy trợ lý AI phù hợp.';
                    emptyMessage.style.width = '100%';
                    emptyMessage.style.textAlign = 'center';
                    emptyMessage.style.padding = '30px';
                    emptyMessage.style.color = 'rgba(255, 255, 255, 0.7)';
                    container.appendChild(emptyMessage);
                    return;
                }
                
                console.log('Bắt đầu tạo thẻ cho các trợ lý...');
                
                // Tạo các thẻ trợ lý
                assistantList.forEach((assistant, index) => {
                    console.log(`Đang tạo thẻ cho trợ lý thứ ${index + 1}:`, assistant.name);
                    
                    // Kiểm tra dữ liệu trợ lý
                    if (!assistant || !assistant.id || !assistant.name) {
                        console.error('Dữ liệu trợ lý không hợp lệ:', assistant);
                        return;
                    }
                    
                    // Create stars based on rating
                    let starsHTML = '';
                    const fullStars = Math.floor(assistant.rating);
                    const halfStar = assistant.rating % 1 >= 0.5;
                    
                    for (let i = 0; i < 5; i++) {
                        if (i < fullStars) {
                            starsHTML += '<i class="fas fa-star star"></i>';
                        } else if (i === fullStars && halfStar) {
                            starsHTML += '<i class="fas fa-star-half-alt star"></i>';
                        } else {
                            starsHTML += '<i class="far fa-star star"></i>';
                        }
                    }
                    
                    // Kiểm tra xem người dùng đã mua trợ lý hay chưa
                    const isLoggedIn = typeof AuthService !== 'undefined' && AuthService.isLoggedIn();
                    const hasAccess = isLoggedIn && canAccessAssistant(assistant.id);
                    
                    // Tạo class cho card dựa trên trạng thái đã mua
                    let cardClass = 'assistant-card';
                    let statusBadgeHTML = '';
                    
                    if (isLoggedIn) {
                        if (hasAccess) {
                            cardClass += ' purchased';
                            statusBadgeHTML = '<div class="assistant-status-badge badge-purchased">Đã mua</div>';
                        } else {
                            cardClass += ' not-purchased';
                            statusBadgeHTML = '<div class="assistant-status-badge badge-not-purchased">Chưa mua</div>';
                        }
                    }
                    
                    const card = document.createElement('div');
                    card.className = cardClass;
                    card.dataset.category = assistant.category;
                    card.dataset.id = assistant.id;
                    card.dataset.name = assistant.name;
                    card.dataset.image = assistant.image || 'https://via.placeholder.com/500';
                    card.dataset.code = assistant.code || '';
                    
                    // Tạo HTML cho nút thích hợp dựa trên trạng thái đã mua
                    let buttonHTML = '';
                    if (isLoggedIn) {
                        if (hasAccess) {
                            buttonHTML = `
                                <button class="assistant-btn chat-btn" data-id="${assistant.id}">
                                    <div class="chat-icon-wrapper">
                                        <i class="fas fa-comments"></i>
                                    </div>
                                    Chat ngay
                                </button>
                            `;
                        } else {
                            buttonHTML = `
                                <button class="assistant-btn purchase-btn" data-id="${assistant.id}">
                                    <div class="chat-icon-wrapper">
                                        <i class="fas fa-shopping-cart"></i>
                                    </div>
                                    Mua ngay
                                </button>
                            `;
                        }
                    } else {
                        // Nếu chưa đăng nhập, hiển thị nút yêu cầu đăng nhập
                        buttonHTML = `
                            <button class="assistant-btn login-required" data-id="${assistant.id}">
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-sign-in-alt"></i>
                                </div>
                                Đăng nhập
                            </button>
                        `;
                    }
                    
                    // Đảm bảo các trường dữ liệu có giá trị mặc định nếu thiếu
                    const safeNumber = assistant.number || '';
                    const safeName = assistant.name || 'Trợ lý không xác định';
                    const safeCode = assistant.code || '';
                    const safeDescription = assistant.description || 'Không có mô tả';
                    const safeImage = assistant.image || 'https://via.placeholder.com/500';
                    const safeRating = assistant.rating || 0;
                    
                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-bg" style="background-image: url('${safeImage}')"></div>
                            ${statusBadgeHTML}
                        </div>
                        <div class="card-body">
                            <span class="assistant-category">${getCategoryName(assistant.category)}</span>
                            <h3 class="assistant-name">số ${safeNumber} - trợ lý ${safeName} - mã ${safeCode}</h3>
                            <p class="assistant-desc">${safeDescription.length > 80 ? safeDescription.substring(0, 80) + '...' : safeDescription}</p>
                            <div class="card-footer">
                                <div class="rating">
                                    ${starsHTML}
                                    <span class="rating-value">${safeRating}</span>
                                </div>
                                ${buttonHTML}
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(card);
                    console.log(`Đã thêm thẻ trợ lý ${safeName} vào container`);
                });
                
                // Add event listeners to buttons
                setupAssistantButtons();
                console.log('Đã thiết lập sự kiện cho các nút trợ lý');
            }
            
            // Function to get category name in Vietnamese
            function getCategoryName(category) {
                const categoryNames = {
                    'writing': 'Viết lách',
                    'programming': 'Lập trình',
                    'education': 'Giáo dục',
                    'business': 'Kinh doanh',
                    'design': 'Thiết kế',
                    'health': 'Sức khỏe',
                    'lifestyle': 'Phong cách sống'
                };
                
                return categoryNames[category] || category;
            }
            
            // Kiểm tra xem người dùng có quyền truy cập trợ lý không
            function canAccessAssistant(assistantId) {
                // Đảm bảo assistantId là kiểu số
                const id = parseInt(assistantId, 10);
                if (isNaN(id)) return false;
                
                // Nếu AuthService có sẵn và có hàm canAccessAssistant, sử dụng nó
                if (typeof AuthService !== 'undefined' && typeof AuthService.canAccessAssistant === 'function') {
                    return AuthService.canAccessAssistant(id);
                }
                
                // Kiểm tra xem purchasedAssistants có tồn tại trong AuthService
                if (typeof AuthService !== 'undefined' && typeof AuthService.getPurchasedAssistants === 'function') {
                    const purchasedAssistants = AuthService.getPurchasedAssistants();
                    return Array.isArray(purchasedAssistants) && purchasedAssistants.includes(id);
                }
                
                // Mô phỏng kiểm tra quyền truy cập nếu AuthService không khả dụng
                // Giả vờ như trợ lý có ID lẻ đã được mua
                return id % 2 === 1;
            }
            
            // Category filter functionality
            const categoryItems = document.querySelectorAll('.category-item');
            categoryItems.forEach(item => {
                item.addEventListener('click', () => {
                    // Update active class
                    categoryItems.forEach(cat => cat.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Cập nhật trạng thái của tất cả trợ lý dựa trên danh mục đã chọn
                    updateAssistantStatus();
                });
            });
            
            // Biến lưu trữ từ khóa tìm kiếm hiện tại
            let currentSearchTerm = '';
            
            // Search functionality
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', () => {
                    currentSearchTerm = searchInput.value.toLowerCase();
                    updateAssistantStatus();
                });
            }
            
// Cập nhật hàm updateAssistantStatus để hỗ trợ tìm kiếm kết hợp với lọc danh mục
function updateAssistantStatus() {
    console.log("Updating assistant status...");
    
    // Tạo biến cục bộ mới thay vì gán lại biến assistants toàn cục
    let currentAssistants = window.assistants || [];
    
    // Hiển thị tất cả các trợ lý vì đã xóa danh mục ngang
    console.log("Hiển thị tất cả trợ lý");
    
    // Sử dụng tất cả trợ lý (không lọc theo category)
    let filteredAssistants = [...currentAssistants];
    
    // Hiển thị trợ lý
    displayAssistants(filteredAssistants);
}            
            // Hàm hiển thị tất cả trợ lý
            function displayAllAssistants() {
                displayAssistants([...assistants]);
            }
            
            // Hàm hiển thị danh sách trợ lý
            function displayAssistants(assistantsList) {
                // Lấy container chứa cards
                const cardsContainer = document.getElementById('cardsContainer');
                if (!cardsContainer) {
                    console.error("Không tìm thấy container chứa cards");
                    return;
                }
                
                // Xóa toàn bộ nội dung hiện tại
                cardsContainer.innerHTML = '';
                
                // Lọc theo từ khóa tìm kiếm nếu có
                if (currentSearchTerm && currentSearchTerm.trim() !== '') {
                    assistantsList = assistantsList.filter(assistant => {
                        const formattedString = `số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}`.toLowerCase();
                        
                        // Tìm kiếm exact format trước
                        if (formattedString.includes(currentSearchTerm)) {
                            return true;
                        }
                        
                        // Sau đó kiểm tra từng trường riêng biệt
                        return assistant.name.toLowerCase().includes(currentSearchTerm) ||
                            assistant.description.toLowerCase().includes(currentSearchTerm) ||
                            getCategoryName(assistant.category).toLowerCase().includes(currentSearchTerm) ||
                            assistant.number.toLowerCase().includes(currentSearchTerm) ||
                            assistant.code.toLowerCase().includes(currentSearchTerm);
                    });
                }
                
                // Kiểm tra nếu không có trợ lý nào thỏa mãn
                if (assistantsList.length === 0) {
                    const emptyMessage = document.createElement('div');
                    emptyMessage.className = 'empty-message';
                    emptyMessage.textContent = currentSearchTerm 
                        ? `Không tìm thấy trợ lý AI phù hợp với từ khóa "${currentSearchTerm}" trong danh mục này.`
                        : 'Không tìm thấy trợ lý AI phù hợp trong danh mục này.';
                    emptyMessage.style.width = '100%';
                    emptyMessage.style.textAlign = 'center';
                    emptyMessage.style.padding = '30px';
                    emptyMessage.style.color = 'rgba(255, 255, 255, 0.7)';
                    cardsContainer.appendChild(emptyMessage);
                    return;
                }
                
                assistantsList.forEach(assistant => {
                    // Tạo stars dựa trên rating
                    let starsHTML = '';
                    const fullStars = Math.floor(assistant.rating);
                    const halfStar = assistant.rating % 1 >= 0.5;
                    
                    for (let i = 0; i < 5; i++) {
                        if (i < fullStars) {
                            starsHTML += '<i class="fas fa-star star"></i>';
                        } else if (i === fullStars && halfStar) {
                            starsHTML += '<i class="fas fa-star-half-alt star"></i>';
                        } else {
                            starsHTML += '<i class="far fa-star star"></i>';
                        }
                    }
                    
                    // Kiểm tra trạng thái mua của trợ lý
                    const isLoggedIn = typeof AuthService !== 'undefined' && AuthService.isLoggedIn();
                    const hasAccess = isLoggedIn && canAccessAssistant(assistant.id);
                    
                    // Thiết lập class cho card
                    let cardClass = 'assistant-card';
                    if (isLoggedIn) {
                        if (hasAccess) {
                            cardClass += ' purchased';
                        } else {
                            cardClass += ' not-purchased';
                        }
                    }
                    
                    // Tạo thẻ trạng thái (badge)
                    let statusBadgeHTML = '';
                    if (isLoggedIn) {
                        if (hasAccess) {
                            statusBadgeHTML = '<div class="assistant-status-badge badge-purchased">Đã mua</div>';
                        } else {
                            statusBadgeHTML = '<div class="assistant-status-badge badge-not-purchased">Chưa mua</div>';
                        }
                    }
                    
                    // Tạo nút tương ứng với trạng thái
                    let buttonHTML = '';
                    if (isLoggedIn) {
                        if (hasAccess) {
                            buttonHTML = `
                                <button class="assistant-btn purchased-btn" data-id="${assistant.id}" disabled>
                                    <div class="chat-icon-wrapper">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    Đã mua
                                </button>
                            `;
                        } else {
                            buttonHTML = `
                                <button class="assistant-btn purchase-btn" data-id="${assistant.id}">
                                    <div class="chat-icon-wrapper">
                                        <i class="fas fa-shopping-cart"></i>
                                    </div>
                                    Mua ngay
                                </button>
                            `;
                        }
                    } else {
                        buttonHTML = `
                            <button class="assistant-btn login-required" data-id="${assistant.id}">
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-sign-in-alt"></i>
                                </div>
                                Đăng nhập
                            </button>
                        `;
                    }
                    
                    // Tạo nội dung HTML cho card
                    const card = document.createElement('div');
                    card.className = cardClass;
                    card.dataset.category = assistant.category;
                    card.dataset.id = assistant.id;
                    card.dataset.name = assistant.name;
                    card.dataset.image = assistant.image;
                    card.dataset.code = assistant.code;
                    
                    card.innerHTML = `
                        <div class="card-header">
                            <div class="card-bg" style="background-image: url('${assistant.image}')"></div>
                            ${statusBadgeHTML}
                        </div>
                        <div class="card-body">
                            <span class="assistant-category">${getCategoryName(assistant.category)}</span>
                            <h3 class="assistant-name">số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}</h3>
                            <p class="assistant-desc">${assistant.description.length > 80 ? assistant.description.substring(0, 80) + '...' : assistant.description}</p>
                            <div class="card-footer">
                                <div class="rating">
                                    ${starsHTML}
                                    <span class="rating-value">${assistant.rating}</span>
                                </div>
                                ${buttonHTML}
                            </div>
                        </div>
                    `;
                    
                    // Thêm card vào container
                    cardsContainer.appendChild(card);
                });
                
                // Thiết lập sự kiện cho các nút
                setupAssistantButtons();
            }
            
            // Removed format search functionality code
            
            // Function to create carousel slides - disabled as carousel is removed
            function createCarouselSlides() {
                // Function disabled - carousel removed
                console.log('Carousel functionality disabled');
                return;
            }
            
            // Carousel controls - disabled as carousel is removed
            function setupCarouselControls() {
                // Function disabled - carousel removed
                console.log('Carousel controls disabled');
                return;
            }
            
            // Initially load all assistants
            createAssistantCards(assistants);
            
            
            const cardsContainer = document.getElementById('cardsContainer');
            if (cardsContainer && cardsContainer.children.length === 0) {
                console.log('Cards container is empty, re-initializing...');
                createAssistantCards(assistants);
            }
            
            // Chat modal functionality
            const chatModal = document.getElementById('chatModal');
            const chatCloseBtn = document.getElementById('chatCloseBtn');
            const chatInput = document.getElementById('chatInput');
            const chatSendBtn = document.getElementById('chatSendBtn');
            const chatBody = document.getElementById('chatBody');
            
            // Close chat modal
            if (chatCloseBtn) {
                chatCloseBtn.addEventListener('click', () => {
                    chatModal.classList.remove('active');
                });
            }
            
            // Send chat message
            function sendChatMessage() {
                const messageText = chatInput.value.trim();
                
                if (messageText) {
                    // Create user message
                    const currentTime = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    const userMessage = document.createElement('div');
                    userMessage.className = 'chat-message user-message';
                    userMessage.innerHTML = `
                        <div class="message-bubble">${messageText}</div>
                        <div class="message-time">${currentTime}</div>
                    `;
                    chatBody.appendChild(userMessage);
                    
                    // Clear input
                    chatInput.value = '';
                    
                    // Scroll to bottom
                    chatBody.scrollTop = chatBody.scrollHeight;
                    
                    // Simulate assistant response after a delay
                    setTimeout(() => {
                        const assistantMessage = document.createElement('div');
                        assistantMessage.className = 'chat-message assistant-message';
                        assistantMessage.innerHTML = `
                            <div class="message-bubble">Cảm ơn tin nhắn của bạn! Tôi đang xử lý yêu cầu...</div>
                            <div class="message-time">${new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}</div>
                        `;
                        chatBody.appendChild(assistantMessage);
                        
                        // Scroll to bottom again
                        chatBody.scrollTop = chatBody.scrollHeight;
                    }, 1000);
                }
            }
            
            if (chatSendBtn) {
                chatSendBtn.addEventListener('click', sendChatMessage);
            }
            
            if (chatInput) {
                chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        sendChatMessage();
                    }
                });
            }
            
            // Close modals when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target === chatModal) {
                    chatModal.classList.remove('active');
                }
            });

            // Connect sidebar category links to category filter
            const sidebarCategoryLinks = document.querySelectorAll('.sidebar .nav-links a[data-category]');
            sidebarCategoryLinks.forEach(link => {
                link.addEventListener('click', () => {
                    // Update active class in sidebar
                    document.querySelectorAll('.sidebar .nav-links a').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    link.classList.add('active');
                    
                    // Lấy danh mục
                    const category = link.dataset.category;
                    console.log("Sidebar: Chọn danh mục", category);
                    
                    // Cập nhật trạng thái active cho danh mục ngang
                    document.querySelectorAll('.category-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Tìm và active danh mục tương ứng
                    let categoryItem = document.querySelector(`.category-item[data-category="${category}"]`);
                    if (!categoryItem) {
                        // Nếu không tìm thấy, tạo một mục mới
                        const categoryNav = document.getElementById('categoryNav');
                        if (categoryNav) {
                            categoryItem = document.createElement('div');
                            categoryItem.className = 'category-item';
                            categoryItem.dataset.category = category;
                            categoryItem.textContent = getCategoryName(category);
                            categoryNav.appendChild(categoryItem);
                            
                            // Thêm sự kiện click cho mục mới
                            categoryItem.addEventListener('click', () => {
                                document.querySelectorAll('.category-item').forEach(item => {
                                    item.classList.remove('active');
                                });
                                categoryItem.classList.add('active');
                                updateAssistantStatus();
                            });
                        }
                    }
                    
                    // Active danh mục đã chọn
                    if (categoryItem) {
                        categoryItem.classList.add('active');
                    }
                    
                    // Cập nhật trạng thái trợ lý
                    updateAssistantStatus();
                });
            });
            
            // Reset active state when clicking "all assistants" link
            const allAssistantsLink = document.querySelector('.sidebar .nav-links a[href="ai-assistants.html"]');
            if (allAssistantsLink) {
                allAssistantsLink.addEventListener('click', () => {
                    // Update active class in sidebar
                    document.querySelectorAll('.sidebar .nav-links a').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    allAssistantsLink.classList.add('active');
                    
                    // Reset category filter to "all"
                    document.querySelectorAll('.category-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Find and activate the "all" category
                    let allCategoryItem = document.querySelector('.category-item[data-category="all"]');
                    if (!allCategoryItem) {
                        // Create an "all" category if it doesn't exist
                        const categoryNav = document.getElementById('categoryNav');
                        if (categoryNav) {
                            allCategoryItem = document.createElement('div');
                            allCategoryItem.className = 'category-item';
                            allCategoryItem.dataset.category = 'all';
                            allCategoryItem.textContent = 'Tất cả';
                            categoryNav.appendChild(allCategoryItem);
                            
                            // Add click event to the new item
                            allCategoryItem.addEventListener('click', () => {
                                document.querySelectorAll('.category-item').forEach(item => {
                                    item.classList.remove('active');
                                });
                                allCategoryItem.classList.add('active');
                                updateAssistantStatus();
                            });
                        }
                    }
                    
                    // Activate the "all" category
                    if (allCategoryItem) {
                        allCategoryItem.classList.add('active');
                    }
                    
                    // Update assistant cards
                    updateAssistantStatus();
                });
            }

            // Format search button functionality has been removed
        });

        // My Assistants Modal
        const myAssistantsBtn = document.getElementById('myAssistantsBtn');
        const myAssistantsModal = document.getElementById('myAssistantsModal');
        const myAssistantsCloseBtn = document.getElementById('myAssistantsCloseBtn');
        
        if (myAssistantsBtn && myAssistantsModal && myAssistantsCloseBtn) {
            // Xóa sự kiện click cũ và sử dụng AuthService để xử lý
            myAssistantsBtn.addEventListener('click', function() {
                // Hàm tiện ích để chuyển đổi tên danh mục
                function getCategoryNameLocal(category) {
                    const categoryNames = {
                        'writing': 'Viết lách',
                        'programming': 'Lập trình',
                        'education': 'Giáo dục',
                        'business': 'Kinh doanh',
                        'design': 'Thiết kế',
                        'health': 'Sức khỏe',
                        'lifestyle': 'Phong cách sống'
                    }
                    
                    return categoryNames[category] || category;
                }
                
                // Kiểm tra đăng nhập
                if (!AuthService.isLoggedIn()) {
                    // Hiển thị form đăng nhập nếu chưa đăng nhập
                    AuthService.login();
                    return;
                }
                
                // Lấy danh sách trợ lý đã mua
                const purchasedAssistants = AuthService.getPurchasedAssistants();
                
                // Xóa nội dung cũ
                const purchasedListContainer = myAssistantsModal.querySelector('.purchased-assistants-list');
                if (purchasedListContainer) {
                    purchasedListContainer.innerHTML = '';
                
                    // Kiểm tra có trợ lý nào đã mua chưa
                    if (!purchasedAssistants || purchasedAssistants.length === 0) {
                        purchasedListContainer.innerHTML = `
                            <div class="empty-purchased-modal" style="display: flex; flex-direction: column; align-items: center; text-align: center; padding: 30px;">
                                <i class="fas fa-info-circle" style="font-size: 40px; margin-bottom: 15px; color: rgba(255, 255, 255, 0.3);"></i>
                                <p>Bạn chưa mua trợ lý AI nào. Vui lòng mua để sử dụng.</p>
                            </div>
                        `;
                    } else {
                        // Cập nhật thông tin số lượng trợ lý đã mua
                        const infoText = myAssistantsModal.querySelector('.purchased-assistants-info p');
                        if (infoText) {
                            infoText.innerHTML = `
                                Bạn đã mua <span style="font-weight: bold; color: #4cc9f0;">${purchasedAssistants.length} trợ lý AI</span>
                            `;
                        }
                        
                        // Thêm từng trợ lý đã mua vào danh sách
                        purchasedAssistants.forEach(assistantId => {
                            // Tìm thông tin của trợ lý dựa vào ID
                            const assistantInfo = window.assistants.find(a => a.id === assistantId);
                            if (!assistantInfo) return;
                            
                            // Tạo URL giả định dựa trên thông tin trợ lý
                            const assistantUrl = AuthService.getAssistantUrl ? AuthService.getAssistantUrl(assistantInfo.code) : 
                               getAssistantUrl(assistantInfo.code);
                            
                            // Tạo HTML cho trợ lý
                            const assistantHTML = `
                                <div class="purchased-assistant-item">
                                    <div class="assistant-item-header">
                                        <h4><i class="fas fa-robot"></i> ${assistantInfo.number}. ${assistantInfo.name} - <span class="assistant-code">${assistantInfo.code || ''}</span></h4>
                                        <span class="assistant-tag">${getCategoryNameLocal(assistantInfo.category)}</span>
                                    </div>
                                    <div class="assistant-item-body">
                                        <p class="assistant-features">${assistantInfo.description || ''}</p>
                                        <div class="assistant-url">
                                            <strong>URL truy cập:</strong> 
                                            <a href="${assistantUrl}" class="assistant-url-btn" target="_blank">
                                                ${assistantUrl} <i class="fas fa-external-link-alt"></i>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            `;
                            
                            purchasedListContainer.innerHTML += assistantHTML;
                        });
                        
                    }
                }
                
                // Hiển thị modal
                myAssistantsModal.classList.add('active');
            });
            
            myAssistantsCloseBtn.addEventListener('click', function() {
                myAssistantsModal.classList.remove('active');
            });
        }
        
        // Package Info Button in Footer
        const packageInfoBtn = document.getElementById('packageInfoBtn');
        if (packageInfoBtn && myAssistantsModal) {
            packageInfoBtn.addEventListener('click', function() {
                myAssistantsModal.classList.add('active');
            });
        }
        
        // Partner Registration Modal
        const becomePartnerBtn = document.getElementById('becomePartnerBtn');
        const partnerModal = document.getElementById('partnerModal');
        const partnerCloseBtn = document.getElementById('partnerCloseBtn');
        
        if (becomePartnerBtn && partnerModal && partnerCloseBtn) {
            becomePartnerBtn.addEventListener('click', function() {
                partnerModal.classList.add('active');
            });
            
            partnerCloseBtn.addEventListener('click', function() {
                partnerModal.classList.remove('active');
            });
            
            // Partner form submission
            const partnerForm = document.getElementById('partnerForm');
            if (partnerForm) {
                partnerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('Cảm ơn bạn đã đăng ký! Chúng tôi sẽ liên hệ với bạn trong thời gian sớm nhất.');
                    partnerModal.classList.remove('active');
                    partnerForm.reset();
                });
            }
        }
        
        // Partner Register Button in Footer
        const partnerRegisterBtn = document.getElementById('partnerRegisterBtn');
        if (partnerRegisterBtn && partnerModal) {
            partnerRegisterBtn.addEventListener('click', function() {
                partnerModal.classList.add('active');
            });
        }
        
        // Contact Support Modal
        const contactBtn = document.getElementById('contactBtn');
        const contactModal = document.getElementById('contactModal');
        const contactCloseBtn = document.getElementById('contactCloseBtn');
        
        if (contactBtn && contactModal && contactCloseBtn) {
            contactBtn.addEventListener('click', function() {
                contactModal.classList.add('active');
            });
            
            contactCloseBtn.addEventListener('click', function() {
                contactModal.classList.remove('active');
            });
            
            // File upload preview
            const attachmentsInput = document.getElementById('attachments');
            const filePreview = document.getElementById('filePreview');
            
            if (attachmentsInput && filePreview) {
                attachmentsInput.addEventListener('change', function() {
                    filePreview.innerHTML = '';
                    
                    for (let i = 0; i < this.files.length; i++) {
                        const file = this.files[i];
                        const fileItem = document.createElement('div');
                        fileItem.className = 'file-item';
                        
                        if (file.type.startsWith('image/')) {
                            const img = document.createElement('img');
                            img.src = URL.createObjectURL(file);
                            fileItem.appendChild(img);
                        } else if (file.type.startsWith('video/')) {
                            const video = document.createElement('video');
                            video.src = URL.createObjectURL(file);
                            video.setAttribute('muted', 'muted');
                            fileItem.appendChild(video);
                        }
                        
                        const removeBtn = document.createElement('div');
                        removeBtn.className = 'file-remove';
                        removeBtn.innerHTML = '<i class="fas fa-times"></i>';
                        removeBtn.addEventListener('click', function() {
                            fileItem.remove();
                        });
                        
                        fileItem.appendChild(removeBtn);
                        filePreview.appendChild(fileItem);
                    }
                });
            }
            
            // Contact form submission
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('Cảm ơn bạn đã gửi yêu cầu hỗ trợ! Chúng tôi sẽ phản hồi trong thời gian sớm nhất.');
                    contactModal.classList.remove('active');
                    contactForm.reset();
                    if (filePreview) {
                        filePreview.innerHTML = '';
                    }
                });
            }
        }
        
        // Support Request Button in Footer
        const supportRequestBtn = document.getElementById('supportRequestBtn');
        if (supportRequestBtn && contactModal) {
            supportRequestBtn.addEventListener('click', function() {
                contactModal.classList.add('active');
            });
        }
        
        // Close modals when clicking outside
        window.addEventListener('click', (e) => {
            if (e.target === myAssistantsModal) {
                myAssistantsModal.classList.remove('active');
            }
            if (e.target === partnerModal) {
                partnerModal.classList.remove('active');
            }
            if (e.target === contactModal) {
                contactModal.classList.remove('active');
            }
        });

        // Cập nhật trạng thái của tất cả các trợ lý dựa trên trạng thái đăng nhập và danh mục đã chọn
        function updateAssistantStatus() {
            console.log('Updating assistant status...');
            
            // Tìm dòng 3413 - nơi có lỗi "Assignment to constant variable"
            // Thay đổi từ khai báo const sang let
            let assistantElements = document.querySelectorAll('.card'); // thay vì const assistantElements
            
            // Phần còn lại của hàm giữ nguyên
            assistantElements.forEach(card => {
                // ...code hiện có...
            });
        }
        
        // Hàm hiển thị tất cả trợ lý
        function displayAllAssistants() {
            displayAssistants([...assistants]);
        }
        
        // Hàm hiển thị danh sách trợ lý
        function displayAssistants(assistantsList) {
            // Lấy container chứa cards
            const cardsContainer = document.getElementById('cardsContainer');
            if (!cardsContainer) {
                console.error("Không tìm thấy container chứa cards");
                return;
            }
            
            // Xóa toàn bộ nội dung hiện tại
            cardsContainer.innerHTML = '';
            
            // Lọc theo từ khóa tìm kiếm nếu có
            if (currentSearchTerm && currentSearchTerm.trim() !== '') {
                assistantsList = assistantsList.filter(assistant => {
                    const formattedString = `số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}`.toLowerCase();
                    
                    // Tìm kiếm exact format trước
                    if (formattedString.includes(currentSearchTerm)) {
                        return true;
                    }
                    
                    // Sau đó kiểm tra từng trường riêng biệt
                    return assistant.name.toLowerCase().includes(currentSearchTerm) ||
                        assistant.description.toLowerCase().includes(currentSearchTerm) ||
                        getCategoryName(assistant.category).toLowerCase().includes(currentSearchTerm) ||
                        assistant.number.toLowerCase().includes(currentSearchTerm) ||
                        assistant.code.toLowerCase().includes(currentSearchTerm);
                });
            }
            
            // Kiểm tra nếu không có trợ lý nào thỏa mãn
            if (assistantsList.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.className = 'empty-message';
                emptyMessage.textContent = currentSearchTerm 
                    ? `Không tìm thấy trợ lý AI phù hợp với từ khóa "${currentSearchTerm}" trong danh mục này.`
                    : 'Không tìm thấy trợ lý AI phù hợp trong danh mục này.';
                emptyMessage.style.width = '100%';
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.padding = '30px';
                emptyMessage.style.color = 'rgba(255, 255, 255, 0.7)';
                cardsContainer.appendChild(emptyMessage);
                return;
            }
            
            // Tạo card cho từng trợ lý đã lọc
            assistantsList.forEach(assistant => {
                // Tạo stars dựa trên rating
                let starsHTML = '';
                const fullStars = Math.floor(assistant.rating);
                const halfStar = assistant.rating % 1 >= 0.5;
                
                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        starsHTML += '<i class="fas fa-star star"></i>';
                    } else if (i === fullStars && halfStar) {
                        starsHTML += '<i class="fas fa-star-half-alt star"></i>';
                    } else {
                        starsHTML += '<i class="far fa-star star"></i>';
                    }
                }
                
                // Kiểm tra trạng thái mua của trợ lý
                const isLoggedIn = typeof AuthService !== 'undefined' && AuthService.isLoggedIn();
                const hasAccess = isLoggedIn && canAccessAssistant(assistant.id);
                
                // Thiết lập class cho card
                let cardClass = 'assistant-card';
                if (isLoggedIn) {
                    if (hasAccess) {
                        cardClass += ' purchased';
                    } else {
                        cardClass += ' not-purchased';
                    }
                }
                
                // Tạo thẻ trạng thái (badge)
                let statusBadgeHTML = '';
                if (isLoggedIn) {
                    if (hasAccess) {
                        statusBadgeHTML = '<div class="assistant-status-badge badge-purchased">Đã mua</div>';
                    } else {
                        statusBadgeHTML = '<div class="assistant-status-badge badge-not-purchased">Chưa mua</div>';
                    }
                }
                
                // Tạo nút tương ứng với trạng thái
                let buttonHTML = '';
                if (isLoggedIn) {
                    if (hasAccess) {
                        buttonHTML = `
                            <button class="assistant-btn purchased-btn" data-id="${assistant.id}" disabled>
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                Đã mua
                            </button>
                        `;
                    } else {
                        buttonHTML = `
                            <button class="assistant-btn purchase-btn" data-id="${assistant.id}">
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                Mua ngay
                            </button>
                        `;
                    }
                } else {
                    buttonHTML = `
                        <button class="assistant-btn login-required" data-id="${assistant.id}">
                            <div class="chat-icon-wrapper">
                                <i class="fas fa-sign-in-alt"></i>
                            </div>
                            Đăng nhập
                        </button>
                    `;
                }
                
                // Tạo nội dung HTML cho card
                const card = document.createElement('div');
                card.className = cardClass;
                card.dataset.category = assistant.category;
                card.dataset.id = assistant.id;
                card.dataset.name = assistant.name;
                card.dataset.image = assistant.image;
                card.dataset.code = assistant.code;
                
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-bg" style="background-image: url('${assistant.image}')"></div>
                        ${statusBadgeHTML}
                    </div>
                    <div class="card-body">
                        <span class="assistant-category">${getCategoryName(assistant.category)}</span>
                        <h3 class="assistant-name">số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}</h3>
                        <p class="assistant-desc">${assistant.description.length > 80 ? assistant.description.substring(0, 80) + '...' : assistant.description}</p>
                        <div class="card-footer">
                            <div class="rating">
                                ${starsHTML}
                                <span class="rating-value">${assistant.rating}</span>
                            </div>
                            ${buttonHTML}
                        </div>
                    </div>
                `;
                
                // Thêm card vào container
                cardsContainer.appendChild(card);
            });
            
            // Thiết lập sự kiện cho các nút
            setupAssistantButtons();
        }
        
        // Giả lập nghe sự kiện đăng nhập/đăng xuất từ AuthService
        document.addEventListener('auth-status-changed', function() {
            console.log("Auth status changed, updating UI...");
            updateAssistantStatus();
        });
        
        // Nếu AuthService đã tồn tại, thêm callback vào nó
        if (typeof AuthService !== 'undefined') {
            // Theo dõi sự kiện đăng nhập thành công
            document.addEventListener('login-success', function() {
                console.log("Login success, updating assistant status...");
                updateAssistantStatus();
            });
            
            // Theo dõi sự kiện đăng xuất
            document.addEventListener('logout', function() {
                console.log("Logout, updating assistant status...");
                updateAssistantStatus();
            });
        }

        // Initially call updateAssistantStatus to load all assistants
        document.addEventListener('DOMContentLoaded', function() {
            // Danh mục ngang đã bị xóa, không cần khởi tạo nữa
            
            // Kết nối sự kiện cho các danh mục trong sidebar
            const sidebarLinks = document.querySelectorAll('.sidebar .nav-links a[data-category]');
            sidebarLinks.forEach(link => {
                link.addEventListener('click', function() {
                    // Cập nhật trạng thái active trong sidebar
                    document.querySelectorAll('.sidebar .nav-links a').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Lọc dựa trên danh mục đã chọn
                    const category = this.dataset.category;
                    assistants = window.assistants || [];
                    const filteredAssistants = category === 'all' 
                        ? [...assistants]
                        : assistants.filter(assistant => assistant.category === category);
                    
                    // Hiển thị trợ lý đã lọc
                    displayAssistants(filteredAssistants);
                });
            });
            
            // Kết nối sự kiện cho liên kết "Tất cả trợ lý" trong sidebar
            const allAssistantsLink = document.querySelector('.sidebar .nav-links a[href="ai-assistants.html"]');
            if (allAssistantsLink) {
                allAssistantsLink.addEventListener('click', function(e) {
                    // Ngăn chặn hành vi mặc định khi click (chuyển trang)
                    e.preventDefault();
                    
                    // Cập nhật trạng thái active trong sidebar
                    document.querySelectorAll('.sidebar .nav-links a').forEach(navLink => {
                        navLink.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Hiển thị tất cả trợ lý
                    assistants = window.assistants || [];
                    displayAssistants([...assistants]);
                });
            }
            
            // Khởi tạo hiển thị trợ lý
            setTimeout(() => {
                // Đảm bảo assistants đã được tải
                assistants = window.assistants || [];
                updateAssistantStatus();
                console.log("Đã khởi tạo hiển thị trợ lý");
            }, 500);
        });

        // Function to setup assistant buttons
        function setupAssistantButtons() {
            // Get all purchase buttons
            const purchaseButtons = document.querySelectorAll('.assistant-btn.purchase-btn');
            const loginButtons = document.querySelectorAll('.assistant-btn.login-required');
            const chatButtons = document.querySelectorAll('.assistant-btn.chat-btn');
            const notPurchasedModal = document.getElementById('notPurchasedModal');
            const notPurchasedCloseBtn = document.getElementById('notPurchasedCloseBtn');
            const cancelPurchaseBtn = document.getElementById('cancelPurchaseBtn');
            const confirmPurchaseBtn = document.getElementById('confirmPurchaseBtn');
            const notPurchasedAssistantName = document.getElementById('notPurchasedAssistantName');
            
            // Setup events for chat buttons
            chatButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const assistantId = this.dataset.id;
                    const card = this.closest('.assistant-card');
                    
                    // Lấy thông tin trợ lý từ dataset của thẻ
                    const assistantName = card.dataset.name;
                    const assistantImage = card.dataset.image;
                    
                    // Tạo đối tượng trợ lý tạm thời
                    const assistant = {
                        id: parseInt(assistantId, 10),
                        name: assistantName,
                        image: assistantImage
                    };
                    
                    // Mở cửa sổ chat với trợ lý này
                    openChatWithSelectedAssistant(assistant);
                });
            });
            
            // Setup events for purchase buttons
            purchaseButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const assistantId = this.dataset.id;
                    const card = this.closest('.assistant-card');
                    const assistantName = card.dataset.name;
                    
                    // Show the not purchased modal
                    if (notPurchasedModal && notPurchasedAssistantName) {
                        notPurchasedAssistantName.textContent = `Trợ lý ${assistantName}`;
                        notPurchasedModal.classList.add('active');
                        
                        // Setup data attributes for purchase button
                        if (confirmPurchaseBtn) {
                            confirmPurchaseBtn.dataset.id = assistantId;
                            confirmPurchaseBtn.dataset.name = assistantName;
                        }
                    } else {
                        // Fallback to alert if modal not found
                        alert(`Bạn chưa mua trợ lý AI "${assistantName}". Vui lòng mua để sử dụng.`);
                    }
                });
            });
            
            // Setup events for login buttons
            loginButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // Show login modal if exists
                    if (typeof AuthService !== 'undefined' && typeof AuthService.login === 'function') {
                        AuthService.login();
                    } else {
                        alert('Vui lòng đăng nhập để tiếp tục.');
                    }
                });
            });
            
            // Setup close button for not purchased modal
            if (notPurchasedCloseBtn) {
                notPurchasedCloseBtn.addEventListener('click', function() {
                    notPurchasedModal.classList.remove('active');
                });
            }
            
            // Setup cancel button for not purchased modal
            if (cancelPurchaseBtn) {
                cancelPurchaseBtn.addEventListener('click', function() {
                    notPurchasedModal.classList.remove('active');
                });
            }
            
            // Setup confirm purchase button
            if (confirmPurchaseBtn) {
                confirmPurchaseBtn.addEventListener('click', function() {
                    const assistantId = this.dataset.id;
                    const assistantName = this.dataset.name;
                    
                    // Here you would typically handle the purchase logic
                    // For now, just close the modal and show a message
                    notPurchasedModal.classList.remove('active');
                    alert(`Đang xử lý thanh toán cho trợ lý "${assistantName}"...`);
                });
            }
            
            // Close modal when clicking outside
            if (notPurchasedModal) {
                notPurchasedModal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                    }
                });
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.nav-link.expandable').forEach(link => {
                // Clone phần tử để xóa tất cả sự kiện cũ
                const newLink = link.cloneNode(true);
                link.parentNode.replaceChild(newLink, link);
                
                // Thêm sự kiện mới vào phần tử đã clone
                newLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    console.log('Sidebar: Toggle submenu cho danh mục', this.dataset.category);
                    
                    // Tìm submenu tương ứng
                    const submenu = this.nextElementSibling;
                    
                    // Mở/đóng submenu
                    submenu.classList.toggle('open');
                    
                    // Xoay biểu tượng mũi tên nếu có
                    const arrow = this.querySelector('.submenu-toggle');
                    if (arrow) {
                        arrow.classList.toggle('rotate');
                    }
                });
            });
        });

// Hàm mở cửa sổ chat với trợ lý được chọn (tách ra ngoài)
function openChatWithSelectedAssistant(assistant) {
    // Kiểm tra quyền truy cập
    const hasAccess = canAccessAssistant(assistant.id);
    
    if (hasAccess) {
        // Nếu có quyền truy cập, mở cửa sổ chat
        const chatModal = document.getElementById('chatModal');
        const modalAssistantName = document.getElementById('modalAssistantName');
        const modalAssistantAvatar = document.getElementById('modalAssistantAvatar');
        
        if (chatModal && modalAssistantName && modalAssistantAvatar) {
            // Cập nhật thông tin trợ lý trong modal
            modalAssistantName.textContent = assistant.name;
            modalAssistantAvatar.src = assistant.image;
            
            // Hiển thị modal chat
            chatModal.classList.add('active');
            
            // Xóa các tin nhắn cũ (nếu có)
            const chatBody = document.getElementById('chatBody');
            if (chatBody) {
                // Chỉ giữ lại tin nhắn chào mừng đầu tiên
                const welcomeMessage = chatBody.querySelector('.chat-message');
                if (welcomeMessage) {
                    const clonedWelcome = welcomeMessage.cloneNode(true);
                    chatBody.innerHTML = '';
                    chatBody.appendChild(clonedWelcome);
                    
                    // Cập nhật nội dung tin nhắn chào mừng
                    const messageBubble = clonedWelcome.querySelector('.message-bubble');
                    if (messageBubble) {
                        messageBubble.textContent = `Xin chào! Tôi là trợ lý ${assistant.name}. Tôi có thể giúp gì cho bạn hôm nay?`;
                    }
                }
            }
            
            // Focus vào ô input chat
            const chatInput = document.getElementById('chatInput');
            if (chatInput) {
                chatInput.value = '';
                chatInput.focus();
            }
        }
    } else {
        // Nếu chưa có quyền truy cập, hiển thị modal yêu cầu mua
        const notPurchasedModal = document.getElementById('notPurchasedModal');
        const notPurchasedAssistantName = document.getElementById('notPurchasedAssistantName');
        const confirmPurchaseBtn = document.getElementById('confirmPurchaseBtn');
        
        if (notPurchasedModal && notPurchasedAssistantName) {
            notPurchasedAssistantName.textContent = `Trợ lý ${assistant.name}`;
            notPurchasedModal.classList.add('active');
            
            // Setup data attributes for purchase button
            if (confirmPurchaseBtn) {
                confirmPurchaseBtn.dataset.id = assistant.id;
                confirmPurchaseBtn.dataset.name = assistant.name;
            }
        }
    }
}

        // Gọi hàm tạo submenu khi trang đã tải xong và danh sách trợ lý đã có sẵn
        // Dùng dữ liệu trực tiếp từ assistants global
        try {
            console.log('Bắt đầu tạo các submenu từ danh sách trợ lý ban đầu');
            createAssistantSubmenus();
            // Hiển thị tất cả trợ lý ban đầu
            createAssistantCards(assistants);
        } catch (error) {
            console.error('Lỗi khi khởi tạo giao diện:', error);
        }
        
        // Thêm đoạn code này vào phần khai báo event listener của trang web
        document.addEventListener('DOMContentLoaded', function() {
            // Tìm tất cả các liên kết trợ lý con trong submenu
            const assistantSubLinks = document.querySelectorAll('.submenu-link[data-assistant-id]');
            
            // Thêm sự kiện click cho từng liên kết
            assistantSubLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Lấy ID của trợ lý từ data attribute
                    const assistantId = parseInt(this.dataset.assistantId);
                    console.log(`Đã chọn trợ lý có ID: ${assistantId}`);
                    
                    // Đánh dấu liên kết đang chọn là active
                    document.querySelectorAll('.submenu-link').forEach(sublink => {
                        sublink.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Lọc danh sách trợ lý để chỉ hiển thị trợ lý được chọn
                    const selectedAssistant = window.assistants.find(assistant => assistant.id === assistantId);
                    
                    if (selectedAssistant) {
                        // Hiển thị duy nhất trợ lý này
                        displayAssistants([selectedAssistant]);
                    } else {
                        console.error(`Không tìm thấy trợ lý với ID: ${assistantId}`);
                    }
                });
            });
        });

        // Hiển thị thông báo trên console
        console.log('Khởi tạo hoàn tất. Trang web đã sẵn sàng.');
        
        // Xử lý click vào danh mục chính (chỉ mở rộng submenu, không lọc trợ lý)
        const categoryLinks = document.querySelectorAll('.nav-link.expandable');
        
        categoryLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Tìm submenu tương ứng
                const submenu = this.nextElementSibling;
                
                // Mở/đóng submenu
                submenu.classList.toggle('open');
                
                // Xoay biểu tượng mũi tên nếu có
                const arrow = this.querySelector('.submenu-toggle');
                if (arrow) {
                    arrow.classList.toggle('rotate');
                }
                
            });
        });
        
        // Xử lý click vào trợ lý con trong submenu (vẫn giữ chức năng lọc)
        const assistantSubLinks = document.querySelectorAll('.submenu-link');
        assistantSubLinks.forEach(sublink => {
            sublink.addEventListener('click', function(e) {
                e.preventDefault();
                
                const assistantId = parseInt(this.dataset.assistantId);
                
                // Đây là nơi lọc trợ lý theo ID
                const selectedAssistant = window.assistants.find(assistant => assistant.id === assistantId);
                if (selectedAssistant) {
                    displayAssistants([selectedAssistant]);
                }
            });
        });

        // Xử lý sự kiện click cho các mục danh mục trên thanh ngang
        document.addEventListener('DOMContentLoaded', function() {
            const topCategoryItems = document.querySelectorAll('.top-category-item');
            
            topCategoryItems.forEach(item => {
                item.addEventListener('click', function() {
                    // Loại bỏ trạng thái active của tất cả các mục
                    topCategoryItems.forEach(cat => cat.classList.remove('active'));
                    
                    // Thêm trạng thái active cho mục được click
                    this.classList.add('active');
                    
                    // Lấy category từ data attribute
                    const category = this.getAttribute('data-category');
                    console.log('Top Menu: Chọn danh mục', category);
                    
                    // Lọc trợ lý theo danh mục
                    filterAssistantsByCategory(category);
                });
            });
            
            // Hàm lọc trợ lý theo danh mục
            function filterAssistantsByCategory(category) {
                // Lấy danh sách trợ lý từ biến toàn cục
                const allAssistants = window.assistants || [];
                
                let filteredAssistants;
                if (category === 'all') {
                    // Nếu chọn "Tất cả" thì hiển thị toàn bộ trợ lý
                    filteredAssistants = [...allAssistants];
                } else {
                    // Nếu chọn danh mục cụ thể thì lọc theo danh mục đó
                    filteredAssistants = allAssistants.filter(assistant => 
                        assistant.category === category);
                }
                
                // Cập nhật giao diện hiển thị trợ lý
                displayAssistants(filteredAssistants);
                
                // Hiển thị thông báo nếu không có trợ lý nào phù hợp
                const cardsContainer = document.getElementById('cardsContainer');
                if (filteredAssistants.length === 0 && cardsContainer) {
                    cardsContainer.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-search"></i>
                            <p>Không tìm thấy trợ lý AI phù hợp trong danh mục này.</p>
                        </div>
                    `;
                }
            }
        });
// Xóa hoàn toàn một trong hai đoạn code trùng lặp và giữ lại một phiên bản duy nhất

// Cập nhật hiển thị thông tin người dùng
function updateAuthUI() {
    const loginContainer = document.getElementById('loginContainer');
    const userInfoContainer = document.getElementById('userInfoContainer');
    
    if (typeof AuthService !== 'undefined' && AuthService.isLoggedIn()) {
        loginContainer.style.display = 'none';
        userInfoContainer.style.display = 'block';
        
        const userData = AuthService.getCurrentUser();
        document.getElementById('loggedInUserEmail').textContent = userData.email || 'email@example.com';
        
        // Kiểm tra xem phần tử có tồn tại không trước khi cập nhật
        const purchasedInfo = document.getElementById('purchasedAssistantsInfo');
        if (purchasedInfo) {   
            purchasedInfo.textContent = `Đã mua ${userData.purchasedAssistants?.length || 0} trợ lý AI`;
        }
    } else {
        loginContainer.style.display = 'block';
        userInfoContainer.style.display = 'none';
    }
}

// Gán sự kiện cho nút đăng nhập mới
document.getElementById('topLoginBtn').addEventListener('click', function() {
    const loginModal = document.getElementById('loginModal');
    if (loginModal) {
        loginModal.classList.add('active');
    } else {
        const loginModals = document.querySelectorAll('.login-modal');
        if (loginModals.length > 0) {
            loginModals[0].classList.add('active');
        } else {
            console.error('Không tìm thấy modal đăng nhập');
        }
    }
});

// Thêm event listeners khi trang tải xong
document.addEventListener('DOMContentLoaded', function() {
    // Cập nhật UI đăng nhập
    updateAuthUI();
    
    // Tìm và di chuyển container đăng nhập/đăng xuất
    const authContainer = document.querySelector('.user-auth-container');
    if (authContainer) {
        // Di chuyển container đến header thay vì giữ vị trí fixed
        const header = document.querySelector('.header');
        if (header) {
            header.appendChild(authContainer);
        }
    }
});

// Cập nhật UI khi trạng thái đăng nhập thay đổi
document.addEventListener('auth-status-changed', updateAuthUI);
    
    // Chỉ hiển thị giao diện admin cho quản trị viên
    document.addEventListener('DOMContentLoaded', function() {
        // Kiểm tra nếu là quản trị viên (có thể thay bằng logic của bạn)
        const isAdmin = function() {
            // Thực hiện logic kiểm tra quản trị viên tại đây
            // Ví dụ: return localStorage.getItem('userRole') === 'admin';
            
            // Tạm thời cho phép qua URL parameter để demo
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('admin') === 'true';
        };
        
        // Hiển thị giao diện quản trị video nếu là admin
        if (isAdmin()) {
            const adminControls = document.getElementById('videoAdminControls');
            if (adminControls) {
                adminControls.style.display = 'block';
            }
            
            // Xử lý nút cập nhật video
            const updateBtn = document.getElementById('updateVideoBtn');
            if (updateBtn) {
                updateBtn.addEventListener('click', function() {
                    const embedCode = document.getElementById('videoEmbedCode').value.trim();
                    const videoContainer = document.getElementById('videoContainer');
                    
                    if (embedCode && videoContainer) {
                        // Lưu mã nhúng video vào localStorage để giữ lại khi refresh
                        localStorage.setItem('videoEmbedCode', embedCode);
                        
                        // Cập nhật nội dung video
                        videoContainer.innerHTML = embedCode;
                    }
                });
            }
        }
        
        // Khôi phục video từ localStorage nếu có
        const savedEmbedCode = localStorage.getItem('videoEmbedCode');
        if (savedEmbedCode) {
            const videoContainer = document.getElementById('videoContainer');
            const embedCodeInput = document.getElementById('videoEmbedCode');
            
            if (videoContainer) {
                videoContainer.innerHTML = savedEmbedCode;
            }
            
            if (embedCodeInput) {
                embedCodeInput.value = savedEmbedCode;
            }
        }
    });

        // Hàm lấy icon theo danh mục
        function getCategoryIcon(category) {
            const icons = {
                'writing': 'pen',
                'programming': 'code',
                'education': 'graduation-cap',
                'business': 'briefcase',
                'design': 'paint-brush',
                'health': 'heartbeat',
                'lifestyle': 'coffee'
            };
            
            return icons[category] || 'robot';
        }
        
        // Cập nhật hàm displayAssistants để hỗ trợ xử lý lỗi hình ảnh
        function displayAssistants(assistantsList) {
            // Lấy container chứa cards
            const cardsContainer = document.getElementById('cardsContainer');
            if (!cardsContainer) {
                console.error("Không tìm thấy container chứa cards");
                return;
            }
            
            // Xóa toàn bộ nội dung hiện tại
            cardsContainer.innerHTML = '';
            
            // Lọc theo từ khóa tìm kiếm nếu có
            if (currentSearchTerm && currentSearchTerm.trim() !== '') {
                assistantsList = assistantsList.filter(assistant => {
                    const formattedString = `số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}`.toLowerCase();
                    
                    // Tìm kiếm exact format trước
                    if (formattedString.includes(currentSearchTerm)) {
                        return true;
                    }
                    
                    // Sau đó kiểm tra từng trường riêng biệt
                    return assistant.name.toLowerCase().includes(currentSearchTerm) ||
                        assistant.description.toLowerCase().includes(currentSearchTerm) ||
                        getCategoryName(assistant.category).toLowerCase().includes(currentSearchTerm) ||
                        assistant.number.toLowerCase().includes(currentSearchTerm) ||
                        assistant.code.toLowerCase().includes(currentSearchTerm);
                });
            }
            
            // Kiểm tra nếu không có trợ lý nào thỏa mãn
            if (assistantsList.length === 0) {
                const emptyMessage = document.createElement('div');
                emptyMessage.textContent = currentSearchTerm 
                    ? `Không tìm thấy trợ lý AI phù hợp với từ khóa "${currentSearchTerm}".`
                    : 'Không tìm thấy trợ lý AI phù hợp trong danh mục này.';
                emptyMessage.style.width = '100%';
                emptyMessage.style.textAlign = 'center';
                emptyMessage.style.padding = '30px';
                emptyMessage.style.color = 'rgba(255, 255, 255, 0.7)';
                cardsContainer.appendChild(emptyMessage);
                return;
            }
            
            assistantsList.forEach(assistant => {
                // Tạo stars dựa trên rating
                let starsHTML = '';
                const fullStars = Math.floor(assistant.rating);
                const halfStar = assistant.rating % 1 >= 0.5;
                
                for (let i = 0; i < 5; i++) {
                    if (i < fullStars) {
                        starsHTML += '<i class="fas fa-star star"></i>';
                    } else if (i === fullStars && halfStar) {
                        starsHTML += '<i class="fas fa-star-half-alt star"></i>';
                    } else {
                        starsHTML += '<i class="far fa-star star"></i>';
                    }
                }
                
                // Kiểm tra trạng thái mua của trợ lý
                const isLoggedIn = typeof AuthService !== 'undefined' && AuthService.isLoggedIn();
                const hasAccess = isLoggedIn && canAccessAssistant(assistant.id);
                
                // Thiết lập class cho card
                let cardClass = 'assistant-card';
                let statusBadgeHTML = '';
                
                if (isLoggedIn) {
                    if (hasAccess) {
                        cardClass += ' purchased';
                        statusBadgeHTML = '<div class="assistant-status-badge badge-purchased">Đã mua</div>';
                    } else {
                        cardClass += ' not-purchased';
                        statusBadgeHTML = '<div class="assistant-status-badge badge-not-purchased">Chưa mua</div>';
                    }
                }
                
                // Xử lý nút tương tác
                let buttonHTML = '';
                if (isLoggedIn) {
                    if (hasAccess) {
                        buttonHTML = `
                            <button class="assistant-btn purchased-btn" data-id="${assistant.id}" disabled>
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                Đã mua
                            </button>
                        `;
                    } else {
                        buttonHTML = `
                            <button class="assistant-btn purchase-btn" data-id="${assistant.id}">
                                <div class="chat-icon-wrapper">
                                    <i class="fas fa-shopping-cart"></i>
                                </div>
                                Mua ngay
                            </button>
                        `;
                    }
                } else {
                    buttonHTML = `
                        <button class="assistant-btn login-required" data-id="${assistant.id}">
                            <div class="chat-icon-wrapper">
                                <i class="fas fa-sign-in-alt"></i>
                            </div>
                            Đăng nhập
                        </button>
                    `;
                }
                
                // Đảm bảo image URL an toàn hoặc sử dụng fallback
                const safeImage = assistant.image || '';
                const fallbackHTML = `<div class="card-bg-fallback"><i class="fas fa-${getCategoryIcon(assistant.category)}"></i></div>`;
                
                // Tạo nội dung HTML cho card
                const card = document.createElement('div');
                card.className = cardClass;
                card.dataset.category = assistant.category;
                card.dataset.id = assistant.id;
                card.dataset.name = assistant.name;
                card.dataset.image = assistant.image;
                card.dataset.code = assistant.code;
                
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-bg" style="background-image: url('${safeImage}')"></div>
                        ${safeImage ? '' : fallbackHTML}
                        ${statusBadgeHTML}
                    </div>
                    <div class="card-body">
                        <span class="assistant-category">${getCategoryName(assistant.category)}</span>
                        <h3 class="assistant-name">số ${assistant.number} - trợ lý ${assistant.name} - mã ${assistant.code}</h3>
                        <p class="assistant-desc">${assistant.description.length > 80 ? assistant.description.substring(0, 80) + '...' : assistant.description}</p>
                        <div class="card-footer">
                            <div class="rating">
                                ${starsHTML}
                                <span class="rating-value">${assistant.rating}</span>
                            </div>
                            ${buttonHTML}
                        </div>
                    </div>
                `;
                
                // Thêm card vào container
                cardsContainer.appendChild(card);
                
                // Thêm xử lý lỗi cho hình ảnh không tải được
                if (safeImage) {
                    const tempImg = new Image();
                    tempImg.onerror = function() {
                        // Nếu hình ảnh không tải được, thêm fallback
                        const header = card.querySelector('.card-header');
                        if (header && !header.querySelector('.card-bg-fallback')) {
                            const fallback = document.createElement('div');
                            fallback.className = 'card-bg-fallback';
                            fallback.innerHTML = `<i class="fas fa-${getCategoryIcon(assistant.category)}"></i>`;
                            header.appendChild(fallback);
                        }
                    };
                    tempImg.src = safeImage;
                }
            });
            
            // Thiết lập sự kiện cho các nút
            setupAssistantButtons();
        }
    </script>
    
</body>
</html>
</html>
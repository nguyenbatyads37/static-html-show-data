<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Gửi Mã Đơn & Tracking</title>
</head>
<body>
  <h2>Gửi Mã Tracking</h2>

  <label for="orderId">Mã Đơn Hàng:</label><br>
  <input type="text" id="orderId"><br><br>

  <label for="tracking">Mã Tracking:</label><br>
  <input type="text" id="tracking"><br><br>

  <button onclick="sendData()">GỬI DỮ LIỆU</button>

  <p id="result"></p>

  <script>
    function sendData() {
      const orderId = document.getElementById("orderId").value.trim();
      const tracking = document.getElementById("tracking").value.trim();

      if (!orderId || !tracking) {
        document.getElementById("result").innerText = "Vui lòng nhập đầy đủ thông tin.";
        return;
      }

      const payload = {
        action: "update",
        changes: [
          {
            "Mã Đơn Hàng": orderId,
            "Mã Tracking": tracking
          }
        ]
      };

      fetch("https://script.google.com/macros/s/AKfycbwLiGLgDpumLEwrm_ex8kpVmPId6X03PPVHA5mWrUPabu1at3uPVxHCIfJWDy66xyeG/exec", {
        method: "POST",
        mode: "cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(payload)
      })
      .then(response => response.json())
      .then(data => {
        document.getElementById("result").innerText = data.message;
      })
      .catch(error => {
        document.getElementById("result").innerText = "Lỗi khi gửi dữ liệu: " + error;
      });
    }
  </script>
</body>
</html>


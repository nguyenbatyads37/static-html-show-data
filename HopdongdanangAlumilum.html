<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hợp Đồng Thi Công - Đà Nẵng Aluminium</title>
    <style>
        /* --- CSS CƠ BẢN & IN ẤN --- */
        @page {
            size: A4;
            margin: 20mm 25mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 13pt;
            line-height: 1.4;
            background: #f4f4f9;
            padding: 20px;
        }

        .container {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 20mm 25mm;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        /* --- ĐỊNH DẠNG VĂN BẢN --- */
        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 13pt;
            text-transform: uppercase;
            font-weight: bold;
        }

        .header h2 {
            font-size: 13pt;
            text-decoration: underline;
            margin-top: 5px;
            font-weight: bold;
        }

        .location-date {
            text-align: right;
            font-style: italic;
            margin-bottom: 20px;
        }

        .contract-title {
            text-align: center;
            margin-bottom: 20px;
        }

        .contract-title h1 {
            font-size: 16pt;
            font-weight: bold;
            text-transform: uppercase;
        }

        /* --- HỆ THỐNG DÒNG KẺ TỰ ĐỘNG (FIX LỖI FORMAT) --- */
        .info-row {
            display: flex;
            margin: 8px 0;
            align-items: baseline;
        }

        .info-label {
            font-weight: bold;
            white-space: nowrap;
            margin-right: 5px;
        }

        .editable {
            flex: 1;
            border-bottom: 1px dotted #000;
            min-height: 1.2em;
            outline: none;
            word-break: break-word; /* Tự động xuống dòng khi gõ dài */
            color: #d32f2f; /* Màu đỏ nổi bật khi nhập liệu */
            font-weight: bold;
        }

        .content p {
            text-align: justify;
            margin: 10px 0;
        }

        .article-title {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            margin: 25px 0 15px 0;
        }

        ul, ol {
            padding-left: 35px;
        }

        li {
            text-align: justify;
            margin: 8px 0;
        }

        /* --- CHỮ KÝ --- */
        .signature-section {
            margin-top: 50px;
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .signature {
            width: 30%;
            font-weight: bold;
        }

        .signature p {
            font-weight: normal;
            font-style: italic;
            font-size: 11pt;
            margin-top: 5px;
        }

        /* --- NÚT ĐIỀU KHIỂN --- */
        .toolbar {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

        .btn {
            padding: 12px 20px;
            background: #0d6efd;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-export { background: #198754; }

        @media print {
            .toolbar { display: none; }
            body { background: none; padding: 0; }
            .container { box-shadow: none; margin: 0; }
            .editable { color: black !important; border-bottom: 1px solid black; }
        }
    </style>
</head>

<body>

    <div class="toolbar">
        <button class="btn" onclick="window.print()">In Hợp Đồng (PDF)</button>
        <button class="btn btn-export" onclick="exportDocExact()">Tải Hợp Đồng (.doc)</button>
    </div>

    <div class="container" id="contract-content">
        <div class="header">
            <h1>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</h1>
            <h2>Độc lập - Tự do – Hạnh phúc</h2>
            <p>* * * * * * * * *</p>
        </div>

        <p class="location-date">
            Đà Nẵng, ngày <span contenteditable="true" class="editable" id="ngay_ky" style="flex:none; min-width:30px">...</span> 
            tháng <span contenteditable="true" class="editable" id="thang_ky" style="flex:none; min-width:30px">...</span> 
            năm <span contenteditable="true" class="editable" id="nam_ky" style="flex:none; min-width:50px">2025</span>
        </p>

        <div class="contract-title">
            <h1>HỢP ĐỒNG THI CÔNG</h1>
            <p>Số: HĐTC <span contenteditable="true" class="editable" id="so_hd" style="flex:none">02/2025</span>/danangaluminium</p>
        </div>

        <div class="content">
            <p>- Căn cứ Luật Thương Mại của Quốc Hội Nước Cộng Hòa Xã Hội Chủ Nghĩa Việt Nam số 36/2005/QH 11 ngày 14/06/2006.</p>
            <p>- Căn cứ vào khả năng và nhu cầu của hai bên, dựa trên tinh thần trung thực và thiện chí hợp tác.</p>
            
            <p>Hôm nay, ngày <span id="ngay_ht">...</span> tháng <span id="thang_ht">...</span> năm <span id="nam_ht">...</span> tại văn phòng Công Ty Cổ Phần nội thất nhôm kính Đà Nẵng Aluminium.</p>

            <!-- BÊN A -->
            <p style="margin-top: 15px;"><strong>Bên A: (Ông/Bà):</strong></p>
            <div class="info-row">
                <span class="info-label">Họ tên:</span>
                <span contenteditable="true" class="editable" id="ten_kh"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Địa chỉ:</span>
                <span contenteditable="true" class="editable" id="dia_chi_kh"></span>
            </div>
            <div class="info-row">
                <span class="info-label">Điện thoại:</span>
                <span contenteditable="true" class="editable" id="sdt_kh"></span>
            </div>
            <div class="info-row">
                <span class="info-label">CMND/CCCD:</span>
                <span contenteditable="true" class="editable" id="cccd_kh"></span>
            </div>

            <!-- BÊN B -->
            <p style="margin-top: 15px;"><strong>Bên B: CÔNG TY CỔ PHẦN NỘI THẤT NHÔM KÍNH ĐÀ NẴNG ALUMINIUM</strong></p>
            <div class="info-row">
                <span class="info-label">Đại diện:</span>
                <span>(Ông) PHẠM NGUYỄN HOÀNG ANH - Chức vụ: Giám đốc</span>
            </div>
            <div class="info-row">
                <span class="info-label">Thực hiện:</span>
                <span contenteditable="true" class="editable">VÕ VĂN TRỌNG - Chức vụ: Phó giám đốc</span>
            </div>
            <div class="info-row">
                <span class="info-label">Địa chỉ:</span>
                <span>64 Đặng Văn Ngữ, Phường Khuê Trung, Quận Cẩm Lệ, TP Đà Nẵng.</span>
            </div>
            <div class="info-row">
                <span class="info-label">Mã số thuế:</span>
                <span>0402 190 590</span>
            </div>

            <p style="margin-top: 15px;">Sau khi thỏa thuận, hai bên thống nhất ký kết hợp đồng với các điều khoản sau:</p>

            <div class="article-title">Điều 1: NỘI DUNG CÔNG VIỆC VÀ THỜI GIAN THỰC HIỆN</div>
            <ul>
                <li>Bên A đồng ‎‎ý cho bên B thi công hạng mục: <span contenteditable="true" class="editable">Thi công lắp dựng cửa nhôm kính nội thất</span>.</li>
                <li>Bên B thi công theo kích thước thực tế. Sau khi xong hai bên sẽ kiểm tra số lượng để thanh lý.</li>
                <li>Địa điểm lắp dựng: <span contenteditable="true" class="editable" id="dia_diem"></span></li>
                <li>Thời gian hoàn thành: <span contenteditable="true" class="editable" style="flex:none; min-width:30px">20</span> ngày kể từ ngày bàn giao mặt bằng.</li>
            </ul>

            <div class="article-title">Điều 2: GIÁ TRỊ HỢP ĐỒNG VÀ PHƯƠNG THỨC THANH TOÁN</div>
            <ol>
                <li><strong>Giá trị hợp đồng tạm tính:</strong> <span contenteditable="true" class="editable" id="tong_tien" style="flex:none">0</span> VNĐ.
                    <p id="tong_tien_chu" style="font-style: italic; margin-left: 20px;">(Bằng chữ: Không đồng./.)</p>
                </li>
                <li><strong>Phương thức thanh toán:</strong>
                    <ul>
                        <li>Thanh toán chuyển khoản qua STK: 33556688 - Phạm Nguyễn Hoàng Anh - Sacombank.</li>
                        <li>Đợt 1: Tạm ứng <span contenteditable="true" class="editable" id="coc_tien" style="flex:none">0</span> VNĐ (Bằng chữ: <span id="coc_chu">...</span>).</li>
                        <li>Đợt 2: Thanh toán <span contenteditable="true" class="editable" id="dot2_tien" style="flex:none">0</span> VNĐ khi vật tư đến công trình.</li>
                        <li>Đợt 3: Thanh toán phần còn lại sau khi lắp đặt hoàn thiện.</li>
                    </ul>
                </li>
            </ol>

            <div class="article-title">Điều 3: TRÁCH NHIỆM CÁC BÊN</div>
            <p><strong>3.1. Trách nhiệm bên A:</strong> Bàn giao mặt bằng, hỗ trợ điện nước thi công và thanh toán đúng hạn.</p>
            <p><strong>3.2. Trách nhiệm bên B:</strong> Đảm bảo chất lượng vật tư đúng chủng loại, an toàn lao động và đúng tiến độ. Bảo hành hệ cửa 15 năm, phụ kiện 05 năm.</p>

            <div class="article-title">Điều 4: NGHIỆM THU VÀ BÀN GIAO</div>
            <p>Bên A có trách nhiệm nghiệm thu công trình sau khi nhận thông báo từ bên B. Nếu bên B vi phạm chủng loại vật tư, bên A có quyền hủy hợp đồng và yêu cầu bồi thường.</p>

            <div class="article-title">Điều 5: CAM KẾT CHUNG</div>
            <p>Hai bên cam kết thực hiện đúng các điều khoản. Mọi tranh chấp nếu không giải quyết được bằng thương lượng sẽ đưa ra Tòa án kinh tế TP Đà Nẵng giải quyết.</p>

            <p style="margin-top: 30px; font-weight: bold;">HOTLINE BẢO HÀNH: 0968.414.260 MR. TRỌNG</p>

            <div class="signature-section">
                <div class="signature"><span>ĐẠI DIỆN BÊN A</span><p>(Ký và ghi rõ họ tên)</p></div>
                <div class="signature"><span>QUẢN LÝ THI CÔNG</span><p>(Ký và ghi rõ họ tên)</p></div>
                <div class="signature"><span>ĐẠI DIỆN BÊN B</span><p>(Ký và ghi rõ họ tên)</p></div>
            </div>
        </div>
    </div>

    <script>
        // --- HÀM ĐỌC SỐ TIỀN ---
        function docSoTiengViet(so) {
            if (!so || so == 0) return "Không đồng";
            const ChuSo = ["không", "một", "hai", "ba", "bốn", "năm", "sáu", "bảy", "tám", "chín"];
            const Tien = ["", "nghìn", "triệu", "tỷ", "nghìn tỷ", "triệu tỷ"];
            function docBlock(n, m) {
                let tr = Math.floor(n / 100), c = Math.floor((n % 100) / 10), d = n % 10, r = "";
                if (m || tr > 0) r += ChuSo[tr] + " trăm "; else if (c > 0 || d > 0) r += "không trăm ";
                if (c > 1) { r += ChuSo[c] + " mươi "; if (d == 1) r += "mốt "; else if (d == 5) r += "lăm "; else if (d > 0) r += ChuSo[d] + " "; }
                else if (c == 1) { r += "mười "; if (d == 5) r += "lăm "; else if (d > 0) r += ChuSo[d] + " "; }
                else if (d > 0) r += (r ? "linh " : "") + ChuSo[d] + " ";
                return r;
            }
            let s = so.toString(), b = [];
            while (s.length > 0) { b.push(parseInt(s.slice(-3))); s = s.slice(0, -3); }
            let r = "";
            for (let i = b.length - 1; i >= 0; i--) {
                let bl = docBlock(b[i], i === b.length - 1);
                if (bl) r += bl + Tien[i] + " ";
            }
            return r.trim().charAt(0).toUpperCase() + r.trim().slice(1) + " đồng./.";
        }

        // --- SỰ KIỆN NHẬP LIỆU ---
        document.addEventListener('input', function (e) {
            if (['tong_tien', 'coc_tien', 'dot2_tien'].includes(e.target.id)) {
                let raw = e.target.innerText.replace(/\D/g, '');
                if (raw) {
                    e.target.innerText = parseInt(raw).toLocaleString('vi-VN');
                    // Đưa con trỏ về cuối
                    let selection = window.getSelection();
                    let range = document.createRange();
                    range.selectNodeContents(e.target);
                    range.collapse(false);
                    selection.removeAllRanges();
                    selection.addRange(range);
                }
                // Cập nhật chữ
                if (e.target.id === 'tong_tien') document.getElementById('tong_tien_chu').innerText = "(Bằng chữ: " + docSoTiengViet(raw) + ")";
                if (e.target.id === 'coc_tien') document.getElementById('coc_chu').innerText = docSoTiengViet(raw);
            }
            // Đồng bộ ngày
            if (['ngay_ky', 'thang_ky', 'nam_ky'].includes(e.target.id)) {
                document.getElementById('ngay_ht').innerText = document.getElementById('ngay_ky').innerText;
                document.getElementById('thang_ht').innerText = document.getElementById('thang_ky').innerText;
                document.getElementById('nam_ht').innerText = document.getElementById('nam_ky').innerText;
            }
        });

        // --- XUẤT WORD CHUẨN ---
        function exportDocExact() {
            let clone = document.getElementById('contract-content').cloneNode(true);
            
            // 1. Chuyển Info-row sang Table (Để Word không bị lệch)
            clone.querySelectorAll('.info-row').forEach(row => {
                let label = row.querySelector('.info-label')?.innerText || "";
                let val = row.querySelector('.editable')?.innerText || "";
                row.outerHTML = `<table width="100%" style="margin:2pt 0;"><tr>
                    <td width="100pt" style="font-family:'Times New Roman'; font-size:13pt;"><b>${label}</b></td>
                    <td style="font-family:'Times New Roman'; font-size:13pt; border-bottom:1px solid black;">${val}</td>
                </tr></table>`;
            });

            // 2. Chuyển Chữ ký sang Table
            let sigSection = clone.querySelector('.signature-section');
            let sigs = sigSection.querySelectorAll('.signature');
            sigSection.outerHTML = `<table width="100%" style="margin-top:30pt;"><tr>
                <td align="center" style="font-family:'Times New Roman'; font-size:13pt;"><b>${sigs[0].childNodes[0].innerText}</b><br><i>(Ký, rõ họ tên)</i></td>
                <td align="center" style="font-family:'Times New Roman'; font-size:13pt;"><b>${sigs[1].childNodes[0].innerText}</b><br><i>(Ký, rõ họ tên)</i></td>
                <td align="center" style="font-family:'Times New Roman'; font-size:13pt;"><b>${sigs[2].childNodes[0].innerText}</b><br><i>(Ký, rõ họ tên)</i></td>
            </tr></table>`;

            // Làm sạch
            clone.querySelectorAll('.editable').forEach(el => { el.style.color = "black"; el.style.borderBottom = "none"; });

            let header = `<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
            <head><meta charset='utf-8'><style>
                body { font-family: 'Times New Roman'; font-size: 13pt; }
                p { margin: 0; padding: 2pt 0; text-align: justify; line-height: 1.3; }
            </style></head><body>`;
            
            let blob = new Blob(['\ufeff', header + clone.innerHTML + "</body></html>"], { type: 'application/msword' });
            let link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = "Hop_Dong_Thi_Cong_" + (document.getElementById('ten_kh').innerText || "Khach_Hang") + ".doc";
            link.click();
        }

        // Khởi tạo ngày mặc định
        const now = new Date();
        document.getElementById('ngay_ky').innerText = now.getDate();
        document.getElementById('thang_ky').innerText = now.getMonth() + 1;
        document.getElementById('ngay_ht').innerText = now.getDate();
        document.getElementById('thang_ht').innerText = now.getMonth() + 1;
        document.getElementById('nam_ht').innerText = now.getFullYear();
    </script>
</body>
</html>




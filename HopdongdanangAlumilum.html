<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hợp Đồng Thi Công - Đà Nẵng Aluminium</title>
    <style>
        /* --- THIẾT LẬP KHỔ GIẤY A4 --- */
        @page { size: A4; margin: 15mm 20mm; }
        * { box-sizing: border-box; }
        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 13pt;
            line-height: 1.5;
            background: #f0f0f0;
            margin: 0; padding: 0;
        }
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm 25mm;
            margin: 10px auto;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
        }
        .header { text-align: center; text-transform: uppercase; margin-bottom: 5px; }
        .header h1 { font-size: 13pt; margin: 0; font-weight: bold; }
        .header h2 { font-size: 13pt; margin: 5px 0; font-weight: bold; text-decoration: underline; }
        
        .location-date { text-align: right; font-style: italic; margin-bottom: 20px; }
        .contract-title { text-align: center; margin-bottom: 20px; }
        .contract-title h1 { font-size: 16pt; text-transform: uppercase; margin: 0; font-weight: bold; }

        /* Vùng chỉnh sửa màu đỏ */
        .editable-red {
            color: #d32f2f;
            font-weight: bold;
            border-bottom: 1px dashed #d32f2f;
            outline: none;
            display: inline-block;
            min-width: 20px;
        }

        /* Hệ thống dòng kẻ thông tin */
        .info-row { display: flex; margin: 6px 0; align-items: baseline; }
        .info-label { font-weight: bold; white-space: nowrap; margin-right: 5px; }
        .editable-line {
            flex: 1; border-bottom: 1px dotted #000;
            min-height: 1.2em; outline: none; word-break: break-word;
            padding: 0 5px; color: #1565c0; font-weight: bold;
        }

        .content p { text-align: justify; margin: 10px 0; }
        .article-title { font-weight: bold; text-align: center; margin: 25px 0 15px 0; text-transform: uppercase; line-height: 1.2; }
        
        ul, ol { padding-left: 30px; }
        li { text-align: justify; margin-bottom: 8px; }

        .signature-section {
            margin-top: 50px; display: flex; justify-content: space-between; text-align: center;
        }
        .sig-box { width: 32%; font-weight: bold; }
        .sig-box p { font-style: italic; font-weight: normal; font-size: 11pt; margin-top: 5px; }

        .toolbar { position: fixed; top: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; z-index: 1000; }
        .btn { padding: 12px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }

        @media print {
            .toolbar { display: none; }
            body { background: none; }
            .page { margin: 0; box-shadow: none; width: 100%; }
            .editable-red, .editable-line { color: black !important; border-bottom: 1px solid black !important; }
        }
    </style>
</head>
<body>

<div class="toolbar">
    <button class="btn" onclick="window.print()">In Hợp Đồng (PDF)</button>
    <button class="btn" style="background:#28a745" onclick="exportDoc()">Tải File Word (.doc)</button>
</div>

<div class="page" id="contract-content">
    <div class="header">
        <h1>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</h1>
        <h2>Độc lập  - Tự do – Hạnh phúc</h2>
        <p>* * * * * * * * *</p>
    </div>

    <!-- Vị trí đỏ (1) -->
    <div class="location-date">
        Đà Nẵng, ngày <span contenteditable="true" class="editable-red" id="ngay_ky">02</span> tháng <span contenteditable="true" class="editable-red" id="thang_ky">02</span> năm <span contenteditable="true" class="editable-red" id="nam_ky">2025</span>
    </div>

    <div class="contract-title">
        <h1>HỢP ĐỒNG THI CÔNG</h1>
        <!-- Vị trí đỏ (2) -->
        <p>Số: HĐTC <span contenteditable="true" class="editable-red">01/2025</span>/danangaluminium</p>
    </div>

    <div class="content">
        <p>- Căn cứ Luật Thương Mại của Quốc Hội Nước Cộng Hòa Xã Hội Chủ Nghĩa Việt Nam số 36/2005/QH 11 ngày 14/06/2006</p>
        <p>- Căn cứ và khả năng và nhu cầu của hai bên, dựa trên tinh thần trung thực và thiện chí hợp tác của hai bên.</p>
        
        <p>Hôm nay, ngày <span id="ngay_ht" class="editable-red">02</span> tháng <span id="thang_ht" class="editable-red">02</span> năm <span id="nam_ht" class="editable-red">2025</span> tại văn phòng Công Ty Cổ Phần nội thất nhôm kính Đà Nẵng Aluminium </p>

        <div class="info-row">
            <span class="info-label">Bên A: (Ông/Bà)</span>
            <span contenteditable="true" class="editable-line" id="ten_kh"></span>
        </div>
        <div class="info-row">
            <span class="info-label">Địa chỉ:</span>
            <span contenteditable="true" class="editable-line"></span>
        </div>
        <div class="info-row">
            <span class="info-label">Điện thoại:</span>
            <span contenteditable="true" class="editable-line"></span>
        </div>
        <div class="info-row">
            <span class="info-label">CCCD:</span>
            <span contenteditable="true" class="editable-line"></span>
        </div>

        <p style="margin-top: 15px;"><strong>Bên B: CÔNG TY CỔ PHẦN NỘI THẤT NHÔM KÍNH ĐÀ NẴNG ALUMINIUM</strong></p>
        <div class="info-row">
            <span class="info-label">Đại diện:</span>
            <span>(Ông) <b>PHẠM NGUYỄN HOÀNG ANH</b></span>
            <span class="info-label" style="margin-left:auto">Chức vụ: Giám đốc</span>
        </div>
        <div class="info-row">
            <!-- Vị trí đỏ (3) -->
            <span class="info-label">Thực hiện hợp đồng:</span>
            <span>(Ông) <span contenteditable="true" class="editable-red">VÕ VĂN TRỌNG</span></span>
            <span class="info-label" style="margin-left:auto">Chức vụ: Phó giám đốc</span>
        </div>
        <p>Địa chỉ: 64 Đặng Văn Ngữ, Phường Khuê Trung, Quận Cẩm Lệ, TP Đà Nẵng.</p>
        <p>Điện thoại: 0775 988 928 – 0935 683 508 – 0926 033 777</p>
        <p>Mã số thuế: 0402 190 590</p>
        <p>Sau khi thỏa thuận, hai bên thống nhất ký kết hợp đồng với các điều khoản sau:</p>

        <div class="article-title">Điều 1: NỘI DUNG CÔNG VIỆC VÀ THỜI GIAN THỰC HIỆN</div>
        <ul>
            <li>Bên A đồng ‎‎ý cho bên B thi công hạng mục công trình: Thi công lắp dựng các hạng mục căn cứ theo Phụ lục hợp đồng số: <span contenteditable="true" class="editable-red">PLHĐTC 01/2025/danangaluminium</span>, đính kèm bản vẽ.</li>
            <li>Bên B thi công theo kích thước thực tế tại công trình, sau khi thi công xong 2 bên sẽ kiểm tra kích thước và số lượng thực tế để thanh lý hợp đồng.</li>
            <!-- Vị trí đỏ (4) -->
            <li class="info-row" style="margin-left:0; padding-left:0">
                <span style="margin-right:5px">Địa điểm lắp dựng:</span>
                <span contenteditable="true" class="editable-red" style="flex:1">108 NGUYỄN QUANG LÂM</span> 
                <span style="font-weight:bold; margin-left:5px">- ĐÀ NẴNG</span>
            </li>
            <!-- Vị trí đỏ (5) -->
            <li>Thời gian hoàn thành: <span contenteditable="true" class="editable-red">20</span> ngày kể từ ngày bàn giao mặt bằng.</li>
        </ul>

        <div class="article-title">Điều 2: GIÁ TRỊ HỢP ĐỒNG VÀ PHƯƠNG THỨC THANH TOÁN</div>
        <div class="info-row">
            <!-- Vị trí đỏ (6) -->
            <span class="info-label">1. Giá trị hợp đồng tạm tính:</span>
            <span contenteditable="true" class="editable-red" id="tong_tien">0</span> <span>VNĐ</span>
        </div>
        <p id="tong_tien_chu" style="font-style: italic;">(Bằng chữ: Không đồng./.)</p>

        <p><strong>2. Phương thức thanh toán:</strong></p>
        <!-- Vị trí đỏ (7) -->
        <p>a/ Hình thức thanh toán: Thanh toán bằng <span contenteditable="true" class="editable-red">chuyển khoản</span></p>
        <p style="padding-left: 20px;">
            - Chủ tài khoản: <b>Công ty CP nội thất nhôm kính Đà Nẵng Aluminium</b><br>
            - Số tài khoản: <b>190590</b> tại ngân hàng <b>Techcombank</b> chi nhánh Cẩm Lệ, TP Đà Nẵng.
        </p>
        <p>b/ Thời hạn thanh toán: Chia làm 3 đợt</p>
        <ul>
            <!-- Vị trí đỏ (8) -->
            <li><b>Đợt 1:</b> Bên A đặt cọc cho bên B trước <span contenteditable="true" class="editable-red" id="coc_tien">0</span> vnđ (Bằng chữ: <span id="coc_chu">...</span>) sau khi ký kết hợp đồng để giữ giá và lên kết hoạch triển khai. Sau khi kỹ thuật đo đạc thực tế xong để tiến hành sản xuất, Bên A tạm ứng thêm cho bên B đủ 30% giá trị hợp đồng để tiến hành sản xuất tại xưởng.</li>
            <!-- Vị trí đỏ (9) -->
            <li><b>Đợt 2:</b> Sau khi sản xuất cửa nhôm kính hoàn thiện và đưa đến chân công trình thì bên A tạm ứng cho bên B đủ số tiền <span contenteditable="true" class="editable-red">50%</span> giá trị hợp đồng, tương ứng với số tiền là: <span contenteditable="true" class="editable-red" id="dot2_tien">0</span> vnđ (Bằng chữ: <span id="dot2_chu">...</span>)</li>
            <li><b>Đợt 3:</b> Bên A Thanh toán tất cả số tiền còn lại sau khi lắp đặt hoàn thiện công trình theo thực tế.</li>
        </ul>

        <div class="article-title">Điều 3: TRÁCH NHIỆM CÁC BÊN</div>
        <p><strong>1. Trách nhiệm bên A:</strong></p>
        <ul>
            <li>Bàn giao mặt bằng, giám sát, kiểm tra chất lượng, chủng loại hàng hóa và công tác lắp đặt.</li>
            <li>Cử cán bộ giám sát nghiệm thu thực tế tại công trình.</li>
            <li>Nghiệm thu tại công trình sau khi bên B thông báo đã lắp đặt hoàn thiện xong. Trong vòng 3 ngày nếu bên A không sắp xếp được để nghiệm thu thì công trình được tính là đã được nghiệm thu xong.</li>
            <li>Hỗ trợ điện cho bên B thi công lắp ráp tại hiện trường.</li>
            <li>Thanh toán theo đúng thỏa thuận hợp đồng.</li>
        </ul>
        <p><strong>2. Trách nhiệm bên B:</strong></p>
        <ul>
            <li>Chịu trách nhiệm về toàn bộ chất lượng kỹ thuật, mỹ thuật của công trình phù hợp với thiết kế và dự toán được duyệt.</li>
            <li>Những vật tư dùng cho công trình phải đúng chủng loại theo thiết kế và dự toán trước khi đưa vào công trình.</li>
            <li>Chịu trách nhiệm hoàn toàn về an toàn lao động, PCCC và vệ sinh môi trường do bên B thi công trong suốt quá trình thi công công trình.</li>
            <li>Quản lý tốt các hồ sơ, mặt bằng, thiết bị được bên A bàn giao.</li>
            <li>Đảm bảo đúng tiến độ theo thỏa thuận.</li>
            <li>Tiến hành thu hồi sản phẩm đã lắp đặt nếu như bên A không thực hiện thanh toán đầy đủ giá trị hợp đồng, trong vòng 30 ngày kể từ ngày bàn giao.</li>
        </ul>

        <p><strong>- Phạm vi bảo hành sản phẩm:</strong></p>
        <ul>
            <!-- [ĐÃ SỬA] Đổi 24 năm thành 2 năm -->
            <li>Bên B có trách nhiệm bảo hành sản phẩm trong thời gian <b>2 năm</b> kể từ ngày nghiệm thu.</li>
            <li>Trong thời gian bảo hành, bên B sửa chữa hoặc thay thế kịp thời các lỗi do nhà sản xuất.</li>
            <li>Tất cả lỗi trên được thay mới mà khách hàng không phải chịu thêm bất kỳ chi phí nào.</li>
        </ul>

        <p><strong>- Phạm vi không bảo hành sản phẩm:</strong></p>
        <ul>
            <li>Sản phẩm bị biến dạng do nguồn nhiệt > 600 độ C hoặc tiếp xúc hóa chất đặc biệt.</li>
            <li>Lỗi do người sử dụng cố ý gây hỏng, sử dụng sai nguyên tắc hoặc tự ý sửa chữa.</li>
            <li>Các trường hợp bất khả kháng: Thiên tai, hỏa hoạn...</li>
        </ul>

        <div class="article-title">Điều 4: NGHIỆM THU, BÀN GIAO CÔNG TRÌNH</div>
        <p>- <b>Nghiệm thu vật liệu đầu vào:</b> Khi vận chuyển vật tư đến công trình phải báo Bên A nghiệm thu. Vật tư phải đúng chủng loại mẫu đã trình duyệt.</p>
        <p>- Bên A được quyền hủy hợp đồng và bồi thường 100% nếu Bên B vi phạm chủng loại vật tư.</p>

        <div class="article-title">Điều 5: CAM KẾT CHUNG</div>
        <p>- Hai bên cam kết thực hiện đầy đủ điều khoản. Tranh chấp nếu không thương lượng được sẽ đưa ra Tòa án kinh tế TP Đà Nẵng giải quyết. Hợp đồng lập thành 02 bản có giá trị như nhau.</p>

        <div class="signature-section">
            <div class="sig-box">ĐẠI DIỆN BÊN A<p>(Ký và ghi rõ họ tên)</p></div>
            <div class="sig-box">QUẢN LÝ THI CÔNG<p>(Ký và ghi rõ họ tên)</p></div>
            <div class="sig-box">ĐẠI DIỆN BÊN B<p>(Ký và ghi rõ họ tên)</p></div>
        </div>
    </div>
</div>

<script>
    // Hàm đọc số tiền chuẩn
    function docSo(so) {
        if (!so || so == 0) return "Không đồng";
        const ChuSo = ["không", "một", "hai", "ba", "bốn", "năm", "sáu", "bảy", "tám", "chín"];
        const Tien = ["", "nghìn", "triệu", "tỷ", "nghìn tỷ"];
        function docBlock(n, m) {
            let tr = Math.floor(n/100), c = Math.floor((n%100)/10), d = n%10, r = "";
            if (m || tr > 0) r += ChuSo[tr] + " trăm "; else if (c > 0 || d > 0) r += "không trăm ";
            if (c > 1) { r += ChuSo[c] + " mươi "; if (d == 1) r += "mốt "; else if (d == 5) r += "lăm "; else if (d > 0) r += ChuSo[d] + " "; }
            else if (c == 1) { r += "mười "; if (d == 5) r += "lăm "; else if (d > 0) r += ChuSo[d] + " "; }
            else if (d > 0) r += (r ? "linh " : "") + ChuSo[d] + " ";
            return r;
        }
        let s = so.toString(), b = [];
        while (s.length > 0) { b.push(parseInt(s.slice(-3))); s = s.slice(0, -3); }
        let r = "";
        for (let i = b.length - 1; i >= 0; i--) {
            let bl = docBlock(b[i], i === b.length - 1);
            if (bl) r += bl + Tien[i] + " ";
        }
        return r.trim().charAt(0).toUpperCase() + r.trim().slice(1) + " đồng";
    }

    // Xử lý nhập liệu tự động
    document.addEventListener('input', function(e) {
        // Đồng bộ ngày tháng
        if(['ngay_ky', 'thang_ky', 'nam_ky'].includes(e.target.id)) {
            document.getElementById('ngay_ht').innerText = document.getElementById('ngay_ky').innerText;
            document.getElementById('thang_ht').innerText = document.getElementById('thang_ky').innerText;
            document.getElementById('nam_ht').innerText = document.getElementById('nam_ky').innerText;
        }

        // Định dạng số tiền
        if(['tong_tien', 'coc_tien', 'dot2_tien'].includes(e.target.id)) {
            let raw = e.target.innerText.replace(/\D/g, '');
            if(raw) {
                e.target.innerText = parseInt(raw).toLocaleString('vi-VN');
                // Giữ con trỏ ở cuối
                let sel = window.getSelection(); let range = document.createRange();
                range.selectNodeContents(e.target); range.collapse(false);
                sel.removeAllRanges(); sel.addRange(range);
            }
            // Viết chữ
            if(e.target.id === 'tong_tien') document.getElementById('tong_tien_chu').innerText = "(Bằng chữ: " + docSo(raw) + "./.)";
            if(e.target.id === 'coc_tien') document.getElementById('coc_chu').innerText = docSo(raw);
            if(e.target.id === 'dot2_tien') document.getElementById('dot2_chu').innerText = docSo(raw);
        }
    });

    // Xuất Word
    function exportDoc() {
        let clone = document.getElementById('contract-content').cloneNode(true);
        // Chuyển info-row sang table để Word nhận diện đúng
        clone.querySelectorAll('.info-row').forEach(row => {
            let label = row.querySelector('.info-label')?.innerText || "";
            let val = row.querySelector('.editable-line')?.innerText || row.querySelector('.editable-red')?.innerText || "";
            row.outerHTML = `<table width="100%" style="margin:2pt 0;"><tr>
                <td width="120pt" style="font-family:'Times New Roman'; font-size:13pt;"><b>${label}</b></td>
                <td style="font-family:'Times New Roman'; font-size:13pt; border-bottom:1px solid black;">${val}</td>
            </tr></table>`;
        });
        
        let header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'><style>body{font-family:'Times New Roman'; font-size:13pt; line-height:1.5;}</style></head><body>";
        let blob = new Blob(['\ufeff', header + clone.innerHTML + "</body></html>"], { type: 'application/msword' });
        let link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = "Hop_Dong_Thi_Cong_Full.doc";
        link.click();
    }
</script>

</body>
</html>




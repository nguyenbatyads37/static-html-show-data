<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Hợp đồng thi công - Đã sửa format</title>
    <style>
        /* --- GIỮ NGUYÊN CÁC CSS CŨ VÀ THÊM/SỬA CÁC DÒNG SAU --- */
        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 13pt;
            line-height: 1.5;
            padding: 20mm 25mm;
        }

        .info-row {
            display: flex;
            margin: 8px 0;
            align-items: flex-end; /* Để văn bản nằm trên dòng kẻ */
        }

        .info-label {
            font-weight: bold;
            white-space: nowrap; /* Không cho nhãn (Địa chỉ, SĐT) bị nhảy dòng */
            margin-right: 5px;
        }

        /* Lớp mới cho vùng nhập liệu chuyên nghiệp */
        .editable-field {
            flex: 1;
            border-bottom: 1px dotted #444; /* Tạo dòng kẻ chấm thay vì gõ dấu chấm */
            color: #dc3545; /* Chữ đỏ khi nhập */
            font-weight: bold;
            min-height: 1.2em;
            padding: 0 5px;
            outline: none;
            word-break: break-word; /* Tự động xuống dòng khi gõ dài */
        }

        /* Khi in ra sẽ mất màu đỏ và giữ dòng kẻ nếu muốn, hoặc ẩn dòng kẻ */
        @media print {
            .editable-field {
                color: black !important;
                border-bottom: 1px solid #000;
            }
            .btn-export { display: none; }
        }

        /* Nút xuất file */
        .btn-export {
            position: fixed; top: 10px; right: 10px; padding: 10px;
            background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;
        }
    </style>
</head>
<body>

<button onclick="exportDocExact()" class="btn-export">Tải Hợp Đồng (.doc)</button>

<div id="contract-content">
    <!-- Phần tiêu đề giữ nguyên... -->
    <div style="text-align: center; text-transform: uppercase;">
        <h1 style="font-size: 13pt; margin: 0;">CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</h1>
        <h2 style="font-size: 13pt; margin: 5px 0;">Độc lập - Tự do – Hạnh phúc</h2>
        <p>***</p>
    </div>

    <div style="text-align: right; font-style: italic; margin: 20px 0;">
        Đà Nẵng, ngày <span contenteditable="true" style="color:red">...</span> tháng <span contenteditable="true" style="color:red">...</span> năm 2025
    </div>

    <div style="text-align: center; font-weight: bold; margin-bottom: 20px;">
        <h1 style="font-size: 16pt; margin: 0;">HỢP ĐỒNG THI CÔNG</h1>
        <p>Số: HĐTC <span contenteditable="true" style="color:red">02/2025</span>/danangaluminium</p>
    </div>

    <div class="content">
        <p><strong>Bên A: (Ông/Bà):</strong> <span contenteditable="true" class="editable-field" id="ten_kh"></span></p>
        
        <!-- SỬA LỖI FORMAT Ở ĐÂY -->
        <div class="info-row">
            <span class="info-label">Địa chỉ:</span>
            <span contenteditable="true" class="editable-field" id="dia_chi_kh"></span>
        </div>

        <div class="info-row">
            <span class="info-label">Điện thoại:</span>
            <span contenteditable="true" class="editable-field" id="sdt_kh"></span>
        </div>

        <div class="info-row">
            <span class="info-label">CMND/CCCD:</span>
            <span contenteditable="true" class="editable-field" id="cccd_kh"></span>
        </div>
        <!-- KẾT THÚC PHẦN SỬA LỖI -->

        <p style="margin-top: 15px;"><strong>Bên B: CÔNG TY CỔ PHẦN NỘI THẤT NHÔM KÍNH ĐÀ NẴNG ALUMINIUM</strong></p>
        <p>Đại diện: (Ông) PHẠM NGUYỄN HOÀNG ANH - Chức vụ: Giám đốc</p>
        <p>Địa chỉ: 64 Đặng Văn Ngữ, Cẩm Lệ, Đà Nẵng.</p>
        
        <!-- Các điều khoản khác giữ nguyên... -->
        <div style="margin-top: 20px; font-weight: bold; text-align: center;">
            [CÁC ĐIỀU KHOẢN HỢP ĐỒNG TƯƠNG TỰ NHƯ MẪU TRƯỚC]
        </div>
    </div>
</div>

<script>
    // Hàm xuất Word cải tiến để nhận diện dòng kẻ
    function exportDocExact() {
        var content = document.getElementById('contract-content').cloneNode(true);
        
        // Chuyển đổi các div info-row sang table để Word giữ được định dạng ngang
        content.querySelectorAll('.info-row').forEach(row => {
            var label = row.querySelector('.info-label').innerText;
            var val = row.querySelector('.editable-field').innerText;
            var table = `<table width="100%" style="margin-bottom: 5pt;">
                <tr>
                    <td width="15%" style="font-family:'Times New Roman'; font-size:13pt;"><b>${label}</b></td>
                    <td width="85%" style="font-family:'Times New Roman'; font-size:13pt; border-bottom: 1px solid #000;">${val}</td>
                </tr>
            </table>`;
            row.outerHTML = table;
        });

        // Xử lý các thẻ p có span editable còn lại
        content.querySelectorAll('.editable-field').forEach(el => {
            el.style.color = "black";
            el.style.borderBottom = "1px solid black";
        });

        var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'><head><meta charset='utf-8'></head><body>";
        var footer = "</body></html>";
        var source = header + content.innerHTML + footer;

        var blob = new Blob(['\ufeff', source], { type: 'application/msword' });
        var url = URL.createObjectURL(blob);
        var link = document.createElement('a');
        link.href = url;
        link.download = "Hop_Dong_Thi_Cong.doc";
        link.click();
    }
</script>

</body>
</html>




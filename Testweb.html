<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Form G·ª≠i D·ªØ Li·ªáu</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1200px; margin: 30px auto; }
    table { width: 100%; border-collapse: collapse; margin-top: 12px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; font-size: 14px; }
    input, textarea { width: 100%; box-sizing: border-box; font-size: 14px; }
    button { padding: 6px 12px; font-size: 14px; }
    .idcol { display: none; }
  </style>
</head>
<body>
  <h2>G·ª≠i Nhi·ªÅu D√≤ng D·ªØ Li·ªáu</h2>
  <button id="addRow" type="button">‚ûï Th√™m d√≤ng</button>
  <form id="dataForm">
    <table id="dataTable">
      <thead>
        <tr>
          <th>H√†nh ƒë·ªông</th>
          <th class="idcol">ID</th>
          <th>T√™n</th>
          <th>Ng√†y</th>
          <th>Ca</th>
          <th>S·∫£n ph·∫©m</th>
          <th>Th·ªã tr∆∞·ªùng</th>
          <th>Page</th>
          <th>TKQC</th>
          <th>CPQC</th>
          <th>Via log</th>
          <th>S·ªë Mess+Cmt</th>
          <th>S·ªë ƒë∆°n</th>
          <th>DS Ch·ªët</th>
          <th>S·ªë ƒë∆°n Ho√†n/H·ªßy</th>
          <th>DS sau Ho√†n/H·ªßy</th>
          <th>S·ªë ƒë∆°n sau ho√†n hu·ª∑</th>
          <th>Team</th>
          <th>id NS</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button type="submit" id="submitBtn">üöÄ G·ª≠i t·∫•t c·∫£</button>
  </form>
  <p id="responseMessage"></p>

  <datalist id="nameList">
    <option value="Tr·∫ßn Qu·ªëc Kh·∫£i">
    <option value="M·∫°nh C∆∞·ªùng">
    <option value="Ph·∫°m Ti·∫øn Th√†nh">
    <option value="L·ª•c Tr·∫ßn Minh Tr√≠">
    <option value="Nguy·ªÖn Hi·ªÅn L∆∞∆°ng">
    <option value="Nguy·ªÖn Th·ªã Hi·∫øu">
    <option value="L√™ ƒê√¨nh To·∫£n">
    <option value="Nguy·ªÖn Anh Tu·∫•n">
    <option value="Tr·∫ßn Ti·∫øn">
    <option value="Nguy·ªÖn Th·ªã Nh∆∞ Qu·ª≥nh">
    <option value="ƒêo√†n Ng·ªçc Hu√¢n">
    <option value="Tr·∫ßn Huy H√πng">
    <option value="Nguy·ªÖn Quang Tr∆∞·ªùng">
    <option value="Test team C∆∞·ªùng">
    <option value="V≈© Vi·∫øt Anh">
  </datalist>

  <datalist id="tkqcList">
    <option value="tcm 369-b(1)">
    <option value="tcm 376-b">
    <option value="tcm 378(1)">
    <option value="tcm 380(1)">
    <option value="tcm 393(1)">
    <option value="tcm 394(1)">
    <option value="tcm 399-b">
    <option value="tcm 407(1)">
    <option value="tcm 410-b(1)">
    <option value="tcm 413-b">
    <option value="tcm 427-b">
    <option value="tcm 434-b(1)">
    <option value="tcm 440(1)">
    <option value="tcm 442(1)">
    <option value="tcm 443(1)">
    <option value="tcm 449(1)">
    <option value="tcm 455">
    <option value="tcm  395">
    <option value="tcm 426-b">
    <option value="tcm 403">
    <option value="lumi hn 01">
    <option value="lumi hn 03(1)">
    <option value="lumi hn 04">
    <option value="lumi hn 05(1)">
    <option value="lumi hn 06">
    <option value="lumi hn 08 hold">
    <option value="lumi hn 10">
    <option value="lumi hn 12">
    <option value="lumi hn 19">
    <option value="lumi hn 23(hold)">
    <option value="lumi hn 24">
    <option value="lumi hn 25">
    <option value="lumi hn 26">
    <option value="lumi hn 27">
    <option value="lumi hn 30">
    <option value="lumi hn 33">
    <option value="lumi  hn 34">
    <option value="lumi hn 35">
    <option value="lumi hn 37">
    <option value="lumi hn 40">
    <option value="lumi hn 42">
    <option value="lumi hn 44">
    <option value="lumi hn 45">
    <option value="lumi hn 46">
    <option value="lumi hn 47">
    <option value="lumi hn 48">
    <option value="lumi hn 49">
    <option value="lumi hn 50">
    <option value="lumi hn 51">
    <option value="lumi hn 53">
    <option value="lumi hn 54">
    <option value="lumi hn 55">
    <option value="lumi hn 57">
    <option value="c∆∞·ªùng test 01">
    <option value="lumi hn 61">
    <option value="lumi hn 62">
    <option value="lumi hn 63">
    <option value="lumi hn 64">
    <option value="lumi hn 65 -7">
    <option value="lumi hn 70-7">
    <option value="lumi hn 66">
    <option value="lumi hn 67">
    <option value="lumi hn 68">
    <option value="lumi hn 71">
    <option value="lumi hn 72">
    <option value="lumi hn 73">
    <option value="lumi hn 74">
    <option value="lumi hn 75">
    <option value="lumi hn 76">
    <option value="lumi hn 77">
    <option value="lumi hn 78">
    <option value="lumi hn 79">
    <option value="lumi hn 81">
    <option value="lumi hn 82">
    <option value="lumi hn 83">
    <option value="lumi hn 85 mst">
    <option value="lmi hn 84 mst">
  </datalist>

  <script>
  const addRowBtn = document.getElementById('addRow');
  const tbody = document.querySelector('#dataTable tbody');
  const form = document.getElementById('dataForm');
  const respMsg = document.getElementById('responseMessage');

  function createRow(data = {}, insertAfter = null) {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><button type="button" class="removeRow">‚ùå</button></td>
      <td class="idcol"><input name="id" value="${data.id || ''}"></td>
      <td><input name="name" list="nameList" value="${data.name || ''}"></td>
      <td><input name="ngay" type="date" value="${data.ngay || ''}"></td>
      <td>
        <select name="ca">
          <option value="">--Ch·ªçn--</option>
          <option value="H·∫øt ca">H·∫øt ca</option>
          <option value="Gi·ªØa ca">Gi·ªØa ca</option>
          <option value="Ca Chi·ªÅu">Ca Chi·ªÅu</option>
        </select>
      </td>
      <td><input name="sanpham" value="${data.sanpham || ''}"></td>
      <td><input name="thitruong" value="${data.thitruong || ''}"></td>
      <td><input name="page" value="${data.page || ''}"></td>
      <td><input name="tkqc" list="tkqcList" value="${data.tkqc || ''}"></td>
      <td><input name="cpqc" value="${data.cpqc || ''}"></td>
      <td><input name="vialog" value="${data.vialog || ''}"></td>
      <td><input name="messcmt" value="${data.messcmt || ''}"></td>
      <td><input name="sodon" value="${data.sodon || ''}"></td>
      <td><input name="dschot" value="${data.dschot || ''}"></td>
      <td><input name="donhuy" value="${data.donhuy || ''}"></td>
      <td><input name="dssauhh" value="${data.dssauhh || ''}"></td>
      <td><input name="sosauhh" value="${data.sosauhh || ''}"></td>
      <td><input name="team" value="${data.team || ''}"></td>
      <td><input name="idns" value="${data.idns || ''}"></td>
    `;

    tr.querySelector('.removeRow').addEventListener('click', () => tr.remove());

    if (insertAfter) {
      insertAfter.parentNode.insertBefore(tr, insertAfter.nextSibling);
    } else {
      tbody.appendChild(tr);
    }
  }

  addRowBtn.addEventListener('click', () => createRow());

  form.addEventListener('submit', e => {
    e.preventDefault();
    const allRows = Array.from(tbody.querySelectorAll('tr')).map(tr => {
      const rowData = {};
      tr.querySelectorAll('input, select, textarea').forEach(el => {
        rowData[el.name] = el.value;
      });
      return rowData;
    });

    if (!allRows.length) {
      respMsg.style.color = 'red';
      return respMsg.innerText = 'Ch∆∞a c√≥ d√≤ng n√†o ƒë·ªÉ g·ª≠i!';
    }

    const payload = new URLSearchParams({ rows: JSON.stringify(allRows) });

    fetch('https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', {
      method: 'POST',
      body: payload
    })
    .then(r => r.json())
    .then(json => {
      if (json.error) {
        respMsg.style.color = 'red';
        respMsg.innerText = 'L·ªói: ' + json.error;
      } else {
        respMsg.style.color = 'green';
        respMsg.innerText = json.message;
        tbody.innerHTML = '';
      }
    })
    .catch(err => {
      respMsg.style.color = 'red';
      respMsg.innerText = 'L·ªói g·ª≠i: ' + err;
    });
  });
</script>
</body>
</html>














<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B√°o C√°o MKT LumiGlobal</title>
  <style>
    /* Gi·ªØ nguy√™n ph·∫ßn CSS nh∆∞ tr∆∞·ªõc */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      background-image: url('https://www.appsheet.com/template/gettablefileurl?appName=Appsheet-325045268&tableName=Kho%20%E1%BA%A3nh&fileName=Kho%20%E1%BA%A3nh_Images%2Ff930e667.%E1%BA%A2nh.025539.jpg');
      background-size: cover;
      background-attachment: fixed;
      background-position: center;
      color: #333;
    }
    /* ... (ph·∫ßn CSS gi·ªØ nguy√™n) ... */
  </style>
</head>
<body>
  <!-- Gi·ªØ nguy√™n ph·∫ßn HTML nh∆∞ tr∆∞·ªõc -->
  <div class="container">
    <!-- ... (ph·∫ßn header gi·ªØ nguy√™n) ... -->
    
    <button id="addRow" type="button" class="add-row-btn">‚ûï Th√™m d√≤ng tr·ªëng</button>
    <button id="loadFromUrl" type="button" class="add-row-btn url-load-btn">üîó T·∫£i d·ªØ li·ªáu t·ª´ URL</button>

    <form id="dataForm">
      <table id="dataTable">
        <!-- ... (ph·∫ßn table header gi·ªØ nguy√™n) ... -->
        <tbody>
          <!-- Rows will be added here dynamically -->
        </tbody>
      </table>
      <button type="submit" id="submitBtn" class="submit-btn">üöÄ G·ª≠i b√°o c√°o</button>
    </form>

    <p id="responseMessage"></p>
  </div>

  <script>
    // ... (ph·∫ßn khai b√°o bi·∫øn v√† danh s√°ch d·ªØ li·ªáu gi·ªØ nguy√™n) ...

    // H√†m ph√¢n t√≠ch chu·ªói data t·ª´ URL
    function parseDataString(dataString) {
      const result = [];
      const rows = dataString.split('_b_');
      
      const fieldMap = {
        'id': 'id',
        'T√™n': 'T√™n',
        'Ng√†y': 'Ng√†y',
        'Ca': 'ca',
        'S·∫£n ph·∫©m': 'S·∫£n_ph·∫©m',
        'Th·ªã tr∆∞·ªùng': 'Th·ªã_tr∆∞·ªùng',
        'Page': 'page',
        'TKQC': 'TKQC',
        'CPQC': 'CPQC',
        'Via log': 'Via_log',
        'S·ªë Mess+Cmt': 'S·ªë_Mess_Cmt'
      };
      
      rows.forEach(rowStr => {
        if (!rowStr) return;
        
        const rowData = {};
        const fields = rowStr.split('_a_');
        
        for (let i = 0; i < fields.length; i += 2) {
          const fieldName = fields[i];
          const fieldValue = fields[i+1];
          
          if (fieldMap[fieldName] && fieldValue) {
            rowData[fieldMap[fieldName]] = decodeURIComponent(fieldValue.replace(/\+/g, ' '));
          }
        }
        
        if (Object.keys(rowData).length > 0) {
          rowData.id = rowData.id || 'id_' + Date.now() + '_' + result.length;
          result.push(rowData);
        }
      });
      
      return result;
    }

    // H√†m t·∫£i d·ªØ li·ªáu t·ª´ URL
    function loadDataFromUrl() {
      const urlParams = new URLSearchParams(window.location.search);
      const dataString = urlParams.get('data');
      
      if (!dataString) {
        alert('Kh√¥ng c√≥ d·ªØ li·ªáu trong URL!');
        return;
      }
      
      try {
        const data = parseDataString(dataString);
        
        if (data.length === 0) {
          throw new Error('D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá');
        }
        
        tbody.innerHTML = '';
        
        data.forEach(rowData => {
          createRow(rowData);
        });
        
        respMsg.className = 'success';
        respMsg.innerText = `ƒê√£ t·∫£i ${data.length} d√≤ng t·ª´ URL`;
      } catch (error) {
        respMsg.className = 'error';
        respMsg.innerText = 'L·ªói khi ƒë·ªçc d·ªØ li·ªáu t·ª´ URL: ' + error.message;
      }
    }

    // ... (ph·∫ßn c√≤n l·∫°i c·ªßa script gi·ªØ nguy√™n) ...

    // H√†m t·∫°o URL m·∫´u
    function generateSampleUrl() {
      const baseUrl = window.location.href.split('?')[0];
      
      // Chu·ªói d·ªØ li·ªáu m·∫´u
      const dataString = encodeURIComponent(
        'id_a_001' +
        '_a_T√™n_a_Ph·∫°m Ti·∫øn Th√†nh' +
        '_a_Ng√†y_a_2023-05-20' +
        '_a_Ca_a_H·∫øt ca' +
        '_a_S·∫£n ph·∫©m_a_Kem body' +
        '_a_Th·ªã tr∆∞·ªùng_a_Nh·∫≠t' +
        '_a_Page_a_page123' +
        '_b_' +
        'id_a_002' +
        '_a_T√™n_a_Nguy·ªÖn Th·ªã Hi·∫øu' +
        '_a_Ng√†y_a_2023-05-21' +
        '_a_Ca_a_Ca Chi·ªÅu' +
        '_a_S·∫£n ph·∫©m_a_CF FG' +
        '_a_Th·ªã tr∆∞·ªùng_a_H√†n' +
        '_a_Page_a_page456'
      );
      
      return baseUrl + '?data=' + dataString;
    }

    console.log("URL m·∫´u:", generateSampleUrl());
  </script>
</body>
</html>















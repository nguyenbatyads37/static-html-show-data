<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phiếu Trả Lời Bài Tập - Lớp Tiếng Anh CLC Cô Thảo Linh</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #4CAF50;
        }
        .header h1 {
            color: #2c3e50;
            margin-bottom: 5px;
        }
        .header h2 {
            color: #4CAF50;
            margin-top: 0;
            font-size: 1.3em;
        }
        .login-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        .form-group {
            margin-bottom: 15px;
            flex: 1;
            min-width: 200px;
            margin-right: 15px;
        }
        .form-group:last-child {
            margin-right: 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"], input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }
        .question-container {
            margin-bottom: 30px;
        }
        .current-question {
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 5px;
            margin-bottom: 15px;
            border-left: 4px solid #4CAF50;
        }
        .question-number {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 16px;
            color: #2c3e50;
        }
        .options {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        .option {
            display: flex;
            align-items: center;
        }
        .option input {
            margin-right: 8px;
            transform: scale(1.2);
        }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .btn {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        .btn:hover {
            background-color: #45a049;
        }
        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .submit-btn {
            background-color: #2196F3;
            width: 100%;
            margin-top: 20px;
        }
        .submit-btn:hover {
            background-color: #0b7dda;
        }
        .pdf-viewer {
            width: 100%;
            height: 500px;
            margin: 20px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
        }
        .hidden {
            display: none;
        }
        .progress-bar {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress {
            height: 10px;
            background-color: #4CAF50;
            border-radius: 5px;
            width: 0%;
            transition: width 0.3s;
        }
        @media (max-width: 600px) {
            .options {
                gap: 10px;
            }
            .form-group {
                min-width: 100%;
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>LỚP HỌC TIẾNG ANH CLC CÔ THẢO LINH</h1>
            <h2>PHIẾU TRẢ LỜI BÀI TẬP</h2>
        </div>
        
        <div class="login-section">
            <div class="form-group">
                <label for="student-id">Mã HS:</label>
                <input type="text" id="student-id" name="student-id" required>
            </div>
            <div class="form-group">
                <label for="password">Password:</label>
                <input type="password" id="password" name="password" required>
            </div>
        </div>
        
        <div class="pdf-viewer">
            <iframe src="https://drive.google.com/file/d/1sVZszGRy94UlklNUWR3KQDmiPtbGCScY/preview" width="100%" height="100%" allow="autoplay"></iframe>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <form id="question-form">
            <!-- Questions will be generated here by JavaScript -->
        </form>
        
        <button class="submit-btn">Nộp bài</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('question-form');
            const totalQuestions = 38;
            let currentQuestion = 1;
            
            // Create all questions
            function createQuestions() {
                // Questions 1-31 (Multiple Choice)
                for (let i = 1; i <= 31; i++) {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-container hidden';
                    questionDiv.id = `q${i}-container`;
                    
                    const questionContent = document.createElement('div');
                    questionContent.className = 'current-question';
                    
                    const questionNumber = document.createElement('div');
                    questionNumber.className = 'question-number';
                    questionNumber.textContent = `Câu ${i}:`;
                    
                    const optionsDiv = document.createElement('div');
                    optionsDiv.className = 'options';
                    
                    for (let letter of ['A', 'B', 'C', 'D']) {
                        const label = document.createElement('label');
                        label.className = 'option';
                        
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = `q${i}`;
                        input.value = letter;
                        input.dataset.question = i;
                        
                        label.appendChild(input);
                        label.appendChild(document.createTextNode(` ${letter}`));
                        optionsDiv.appendChild(label);
                    }
                    
                    const navButtons = document.createElement('div');
                    navButtons.className = 'nav-buttons';
                    
                    const prevButton = document.createElement('button');
                    prevButton.type = 'button';
                    prevButton.className = 'btn';
                    prevButton.textContent = 'Câu trước';
                    prevButton.onclick = () => navigateToQuestion(currentQuestion - 1);
                    if (i === 1) prevButton.disabled = true;
                    
                    const nextButton = document.createElement('button');
                    nextButton.type = 'button';
                    nextButton.className = 'btn';
                    nextButton.textContent = 'Câu sau';
                    nextButton.onclick = () => navigateToQuestion(currentQuestion + 1);
                    if (i === totalQuestions) nextButton.disabled = true;
                    
                    navButtons.appendChild(prevButton);
                    navButtons.appendChild(nextButton);
                    
                    questionContent.appendChild(questionNumber);
                    questionContent.appendChild(optionsDiv);
                    questionContent.appendChild(navButtons);
                    
                    questionDiv.appendChild(questionContent);
                    form.appendChild(questionDiv);
                }
                
                // Questions 32-35 (Short Answer)
                for (let i = 32; i <= 35; i++) {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-container hidden';
                    questionDiv.id = `q${i}-container`;
                    
                    const questionContent = document.createElement('div');
                    questionContent.className = 'current-question';
                    
                    const questionNumber = document.createElement('div');
                    questionNumber.className = 'question-number';
                    questionNumber.textContent = `Câu ${i}:`;
                    
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.name = `q${i}`;
                    input.style.width = '100%';
                    input.style.maxWidth = '400px';
                    input.style.padding = '10px';
                    input.style.border = '1px solid #ddd';
                    input.style.borderRadius = '4px';
                    input.dataset.question = i;
                    
                    const navButtons = document.createElement('div');
                    navButtons.className = 'nav-buttons';
                    
                    const prevButton = document.createElement('button');
                    prevButton.type = 'button';
                    prevButton.className = 'btn';
                    prevButton.textContent = 'Câu trước';
                    prevButton.onclick = () => navigateToQuestion(currentQuestion - 1);
                    
                    const nextButton = document.createElement('button');
                    nextButton.type = 'button';
                    nextButton.className = 'btn';
                    nextButton.textContent = 'Câu sau';
                    nextButton.onclick = () => navigateToQuestion(currentQuestion + 1);
                    if (i === totalQuestions) nextButton.disabled = true;
                    
                    navButtons.appendChild(prevButton);
                    navButtons.appendChild(nextButton);
                    
                    questionContent.appendChild(questionNumber);
                    questionContent.appendChild(input);
                    questionContent.appendChild(navButtons);
                    
                    questionDiv.appendChild(questionContent);
                    form.appendChild(questionDiv);
                }
                
                // Questions 36-38 (Long Answer)
                for (let i = 36; i <= 38; i++) {
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-container hidden';
                    questionDiv.id = `q${i}-container`;
                    
                    const questionContent = document.createElement('div');
                    questionContent.className = 'current-question';
                    
                    const questionNumber = document.createElement('div');
                    questionNumber.className = 'question-number';
                    questionNumber.textContent = `Câu ${i}:`;
                    
                    const textarea = document.createElement('textarea');
                    textarea.name = `q${i}`;
                    textarea.style.width = '100%';
                    textarea.style.minHeight = '100px';
                    textarea.style.padding = '10px';
                    textarea.style.border = '1px solid #ddd';
                    textarea.style.borderRadius = '4px';
                    textarea.dataset.question = i;
                    
                    const navButtons = document.createElement('div');
                    navButtons.className = 'nav-buttons';
                    
                    const prevButton = document.createElement('button');
                    prevButton.type = 'button';
                    prevButton.className = 'btn';
                    prevButton.textContent = 'Câu trước';
                    prevButton.onclick = () => navigateToQuestion(currentQuestion - 1);
                    
                    const nextButton = document.createElement('button');
                    nextButton.type = 'button';
                    nextButton.className = 'btn';
                    nextButton.textContent = i === totalQuestions ? 'Nộp bài' : 'Câu sau';
                    nextButton.onclick = i === totalQuestions ? submitForm : () => navigateToQuestion(currentQuestion + 1);
                    
                    navButtons.appendChild(prevButton);
                    navButtons.appendChild(nextButton);
                    
                    questionContent.appendChild(questionNumber);
                    questionContent.appendChild(textarea);
                    questionContent.appendChild(navButtons);
                    
                    questionDiv.appendChild(questionContent);
                    form.appendChild(questionDiv);
                }
                
                // Show first question
                navigateToQuestion(1);
            }
            
            function navigateToQuestion(questionNum) {
                // Hide current question
                document.getElementById(`q${currentQuestion}-container`).classList.add('hidden');
                
                // Show new question
                currentQuestion = questionNum;
                document.getElementById(`q${currentQuestion}-container`).classList.remove('hidden');
                
                // Update progress bar
                const progress = (currentQuestion / totalQuestions) * 100;
                document.getElementById('progress').style.width = `${progress}%`;
                
                // Scroll to question
                document.getElementById(`q${currentQuestion}-container`).scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
            
            function submitForm() {
                const studentId = document.getElementById('student-id').value;
                const password = document.getElementById('password').value;

                // Lấy tất cả đáp án từ form
                let answers = [];
                for (let i = 1; i <= 38; i++) {
                    let answer = document.querySelector(`input[name="q${i}"]:checked`);
                    if (answer) {
                        answers.push(answer.value);
                    } else {
                        answers.push(""); // Trường hợp không chọn câu trả lời
                    }
                }

                const formData = {
                    studentId: studentId,
                    password: password,
                    answers: answers
                };

                // Gửi dữ liệu đến Google Apps Script
                fetch('https://script.google.com/macros/s/AKfycbwBVBnnM73EBVTgYdKjnsnxkHleHOXSABSPaf1MGqSE5UwFsC3UDdhyOkq7XlQNLWw/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                })
                .then(response => response.text())
                .then(data => {
                    alert(data);
                })
                .catch(error => {
                    alert('Có lỗi xảy ra: ' + error);
                });
            }
            
            createQuestions();
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BÁO CÁO LIÊN LẠC BẤT THƯỜNG</title>
    <style>
        @page {
            size: A4 landscape;
            margin: 0;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 10px;
            padding: 10px;
            font-size: 13px;
            width: 297mm;
            height: 210mm;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 8px;
            table-layout: fixed;
        }
        th, td {
            border: 1px solid black;
            padding: 5px;
            vertical-align: middle;
            height: 30px;
        }
        .header {
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .japanese {
            font-size: 10px;
            color: #333;
            display: block;
            margin-top: 2px;
        }
        .dual-language {
            display: block;
            height: 100%;
        }
        .dual-language span.vietnamese {
            display: block;
            font-weight: bold;
        }
        .dual-language span.japanese {
            display: block;
            font-size: 10px;
            color: #333;
        }
        .signature-cell {
            height: 50px;
            text-align: center;
            vertical-align: middle;
            position: relative;
            padding: 0;
        }
        .signature-content {
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .signature-line {
            border-top: 1px solid black;
            font-size: 9px;
            color: #666;
            padding-top: 2px;
            height: 20px;
        }
        .photo-container {
            height: 120px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 1px solid #ddd;
        }
        .photo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .section-title {
            font-weight: bold;
            text-align: center;
            padding: 3px;
            background-color: #f0f0f0;
        }
        .section-title .vietnamese {
            font-size: 13px;
        }
        .section-title .japanese {
            font-size: 10px;
        }
        .no-image {
            font-style: italic;
            color: #999;
            text-align: center;
            padding: 20px;
        }
        [contenteditable="true"] {
            min-height: 20px;
            padding: 2px;
            border: 1px dashed transparent;
            background-color: #f8f9fa;
        }
        [contenteditable="true"]:focus {
            border: 1px dashed #007bff;
            outline: none;
        }
        .button-container {
            text-align: center;
            margin: 10px 0;
        }
        button {
            padding: 6px 12px;
            margin: 0 5px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .small-text {
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="header">
        <div>BÁO CÁO LIÊN LẠC BẤT THƯỜNG</div>
        <div class="japanese">異常連絡書</div>
    </div>

    <table>
        <tr>
            <td style="width: 12%;">
                <div class="dual-language">
                    <span class="vietnamese">Ngày khiếu nại</span>
                    <span class="japanese">クレーム発生日</span>
                </div>
            </td>
            <td style="width: 10%;">
                <div class="dual-language">
                    <span class="vietnamese">Khách hàng</span>
                    <span class="japanese">客先</span>
                </div>
            </td>
            <td style="width: 8%;" contenteditable="true">FULIAN</td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">14,8%HĐ</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">89/24FVPMZ</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">LNNGFPWMLZ</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">HNGGFPWMLZ</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">宝莱制药</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">欧纳制药</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">品牌制药</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
            <td style="width: 6%;" class="signature-cell">
                <div class="signature-content" contenteditable="true">PNR</div>
                <div class="signature-line">(Ký, họ tên)</div>
            </td>
        </tr>
        <tr>
            <td rowspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Ngày phát sinh công đoạn</span>
                    <span class="japanese">工程内発生日</span>
                </div>
            </td>
            <td contenteditable="true">2025.09.31</td>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">NV kinh doanh</span>
                    <span class="japanese">営業担当</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">Ms Trang</td>
        </tr>
        <tr>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Dây chuyền SX</span>
                    <span class="japanese">発生場所</span>
                </div>
            </td>
            <td contenteditable="true">SL1-LV2</td>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Ngày xuất hàng</span>
                    <span class="japanese">出荷日</span>
                </div>
            </td>
            <td colspan="7" contenteditable="true">HĐBĐ</td>
        </tr>
        <tr>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Ca sản xuất</span>
                    <span class="japanese">加工チーム</span>
                </div>
            </td>
            <td contenteditable="true">Team Mr Huy - Mr Đinh</td>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Dạng Lỗi</span>
                    <span class="japanese">不良種類</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">
                <div class="dual-language">
                    <span class="vietnamese">LỖI VẬN TẢI</span>
                    <span class="japanese">運送起因</span>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Mã số quản lý lỗi</span>
                    <span class="japanese">管理№</span>
                </div>
            </td>
            <td colspan="9" contenteditable="true">HSSH-NG-2503015</td>
        </tr>
    </table>

    <table>
        <tr>
            <td colspan="5" style="width: 50%;">
                <div class="section-title">
                    <span class="vietnamese">HÌNH ẢNH BẤT THƯỜNG</span>
                    <span class="japanese">異常写真</span>
                </div>
            </td>
            <td colspan="5" style="width: 50%;">
                <div class="section-title">
                    <span class="vietnamese">NỘI DUNG BẤT THƯỜNG</span>
                    <span class="japanese">異常内容</span>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="5" rowspan="9" style="vertical-align: top;">
                <div class="photo-container" id="image1">
                    <div class="no-image">Ảnh 1 (Chưa có hình ảnh)</div>
                </div>
                <div class="photo-container" id="image2">
                    <div class="no-image">Ảnh 2 (Chưa có hình ảnh)</div>
                </div>
                <div class="photo-container" id="image3">
                    <div class="no-image">Ảnh 3 (Chưa có hình ảnh)</div>
                </div>
            </td>
            <td colspan="5" rowspan="9" style="vertical-align: top; padding: 5px;" contenteditable="true">
                <div>0.96x485xC (mã 001) mốc 50m đầu cuộn</div>
                <div>0.96x485xC (mã 002) mốc + cấn 142m đầu cuộn</div>
                <div>Nguyên nhân: Do vận chuyển. Kiểm tra đầu vào đã phát hiện cấn và loang bẩn vỏ.</div>
                <div>(Lô nhập kho tháng 2 hầu hết đang phát sinh mốc)</div>
                <br>
                <div class="japanese">0.96x485xC (枝番001) コイルのトップの表面50ｍに白錆が発生しました。</div>
                <div class="japanese">0.96x485xC (枝番002) コイルのトップの表面142ｍに白錆と打痕が発生しました。</div>
                <div class="japanese">原因：運送起因です。受入検査時に母材コイルの外周版に打痕と汚れが付くのを発見しました</div>
                <div class="japanese">（2月に入庫したロットのほとんどに白錆が発生している）</div>
            </td>
        </tr>
    </table>

    <table>
        <tr>
            <th colspan="2" style="width: 20%;">
                <div class="section-title">
                    <span class="vietnamese">THÔNG TIN CUỘN NGUYÊN LIỆU</span>
                    <span class="japanese">母材情報</span>
                </div>
            </th>
            <th style="width: 10%;">
                <div class="dual-language">
                    <span class="vietnamese">Mã cuộn</span>
                    <span class="japanese">IDナンバー</span>
                </div>
            </th>
            <td colspan="7" style="width: 70%;" contenteditable="true">4SM384A00</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Nhà Cung Cấp</span>
                    <span class="japanese">メーカー</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">YIEHPHUI</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Mác thép</span>
                    <span class="japanese">母材規格</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">HGCC1-ZSUX-Z08</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Kích thước cuộn mẹ</span>
                    <span class="japanese">母材サイズ</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">0.96x976xC</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Trọng lượng cuộn mẹ</span>
                    <span class="japanese">母材重量</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">8,875kg</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Ngày nhập kho</span>
                    <span class="japanese">入庫日</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">2025.02.21</td>
        </tr>
    </table>

    <table>
        <tr>
            <th colspan="2" style="width: 20%;">
                <div class="section-title">
                    <span class="vietnamese">THÔNG TIN BĂNG THÀNH PHẨM</span>
                    <span class="japanese">コイル品情報</span>
                </div>
            </th>
            <th style="width: 10%;">
                <div class="dual-language">
                    <span class="vietnamese">Chỉ thị gia công</span>
                    <span class="japanese">加工指示</span>
                </div>
            </th>
            <td colspan="7" style="width: 70%;" contenteditable="true">3806-1</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Kích thước thành phẩm</span>
                    <span class="japanese">製品サイズ</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">0.96x485x590</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Trọng lượng thành phẩm</span>
                    <span class="japanese">製品重量</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true"></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Số lượng NG</span>
                    <span class="japanese">NG数量</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">60 sheets</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Trọng lượng NG</span>
                    <span class="japanese">NG重量</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">134kg</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Phương pháp xếp Dao</span>
                    <span class="japanese">刃組方法</span>
                </div>
            </td>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Phíp</span>
                    <span class="japanese">フィンガー</span>
                </div>
            </td>
            <td>
                <div class="dual-language">
                    <span class="vietnamese">Vòng cao su</span>
                    <span class="japanese">ゴムリング</span>
                </div>
            </td>
            <td colspan="6"></td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Người xếp Dao</span>
                    <span class="japanese">刃組担当者</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">Team Mr Huy - Mr Đinh</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Người đo kiểm kích thước</span>
                    <span class="japanese">寸法確認者</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">Team Mr Huy - Mr Đinh</td>
        </tr>
        <tr>
            <td colspan="2">
                <div class="dual-language">
                    <span class="vietnamese">Người kiểm tra ngoại quan</span>
                    <span class="japanese">外観検査担当者</span>
                </div>
            </td>
            <td colspan="8" contenteditable="true">Team Mr Huy - Mr Đinh</td>
        </tr>
    </table>

    <table>
        <tr>
            <th style="width: 50%;">
                <div class="section-title">
                    <span class="vietnamese">CHI TIẾT BẤT THƯỜNG</span>
                    <span class="japanese">異常詳細図</span>
                </div>
            </th>
            <th style="width: 50%;">
                <div class="section-title">
                    <span class="vietnamese">XỬ LÝ TẠM THỜI</span>
                    <span class="japanese">初期処理 （5W 1H )</span>
                </div>
            </th>
        </tr>
        <tr>
            <td style="height: 100px;" contenteditable="true"></td>
            <td contenteditable="true">
                <div>Đã lọc bỏ phần lỗi (134kg), tạm thời lưu kho cho bảo hiểm xác nhận</div>
                <div>Lượng NG khiếu nại bảo hiểm (QC & Logistics / tháng 3)</div>
                <br>
                <div class="japanese">不良部を選別済み(134kg)、取り敢えず、在庫保管し保険会社に確認させる</div>
                <div class="japanese">NG量は保険会社にクレームを発行します(QC & Logistics /3月)</div>
            </td>
        </tr>
    </table>

    <div class="button-container">
        <button onclick="saveReport()">Lưu báo cáo</button>
        <button onclick="printReport()">In báo cáo</button>
        <button onclick="clearEditable()">Xóa nội dung</button>
        <button onclick="loadSampleData()">Tải dữ liệu mẫu</button>
    </div>

    <script>
        // Chức năng sửa trực tiếp
        function setupEditable() {
            const editables = document.querySelectorAll('[contenteditable="true"]');
            editables.forEach(el => {
                el.addEventListener('focus', function() {
                    this.style.backgroundColor = '#fff';
                    this.style.border = '1px dashed #007bff';
                });
                el.addEventListener('blur', function() {
                    this.style.backgroundColor = '#f8f9fa';
                    this.style.border = '1px dashed transparent';
                });
            });
        }

        // Lưu báo cáo
        function saveReport() {
            const reportContent = document.documentElement.outerHTML;
            localStorage.setItem('savedReport', reportContent);
            alert('Báo cáo đã được lưu vào bộ nhớ trình duyệt!');
        }

        // In báo cáo
        function printReport() {
            window.print();
        }

        // Xóa nội dung
        function clearEditable() {
            if(confirm('Bạn có chắc muốn xóa tất cả nội dung có thể chỉnh sửa?')) {
                const editables = document.querySelectorAll('[contenteditable="true"]');
                editables.forEach(el => {
                    el.textContent = '';
                });
            }
        }

        // Tải dữ liệu mẫu
        function loadSampleData() {
            if(confirm('Tải dữ liệu mẫu sẽ ghi đè nội dung hiện tại. Tiếp tục?')) {
                // Khôi phục nội dung mẫu
                const sampleContent = `
                    <div>0.96x485xC (mã 001) mốc 50m đầu cuộn</div>
                    <div>0.96x485xC (mã 002) mốc + cấn 142m đầu cuộn</div>
                    <div>Nguyên nhân: Do vận chuyển. Kiểm tra đầu vào đã phát hiện cấn và loang bẩn vỏ.</div>
                    <div>(Lô nhập kho tháng 2 hầu hết đang phát sinh mốc)</div>
                    <br>
                    <div class="japanese">0.96x485xC (枝番001) コイルのトップの表面50ｍに白錆が発生しました。</div>
                    <div class="japanese">0.96x485xC (枝番002) コイルのトップの表面142ｍに白錆と打痕が発生しました。</div>
                    <div class="japanese">原因：運送起因です。受入検査時に母材コイルの外周版に打痕と汚れが付くのを発見しました</div>
                    <div class="japanese">（2月に入庫したロットのほとんどに白錆が発生している）</div>
                `;
                
                document.querySelector('td[contenteditable="true"]').innerHTML = sampleContent;
            }
        }

        // Tải ảnh từ URL
        function loadImagesFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const images = ['anh1', 'anh2', 'anh3'];
            
            images.forEach((param, index) => {
                const imgUrl = urlParams.get(param);
                if(imgUrl) {
                    const container = document.getElementById(`image${index+1}`);
                    container.innerHTML = `<img src="${imgUrl}" alt="Ảnh ${index+1}">`;
                }
            });
        }

        // Khởi tạo
        window.onload = function() {
            setupEditable();
            loadImagesFromURL();
            
            // Khôi phục báo cáo đã lưu nếu có
            const savedReport = localStorage.getItem('savedReport');
            if(savedReport && confirm('Tìm thấy báo cáo đã lưu. Bạn có muốn khôi phục?')) {
                document.open();
                document.write(savedReport);
                document.close();
            }
        };
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giấy Đề Nghị Tạm Ứng</title>
    <style>
        body {
            font-family: "Times New Roman", Times, serif;
            font-size: 14pt;
            line-height: 1.5;
            margin: 0;
            background-color: #f0f0f0; /* Màu nền web */
        }
        
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 10mm auto;
            background: white; /* Nền giấy trắng */
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            box-sizing: border-box;
        }

        /* Header section */
        .header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .company-info {
            width: 50%;
            text-align: center;
        }
        
        .company-name {
            font-weight: bold;
            text-transform: uppercase;
            margin-bottom: 5px;
            font-size: 13pt;
        }

        .company-address {
            font-size: 11pt;
            font-weight: bold;
        }

        .nation-info {
            width: 50%;
            text-align: center;
        }

        .nation-title {
            font-weight: bold;
            text-transform: uppercase;
        }

        .motto {
            font-weight: bold;
            border-bottom: 1px solid #000; /* Gạch chân Độc lập tự do */
            display: inline-block;
            padding-bottom: 3px;
            margin-bottom: 15px;
        }

        .date-location {
            text-align: right;
            font-style: italic;
            margin-top: 10px;
        }

        /* Title section */
        .doc-title {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        .doc-title h1 {
            margin: 0;
            font-size: 18pt;
            text-transform: uppercase;
        }

        .doc-subtitle {
            font-weight: bold;
            font-style: italic;
            font-size: 14pt;
        }

        /* Content section */
        .content {
            margin-bottom: 15px;
        }

        /* Table section */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 20px;
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            vertical-align: middle;
        }

        th {
            text-align: center;
            font-weight: bold;
        }

        .col-money {
            width: 180px;
            text-align: center;
            font-weight: bold;
        }

        .money-text {
            font-style: italic;
            border-top: none; 
        }

        /* Footer section */
        .footer-info p {
            margin: 5px 0;
        }

        .signature-section {
            margin-top: 40px;
            text-align: right;
            margin-right: 20px;
        }
        
        .signature-company {
            text-transform: uppercase;
            font-weight: bold;
            margin-bottom: 80px; /* Khoảng trống ký tên */
        }

        /* Highlight class (để bạn dễ thấy chỗ nào là dynamic, 
           trên thực tế in ra sẽ không có màu vàng trừ khi bạn muốn giữ) */
        .dynamic-data {
            font-weight: inherit;
        }
        
        /* CSS cho màn hình in */
        @media print {
            body { background: none; }
            .page { margin: 0; box-shadow: none; width: 100%; }
        }
    </style>
</head>
<body>

    <div class="page">
        <div class="header">
            <div class="company-info">
                <div class="company-name">CÔNG TY CỔ PHẦN NỘI THẤT NHÔM KÍNH<br>ĐÀ NẴNG ALUMINIUM</div>
                <div class="company-address">Địa chỉ: 64 Đặng Văn Ngữ - Khuê Trung - Cẩm Lệ - Đà Nẵng</div>
            </div>
            <div class="nation-info">
                <div class="nation-title">CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</div>
                <div class="motto">Độc lập – Tự Do – Hạnh Phúc</div>
                <div class="date-location">
                    Đà Nẵng, Ngày <span id="ngay" class="dynamic-data">...</span>
                </div>
            </div>
        </div>

        <div class="doc-title">
            <h1>GIẤY ĐỀ NGHỊ TẠM ỨNG</h1>
            <div class="doc-subtitle">(V/v: tạm ứng đợt <span id="dot-title" class="dynamic-data">...</span>)</div>
        </div>

        <div class="content">
            <p>Kính gửi: <strong>ANH SINH</strong></p>
            <p>Địa chỉ: <span id="diachi" class="dynamic-data" style="background-color: yellow;">...</span></p>
            <p>
                Căn cứ theo hợp đồng thi công số: <strong id="mahopdong-body" class="dynamic-data" style="background-color: yellow;">...</strong> và thực tế thi công tại công trình. Hôm nay bên em xin đề nghị tạm ứng đợt <strong id="dot-body" class="dynamic-data" style="background-color: yellow;">...</strong> với nội dung và số tiền như sau:
            </p>
        </div>

        <table>
            <thead>
                <tr>
                    <th>NỘI DUNG</th>
                    <th class="col-money">SỐ TIỀN (VNĐ)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Bên B chịu trách nhiệm sản xuất và lắp đặt hoàn thiện hạng mục nhôm kính cho công trình.</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Hợp đồng thi công số: <strong id="mahopdong-table" class="dynamic-data" style="background-color: yellow;">...</strong></td>
                    <td class="col-money">75.653.934 VNĐ</td>
                </tr>
                <tr>
                    <td>Đã tạm ứng đợt 1</td>
                    <td class="col-money">20.000.000 vnđ</td>
                </tr>
                <tr>
                    <td>Yêu cầu tạm ứng đợt 2</td>
                    <td class="col-money">30.000.000 vnđ</td>
                </tr>
                <tr>
                    <td colspan="2" class="money-text">Bằng chữ: Ba mươi triệu đồng ./.</td>
                </tr>
            </tbody>
        </table>

        <div class="footer-info">
            <p>Số tiền trên kính đề nghị quý công ty thanh toán như sau:</p>
            <p>Hình thức: Chuyển khoản</p>
            <p>Thông tin chuyển tiền:</p>
            <p>- Chủ tài khoản: Công ty cổ phần Nội Thất Nhôm Kính Đà Nẵng Aluminium</p>
            <p>- STK: 190590 tại ngân hàng TMCP Kỹ Thương Việt NamTecombank – CN Đà Nẵng</p>
            <p>Trân trọng cảm ơn!</p>
        </div>

        <div class="signature-section">
            <div class="signature-company">
                CÔNG TY CP NỘI THẤT NHÔM KÍNH<br>
                ĐÀ NẴNG ALUMINIUM
            </div>
        </div>
    </div>

    <script>
        // Hàm lấy tham số từ URL
        function getParameterByName(name) {
            const url = new URL(window.location.href);
            return url.searchParams.get(name);
        }

        // Dữ liệu mặc định (giống trong hình mẫu) để hiển thị nếu không có URL params
        const defaultData = {
            ngay: "20 tháng 04 năm 2025",
            dot: "02",
            diachi: "30 Duong Loan, Hòa Xuân, Cẩm Lệ, TP. Đà Nẵng.",
            mahopdong: "HĐTC 01/2025/danangaluminium"
        };

        // Lấy dữ liệu từ URL hoặc dùng mặc định
        const ngay = getParameterByName('ngay') || defaultData.ngay;
        const dot = getParameterByName('dot') || defaultData.dot;
        const diachi = getParameterByName('diachi') || defaultData.diachi;
        const mahopdong = getParameterByName('mahopdong') || defaultData.mahopdong;

        // Điền dữ liệu vào HTML
        // 1. Ngày tháng (Góc phải trên cùng) - Có highlight vàng trong hình mẫu
        const elNgay = document.getElementById('ngay');
        elNgay.innerText = ngay;
        elNgay.style.backgroundColor = "yellow"; // Bôi vàng theo yêu cầu

        // 2. Đợt (Subtitle và Body text)
        const elDotTitle = document.getElementById('dot-title');
        const elDotBody = document.getElementById('dot-body');
        elDotTitle.innerText = dot;
        elDotBody.innerText = dot;
        elDotTitle.style.backgroundColor = "yellow"; // Bôi vàng

        // 3. Địa chỉ
        document.getElementById('diachi').innerText = diachi;

        // 4. Mã hợp đồng (Trong đoạn văn và trong bảng)
        document.getElementById('mahopdong-body').innerText = mahopdong;
        document.getElementById('mahopdong-table').innerText = mahopdong;

    </script>
</body>
</html>
